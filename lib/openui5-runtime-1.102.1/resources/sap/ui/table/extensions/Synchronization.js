/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./ExtensionBase","../utils/TableUtils","../library","sap/base/Log"],function(E,T,l,L){"use strict";var a={setRowSelection:function(i,s){var t=this.getTable();var r=t.getRows()[i];if(r&&s!=null){T.toggleRowSelection(t,r.getIndex(),s);}},setRowHover:function(i,h){var t=this.getTable();var r=t.getRows()[i];if(r&&h!=null){r._setHovered(h);}},addVerticalScrollingListener:function(c){var t=this.getTable();var s=t._getScrollExtension();var d=s.constructor.ScrollDirection;if(c){s.registerForMouseWheel(c.wheelAreas,{scrollDirection:d.VERTICAL});s.registerForTouch(c.touchAreas,{scrollDirection:d.VERTICAL});}},placeVerticalScrollbarAt:function(h){var t=this.getTable();var s=t._getScrollExtension();if(!h){throw new Error("The HTMLElement in which the vertical scrollbar should be placed must be specified.");}if(!s.isVerticalScrollbarExternal()){var r=sap.ui.getCore().createRenderManager();t.getRenderer().renderVSbExternal(r,t);r.flush(h);var e=h.querySelector("#"+t.getId()+"-"+l.SharedDomRef.VerticalScrollBar);s.markVerticalScrollbarAsExternal(e);t.invalidate();}else{h.appendChild(s.getVerticalScrollbar().parentElement);s.restoreVerticalScrollPosition();}},renderHorizontalScrollbar:function(r,i,s){var t=this.getTable();if(i==null){throw new Error("The id must be specified.");}t.getRenderer().renderHSbExternal(r,t,i,s);}};var b={onBeforeRendering:function(e){var s=this._getSyncExtension();var r=e&&e.isMarked("renderRows");var c=this.getDomRef("tableCCnt");if(!r&&c&&s._onTableContainerScrollEventHandler){c.removeEventListener("scroll",s._onTableContainerScrollEventHandler);delete s._onTableContainerScrollEventHandler;}},onAfterRendering:function(e){var s=this._getScrollExtension();var r=e&&e.isMarked("renderRows");var c=this.getDomRef("tableCCnt");if(s.isVerticalScrollbarExternal()&&!r){s.updateVerticalScrollbarHeight();s.updateVerticalScrollHeight();}if(!r){var o=this._getSyncExtension();o.syncInnerVerticalScrollPosition(c.scrollTop);if(!o._onTableContainerScrollEventHandler){o._onTableContainerScrollEventHandler=function(e){o.syncInnerVerticalScrollPosition(e.target.scrollTop);};}c.addEventListener("scroll",o._onTableContainerScrollEventHandler);}}};var S=E.extend("sap.ui.table.extensions.Synchronization",{_init:function(t,s,m){this._delegate=b;this._oPublicInterface={syncRowSelection:a.setRowSelection.bind(this),syncRowHover:a.setRowHover.bind(this),registerVerticalScrolling:a.addVerticalScrollingListener.bind(this),placeVerticalScrollbarAt:a.placeVerticalScrollbarAt.bind(this),renderHorizontalScrollbar:a.renderHorizontalScrollbar.bind(this)};T.addDelegate(t,this._delegate,t);return"SyncExtension";},destroy:function(){var t=this.getTable();if(t){t.removeEventDelegate(this._delegate);}this._delegate=null;this._oPublicInterface=null;E.prototype.destroy.apply(this,arguments);}});S.prototype.syncRowCount=function(c){this.callInterfaceHook("rowCount",arguments);};S.prototype.syncRowSelection=function(i,s){this.callInterfaceHook("rowSelection",arguments);};S.prototype.syncRowHover=function(i,h){this.callInterfaceHook("rowHover",arguments);};S.prototype.syncRowHeights=function(h){return this.callInterfaceHook("rowHeights",arguments);};S.prototype.syncInnerVerticalScrollPosition=function(s){this.callInterfaceHook("innerVerticalScrollPosition",arguments);};S.prototype.syncLayout=function(m){this.callInterfaceHook("layout",arguments);};S.prototype.callInterfaceHook=function(h,A){var c={};c[h]=Array.prototype.slice.call(A);L.debug("sap.ui.table.extensions.Synchronization","Sync "+h+"("+c[h]+")",this.getTable());return T.dynamicCall(this._oPublicInterface,c);};S.prototype.getInterface=function(){return this._oPublicInterface;};return S;});
