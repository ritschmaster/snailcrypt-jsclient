/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/util/merge","sap/ui/model/json/JSONModel","sap/ui/core/Core","sap/base/util/deepClone"],function(m,J,C,d){"use strict";var a={layers:{"admin":0,"content":5,"translation":10,"all":20},mergeManifestPathChanges:function(M,c){Object.keys(c).forEach(function(s){if(s.charAt(0)==="/"){var v=c[s];M.setProperty(s,v);}});},mergeTextsChanges:function(M,t,D){var l=C.getConfiguration().getLanguage().replaceAll('_','-');if(t&&t.hasOwnProperty(l)){var T=t[l];for(var s in T){var o=T[s];if(typeof o==="object"){a.translateObject(M,s,o,D);}else{var c=M.getProperty(s);var b=true;if(c&&typeof c==="string"&&(c.indexOf("{context>")===0||c.indexOf("{{parameters")===0)){b=false;}if(b){M.setProperty(s,o);}}}}},mergeCardDelta:function(M,c,S){var i=m({},M);if(typeof S==="undefined"){S="sap.card";}if(Array.isArray(c)&&c.length>0){var o,t,D;c.forEach(function(b){if(b.content){m(i[S],b.content);}else{var l=b.hasOwnProperty(":layer")?b[":layer"]:1000;if(l===a.layers["translation"]){var L=C.getConfiguration().getLanguage().replaceAll('_','-');var T={"texts":{}};T.texts[L]={};delete b.texts;Object.keys(b).forEach(function(s){if(s.charAt(0)==="/"){T.texts[L][s]=b[s];}else{T[s]=b[s];}});b=T;}t=m(t,b.texts);D=m(D,b[":designtime"]);o=o||new J(i);a.mergeManifestPathChanges(o,b);}});a.mergeTextsChanges(o,t,D);}return i;},mergeCardDesigntimeMetadata:function(D,c){var i=m({},D);c.forEach(function(o){var I=o.content.entityPropertyChange||[];I.forEach(function(b){var p=b.propertyPath;switch(b.operation){case"UPDATE":if(i.hasOwnProperty(p)){i[p]=b.propertyValue;}break;case"DELETE":delete i[p];break;case"INSERT":if(!i.hasOwnProperty(p)){i[p]=b.propertyValue;}break;default:break;}});});return i;},translateObject:function(M,s,t,D){var v=M.getProperty(s);if(!v||typeof v!=="object"){return;}v=d(v,500);if(!Array.isArray(v)){var u=(v._dt||{})._uuid;if(u&&t[u]){if(D&&D[s]&&D[s][u]){for(var n in D[s][u]){if(D[s][u][n].translatable===false){delete t[u][n];}}}m(v,t[u]);M.setProperty(s,v);}}else{v.forEach(function(o){var u=(o._dt||{})._uuid;if(u&&t[u]){if(D&&D[s]&&D[s][u]){for(var n in D[s][u]){if(D[s][u][n].translatable===false){delete t[u][n];}}}m(o,t[u]);}});M.setProperty(s,v);return;}}};return a;});
