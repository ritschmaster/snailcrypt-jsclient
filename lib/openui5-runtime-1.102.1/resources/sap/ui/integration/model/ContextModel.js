/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/model/json/JSONModel","sap/base/Log","sap/ui/integration/util/Utils"],function(J,L,U){"use strict";var C=J.extend("sap.ui.integration.model.ContextModel",{constructor:function(d,o){J.apply(this,arguments);this._aPendingPromises=[];}});C.prototype.setHost=function(h){this._oHost=h;this.resetHostProperties();};C.prototype.getProperty=function(p,c){if(p&&!p.startsWith("/")&&!c){p="/"+p;}var h=this._oHost,a=this.resolve(p,c),b,H=h&&h.getContextValue;if(H){this._mValues=this._mValues||{};if(this._mValues[a]!==undefined){return this._mValues[a];}b=U.timeoutPromise(h.getContextValue(a.substring(1)));b=b.then(function(v){this._mValues[a]=v;this.checkUpdate();}.bind(this)).catch(function(r){this._mValues[a]=null;this.checkUpdate();L.error("Path "+a+" could not be resolved. Reason: "+r);}.bind(this));this._aPendingPromises.push(b);return null;}else{return J.prototype.getProperty.apply(this,arguments);}};C.prototype.resetHostProperties=function(){this._mValues={};};C.prototype.waitForPendingProperties=function(){var p=Promise.all(this._aPendingPromises);this._aPendingPromises=[];return p;};return C;});
