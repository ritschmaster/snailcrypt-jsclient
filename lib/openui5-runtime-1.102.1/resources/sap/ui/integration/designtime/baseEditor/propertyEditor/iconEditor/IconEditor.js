/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/integration/designtime/baseEditor/propertyEditor/BasePropertyEditor","sap/ui/core/ListItem","sap/ui/core/Fragment","sap/ui/model/json/JSONModel","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/core/IconPool","sap/ui/base/BindingParser","sap/ui/integration/designtime/baseEditor/util/isValidBindingString","./IsInIconPool.validator"],function(B,L,F,J,a,b,I,c,i,d){"use strict";var o=null;var e=B.extend("sap.ui.integration.designtime.baseEditor.propertyEditor.iconEditor.IconEditor",{xmlFragment:"sap.ui.integration.designtime.baseEditor.propertyEditor.iconEditor.IconEditor",metadata:{library:"sap.ui.integration"},renderer:B.getMetadata().getRenderer().render});e.configMetadata=Object.assign({},B.configMetadata,{typeLabel:{defaultValue:"BASE_EDITOR.TYPES.SIMPLEICON"}});e.prototype.onFragmentReady=function(){var f=this.getContent();this._oIconModel=this._getIconModel();f.setModel(this._oIconModel,"icons");f.bindAggregation("suggestionItems","icons>/",new L({text:"{icons>path}",additionalText:"{icons>name}"}));};e.prototype._getIconModel=function(){if(!o){o=new J(I.getIconNames().map(function(n){return{name:n,path:"sap-icon://"+n};}));}return o;};e.prototype._onChange=function(E){var s=E.getParameter("value");this.setValue(s);};e.prototype._onSuggestionItemSelected=function(E){this.setValue(E.getParameter("selectedItem").getText());};e.prototype._getDefaultSearchValue=function(s){try{var p=c.complexParser(s);return p?"":s;}catch(E){return s;}};e.prototype._handleValueHelp=function(E){var v=E.getSource().getValue();if(!this._oDialog){return F.load({name:"sap.ui.integration.designtime.baseEditor.propertyEditor.iconEditor.IconEditorDialog",controller:this}).then(function(D){this._oDialog=D;this.addDependent(this._oDialog);this._oDialog.setModel(this._oIconModel);this._filter(v);this._oDialog.open(this._getDefaultSearchValue(v));return this._oDialog;}.bind(this));}else{this._filter(v);this._oDialog.open(this._getDefaultSearchValue(v));return Promise.resolve(this._oDialog);}};e.prototype.handleSearch=function(E){var v=E.getParameter("value");this._filter(v);};e.prototype._filter=function(v){var f=new a("path",b.Contains,v);var g=this._oDialog.getBinding("items");g.filter([f]);};e.prototype.handleClose=function(E){var s=E.getParameter("selectedItem");if(s){this.setValue(s.getIcon());}E.getSource().getBinding("items").filter([]);};e.prototype.getDefaultValidators=function(){return Object.assign({},B.prototype.getDefaultValidators.call(this),{isValidBinding:{type:"isValidBinding"},isInIconPool:{type:"isInIconPool"}});};e.prototype.getDefaultValidatorModules=function(){return Object.assign({},B.prototype.getDefaultValidatorModules.apply(this,arguments),{isInIconPool:d});};return e;});
