/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./BaseAction","sap/base/Log","sap/ui/integration/util/BindingHelper","sap/ui/integration/util/BindingResolver","sap/ui/integration/util/Utils"],function(B,L,a,b,U){"use strict";var S=B.extend("sap.ui.integration.cards.actions.SubmitAction",{metadata:{library:"sap.ui.integration"}});S.prototype.execute=function(){var s=this.getSourceInstance(),o=this.getActionHandler();if(!o||!s.isA("sap.ui.integration.cards.BaseContent")){return;}var d=this.getCardInstance()._oDataProviderFactory,p=this.getParameters();s.onActionSubmitStart(p);var D=d.create({request:this._createRequest(o,p)});D.getData().then(function(r){s.onActionSubmitEnd(r,null);},function(e){L.error(e);s.onActionSubmitEnd(null,{error:e});}).finally(function(){d.remove(D);});};S.prototype._createRequest=function(s,d){return{mode:s.mode||"cors",url:s.url,method:s.method||"POST",parameters:this._resolveActionHandlerParams(s.parameters,d)||d,headers:s.headers,xhrFields:{withCredentials:!!s.withCredentials}};};S.prototype._resolveActionHandlerParams=function(A,d){var c=this.getCardInstance();c.getModel("form").setProperty("/",d.data);A=b.resolveValue(a.createBindingInfos(A,c.getBindingNamespaces()),this.getSourceInstance());U.makeUndefinedValuesNull(A);return A;};return S;});
