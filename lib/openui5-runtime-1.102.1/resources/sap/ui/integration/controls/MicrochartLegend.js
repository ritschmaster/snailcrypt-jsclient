/*!
* OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
*/
sap.ui.define(["./MicrochartLegendRenderer","sap/m/Text","sap/ui/core/Control","sap/ui/core/Core","sap/ui/core/theming/Parameters","sap/ui/integration/util/BindingHelper"],function(M,T,C,a,P,B){"use strict";var b=C.extend("sap.ui.integration.controls.MicrochartLegend",{metadata:{library:"sap.ui.integration",aggregations:{_titles:{type:"sap.m.Text",multiple:true,visibility:"hidden"}},associations:{chart:{type:"sap.ui.core.Control",multiple:false}},events:{colorsLoad:{}}},renderer:M});b.prototype.onBeforeRendering=function(){this._mLegendColors={};this._loadLegendColors();};b.prototype.onAfterRendering=function(){this._equalizeWidths();};b.prototype._equalizeWidths=function(){var $=this.$().children(".sapUiIntMicrochartLegendItem"),m=0;$.css("width","");$.each(function(){var c=this.getBoundingClientRect().width;if(c>m){m=c;}});$.css("min-width",m+"px");};b.prototype.initItemsTitles=function(c,p){this.destroyAggregation("_titles");c.forEach(function(o,i){var d=B.prependRelativePaths(o.legendTitle,p+"/"+i);var t=new T({text:d});t.addEventDelegate({onAfterRendering:this._equalizeWidths},this);this.addAggregation("_titles",t);}.bind(this));};b.prototype._loadLegendColors=function(){var c=a.byId(this.getChart()),n=[],p;if(c){n=c._calculateChartData().map(function(d){return d.color;}).filter(function(s){return s.startsWith("sapUi");});}if(n.length>0){p=P.get({name:n,callback:function(_){this._handleColorsLoad(n,_);}.bind(this)});}if(this._mLegendColors!==undefined){this._handleColorsLoad(n,p);}};b.prototype._handleColorsLoad=function(n,p){if(typeof p==="string"){this._mLegendColors={};this._mLegendColors[n[0]]=p;}else if(p){this._mLegendColors=p;}this.fireColorsLoad();};return b;});
