sap.ui.define(["sap/ui/webc/common/thirdparty/base/UI5Element","sap/ui/webc/common/thirdparty/base/renderer/LitRenderer","sap/ui/webc/common/thirdparty/base/delegate/ResizeHandler","sap/ui/webc/common/thirdparty/base/Render","sap/ui/webc/common/thirdparty/base/animations/slideDown","sap/ui/webc/common/thirdparty/base/animations/slideUp","sap/ui/webc/common/thirdparty/base/types/AnimationMode","sap/ui/webc/common/thirdparty/base/config/AnimationMode","sap/ui/webc/common/thirdparty/base/delegate/ItemNavigation","sap/ui/webc/common/thirdparty/base/Keys","sap/ui/webc/common/thirdparty/base/MediaRange","sap/ui/webc/common/thirdparty/base/i18nBundle","sap/ui/webc/common/thirdparty/icons/slim-arrow-up","sap/ui/webc/common/thirdparty/icons/slim-arrow-down","./generated/i18n/i18n-defaults","./Button","./Icon","./List","./ResponsivePopover","./types/TabContainerTabsPlacement","./types/SemanticColor","./generated/templates/TabContainerTemplate.lit","./generated/templates/TabContainerPopoverTemplate.lit","./generated/themes/TabContainer.css","./generated/themes/ResponsivePopoverCommon.css","./types/TabLayout","./types/TabsOverflowMode"],function(t,e,i,s,r,o,n,a,l,d,h,u,c,f,_,p,b,m,g,v,w,T,S,I,A,y,O){"use strict";function E(t){return t&&typeof t==="object"&&"default"in t?t["default"]:t}var R=E(t);var C=E(e);var x=E(i);var P=E(r);var B=E(o);var D=E(n);var M=E(l);var N=E(h);const L=[];const W=[];const k={tag:"ui5-tabcontainer",languageAware:true,managedSlots:true,fastNavigation:true,slots:{default:{propertyName:"items",type:HTMLElement,individualSlots:true,invalidateOnChildChange:{properties:true,slots:false}},overflowButton:{type:HTMLElement},startOverflowButton:{type:HTMLElement}},properties:{fixed:{type:Boolean},collapsed:{type:Boolean},tabsPlacement:{type:v,defaultValue:v.Top},showOverflow:{type:Boolean},tabLayout:{type:String,defaultValue:y.Standard},tabsOverflowMode:{type:O,defaultValue:O.End},mediaRange:{type:String},_selectedTab:{type:Object},_animationRunning:{type:Boolean,noAttribute:true},_contentCollapsed:{type:Boolean,noAttribute:true},_startOverflowText:{type:String,noAttribute:true,defaultValue:"0"},_endOverflowText:{type:String,noAttribute:true,defaultValue:"More"},_overflowItems:{type:Object,multiple:true}},events:{"tab-select":{detail:{tab:{type:HTMLElement},tabIndex:{type:Number}}}}};class F extends R{static get metadata(){return k}static get styles(){return[L,I]}static get staticAreaStyles(){return[A,W]}static get render(){return C}static get template(){return T}static get staticAreaTemplate(){return S}static registerTabStyles(t){L.push(t)}static registerStaticAreaTabStyles(t){W.push(t)}constructor(){super();this._handleResize=this._handleResize.bind(this);this._itemNavigation=new M(this,{getItemsCallback:()=>this._getFocusableTabs()})}onBeforeRendering(){this._allItemsAndSubItems=this._getAllSubItems(this.items);if(this._allItemsAndSubItems.length){const t=this._allItemsAndSubItems.filter(t=>t.selected);if(t.length){this._selectedTab=t[0]}else{this._selectedTab=this._allItemsAndSubItems[0];this._selectedTab._selected=true}}this._setItemsExternalProperties(this.items);if(!this._animationRunning){this._contentCollapsed=this.collapsed}if(this.showOverflow){console.warn(`The "show-overflow" property is deprecated and will be removed in a future release.`)}}onAfterRendering(){this.items.forEach(t=>{t._tabInStripDomRef=this.getDomRef().querySelector(`*[data-ui5-stable="${t.stableDomRef}"]`)})}onEnterDOM(){x.register(this._getHeader(),this._handleResize)}onExitDOM(){x.deregister(this._getHeader(),this._handleResize)}async _handleResize(){if(this.responsivePopover&&this.responsivePopover.opened){this.responsivePopover.close()}this._updateMediaRange();await s.renderFinished();this._setItemsForStrip()}_updateMediaRange(){this.mediaRange=N.getCurrentRange(N.RANGESETS.RANGE_4STEPS,this.getDomRef().offsetWidth)}_setItemsExternalProperties(t){t.filter(t=>!t.isSeparator).forEach((e,i,s)=>{e._isInline=this.tabLayout===y.Inline;e._mixedMode=this.mixedMode;e._posinset=i+1;e._setsize=s.length;e._getTabContainerHeaderItemCallback=t=>this.getDomRef().querySelector(`#${e._id}`);e._itemSelectCallback=this._onItemSelect.bind(this);e._getRealDomRef=()=>this.getDomRef().querySelector(`*[data-ui5-stable=${e.stableDomRef}]`);e._realTab=this._selectedTab;e._isTopLevelTab=this.items.some(t=>t===e);U(t,t=>{t._realTab=e._realTab})})}async _onTabStripClick(t){const e=V(t.target);if(!e||e._realTab.disabled){return}t.preventDefault();t.stopPropagation();if(t.target.hasAttribute("ui5-button")){this._onTabExpandButtonClick(t);return}if(!e._realTab._hasOwnContent&&e._realTab.tabs.length){this._overflowItems=e._realTab.subTabs;this._addStyleIndent(this._overflowItems);this.responsivePopover=await this._respPopover();if(this.responsivePopover.opened){this.responsivePopover.close()}else{this._setInitialFocus(this._getSelectedInPopover())}this.responsivePopover.showAt(e);return}this._onHeaderItemSelect(e)}async _onTabExpandButtonClick(t){t.stopPropagation();t.preventDefault();let e=t.target;let i=e.tab;if(i){i.focus()}if(t.type==="keydown"&&!t.target._realTab.isSingleClickArea){e=t.target.querySelectorAll(".ui5-tab-expand-button")[0];i=t.target._realTab}if(!i){this._onHeaderItemSelect(e.parentElement);return}this._overflowItems=i.subTabs;this._addStyleIndent(this._overflowItems);this.responsivePopover=await this._respPopover();if(this.responsivePopover.opened){this.responsivePopover.close()}else{this._setInitialFocus(this._getSelectedInPopover())}this.responsivePopover.showAt(e)}_setInitialFocus(t){if(t.length){this.responsivePopover.initialFocus=t[0].id}else{this.responsivePopover.initialFocus=this.responsivePopover.content[0].items.filter(t=>t.classList.contains("ui5-tab-overflow-item"))[0].id}}_onTabStripKeyDown(t){const e=V(t.target);if(!e||e._realTab.disabled){return}if(d.isEnter(t)){if(e._realTab.isSingleClickArea){this._onTabStripClick(t)}else{this._onHeaderItemSelect(e)}}if(d.isSpace(t)){t.preventDefault()}if(d.isDown(t)){if(e._realTab.requiresExpandButton){this._onTabExpandButtonClick(t)}if(e._realTab.isSingleClickArea){this._onTabStripClick(t)}}}_onTabStripKeyUp(t){const e=V(t.target);if(!e||e._realTab.disabled){return}if(d.isSpace(t)){t.preventDefault();if(e._realTab.isSingleClickArea){this._onTabStripClick(t)}else{this._onHeaderItemSelect(e)}}}_onHeaderItemSelect(t){if(!t.hasAttribute("disabled")){this._onItemSelect(t);if(!this.isModeStartAndEnd){this._setItemsForStrip()}}}async _onOverflowListItemClick(t){t.preventDefault();const{item:e}=t.detail;this._onItemSelect(e);await this.responsivePopover.close();this._setItemsForStrip();const i=this._getRootTab(this._selectedTab);i.focus()}_getAllSubItems(t,e=[],i=1){t.forEach(t=>{if(t.hasAttribute("ui5-tab")||t.hasAttribute("ui5-tab-separator")){t._level=i;e.push(t);if(t.subTabs){this._getAllSubItems(t.subTabs,e,i+1)}}});return e}_onItemSelect(t){const e=H(this._allItemsAndSubItems,e=>e.__id===t.id);const i=H(this._allItemsAndSubItems,e=>e.__id===t.id);const s=this._allItemsAndSubItems[e];this._allItemsAndSubItems.forEach((t,i)=>{const s=e===i;t.selected=s;if(t._selected){t._selected=false}});if(this.fixed){this.selectTab(s,i);return}if(!this.animate){this.toggle(s);this.selectTab(s,i);return}this.toggleAnimated(s);this.selectTab(s,i)}async toggleAnimated(t){const e=this.shadowRoot.querySelector(".ui5-tc__content");let i=null;this._animationRunning=true;if(t===this._selectedTab){this.collapsed=!this.collapsed;i=this.collapsed?this.slideContentUp(e):this.slideContentDown(e)}else{i=this.collapsed?this.slideContentDown(e):Promise.resolve();this.collapsed=false}await i;this._contentCollapsed=this.collapsed;this._animationRunning=false}toggle(t){if(t===this._selectedTab){this.collapsed=!this.collapsed}else{this.collapsed=false}}selectTab(t,e){this._selectedTab=t;this.fireEvent("tab-select",{tab:t,tabIndex:e})}slideContentDown(t){return P({element:t}).promise()}slideContentUp(t){return B({element:t}).promise()}async _onOverflowClick(t){if(t.target.classList.contains("ui5-tc__overflow")){return}const e=t.currentTarget;const i=e.classList.contains("ui5-tc__overflow--end");const s=e.classList.contains("ui5-tc__overflow--start");const r=[];const o=i?"end-overflow":"start-overflow";this._overflowItems=[];this.items.forEach(t=>{if(t.getTabInStripDomRef()&&t.getTabInStripDomRef().hasAttribute(o)){r.push(t)}});let n;if(i){n=this.overflowButton[0]||e.querySelector("[ui5-button]");this._overflowItems=r;this._addStyleIndent(this._overflowItems)}if(s){n=this.startOverflowButton[0]||e.querySelector("[ui5-button]");this._overflowItems=r;this._addStyleIndent(this._overflowItems)}this.responsivePopover=await this._respPopover();if(this.responsivePopover.opened){this.responsivePopover.close()}else{this.responsivePopover.initialFocus=this.responsivePopover.content[0].items.filter(t=>t.classList.contains("ui5-tab-overflow-item"))[0].id;await this.responsivePopover.showAt(n)}}_getSelectedInPopover(){return this.responsivePopover.content[0].items.filter(t=>t._realTab&&t._realTab.selected)}_addStyleIndent(t){const e=this._getAllSubItems(t).filter(t=>!t.isSeparator).some(t=>t.design!==w.Default&&t.design!==w.Neutral);U(t,t=>{let i=t._level-1;if(t.isSeparator){i+=1}t._style={"--_ui5-tab-indentation-level":i,"--_ui5-tab-extra-indent":e?1:null}})}async _onOverflowKeyDown(t){const e=t.currentTarget.classList.contains("ui5-tc__overflow--end");const i=t.currentTarget.classList.contains("ui5-tc__overflow--start");if(d.isDown(t)||i&&d.isLeft(t)||e&&d.isRight(t)){await this._onOverflowClick(t)}}_setItemsForStrip(){const t=this._getTabStrip();let e=0;if(!this._selectedTab){return}const i=this.items.map(t=>t.getTabInStripDomRef());this._getStartOverflow().setAttribute("hidden","");this._getEndOverflow().setAttribute("hidden","");for(let t=0;t<i.length;t++){i[t].removeAttribute("hidden");i[t].removeAttribute("start-overflow");i[t].removeAttribute("end-overflow")}i.forEach(t=>{e+=this._getItemWidth(t)});const s=t.offsetWidth<e;if(!s){this._closeRespPopover();return}if(this.isModeStartAndEnd){this._updateStartAndEndOverflow(i);this._updateOverflowCounters()}else{this._updateEndOverflow(i)}this._itemNavigation._init();this._itemNavigation.setCurrentItem(this._getRootTab(this._selectedTab))}_getRootTab(t){while(t.hasAttribute("ui5-tab")){if(t.parentElement.hasAttribute("ui5-tabcontainer")){break}t=t.parentElement}return t}_updateEndOverflow(t){this._getEndOverflow().removeAttribute("hidden");const e=this._getRootTab(this._selectedTab);const i=e.getTabInStripDomRef();const s=this._getTabStrip().offsetWidth;const r=this._getSelectedItemIndexAndWidth(t,i);const o=this._findLastVisibleItem(t,s,r.width);for(let e=o+1;e<t.length;e++){t[e].setAttribute("hidden","");t[e].setAttribute("end-overflow","")}this._endOverflowText=this.overflowButtonText}_updateStartAndEndOverflow(t){let e=this._getTabStrip().offsetWidth;const i=this._getRootTab(this._selectedTab);const s=i.getTabInStripDomRef();const r=this._getSelectedItemIndexAndWidth(t,s);const o=this._hasStartOverflow(e,t,r);const n=this._hasEndOverflow(e,t,r);let a;let l;if(!o){this._getEndOverflow().removeAttribute("hidden");e=this._getTabStrip().offsetWidth;l=this._findLastVisibleItem(t,e,r.width);for(let e=l+1;e<t.length;e++){t[e].setAttribute("hidden","");t[e].setAttribute("end-overflow","")}return}if(!n){this._getStartOverflow().removeAttribute("hidden");e=this._getTabStrip().offsetWidth;a=this._findFirstVisibleItem(t,e,r.width);for(let e=a-1;e>=0;e--){t[e].setAttribute("hidden","");t[e].setAttribute("start-overflow","")}return}this._getStartOverflow().removeAttribute("hidden");this._getEndOverflow().removeAttribute("hidden");e=this._getTabStrip().offsetWidth;a=this._findFirstVisibleItem(t,e,r.width,r.index-1);l=this._findLastVisibleItem(t,e,r.width,a);for(let e=a-1;e>=0;e--){t[e].setAttribute("hidden","");t[e].setAttribute("start-overflow","")}for(let e=l+1;e<t.length;e++){t[e].setAttribute("hidden","");t[e].setAttribute("end-overflow","")}}_hasStartOverflow(t,e,i){if(i.index===0){return false}let s=0;for(let t=i.index-1;t>=0;t--){s+=this._getItemWidth(e[t])}let r=t<s+i.width;if(!r){this._getEndOverflow().removeAttribute("hidden");t=this._getTabStrip().offsetWidth;r=t<s+i.width;this._getEndOverflow().setAttribute("hidden","")}return r}_hasEndOverflow(t,e,i){if(i.index>=e.length){return false}let s=0;for(let t=i.index;t<e.length;t++){s+=this._getItemWidth(e[t])}let r=t<s+i.width;if(!r){this._getStartOverflow().removeAttribute("hidden");t=this._getTabStrip().offsetWidth;r=t<s+i.width;this._getStartOverflow().setAttribute("hidden","")}return r}_getItemWidth(t){const e=window.getComputedStyle(t);const i=Number.parseInt(e.marginLeft)+Number.parseInt(e.marginRight);return t.offsetWidth+i}_getSelectedItemIndexAndWidth(t,e){let i=t.indexOf(e);let s=e.offsetWidth;let r;if(t[i-1]&&t[i-1].isSeparator){r=t[i-1];s+=this._getItemWidth(r)}t.splice(i,1);if(r){t.splice(i-1,1);i--}return{index:i,width:s}}_findFirstVisibleItem(t,e,i,s){if(s===undefined){s=t.length-1}let r=s+1;for(let o=s;o>=0;o--){const s=this._getItemWidth(t[o]);if(e<i+s){break}i+=s;r=o}return r}_findLastVisibleItem(t,e,i,s){s=s||0;let r=s-1;let o=s;for(;o<t.length;o++){const s=this._getItemWidth(t[o]);if(e<i+s){break}i+=s;r=o}const n=t[o-1];if(n&&n.isSeparator){r-=1}return r}get isModeStartAndEnd(){return this.tabsOverflowMode===O.StartAndEnd}_updateOverflowCounters(){let t=0;let e=0;this._getTabs().map(t=>t.getTabInStripDomRef()).forEach(i=>{if(i.hasAttribute("start-overflow")){t++}if(i.hasAttribute("end-overflow")){e++}});this._startOverflowText=`+${t}`;this._endOverflowText=`+${e}`}async _closeRespPopover(){this.responsivePopover=await this._respPopover();this.responsivePopover.close()}_getFocusableTabs(){if(!this.getDomRef()){return[]}const t=[];if(!this._getStartOverflow().hasAttribute("hidden")){if(this._getCustomStartOverflowBtnDOM()){t.push(this._getCustomStartOverflowBtnDOM())}else{t.push(this._getStartOverflowBtnDOM())}}this._getTabs().forEach(e=>{if(e.getTabInStripDomRef()&&!e.getTabInStripDomRef().hasAttribute("hidden")){t.push(e)}});if(!this._getEndOverflow().hasAttribute("hidden")){if(this._getCustomEndOverflowBtnDOM()){t.push(this._getCustomEndOverflowBtnDOM())}else{t.push(this._getEndOverflowBtnDOM())}}return t}_getHeader(){return this.shadowRoot.querySelector(`#${this._id}-header`)}_getTabs(){return this.items.filter(t=>!t.isSeparator)}_getTabStrip(){return this.shadowRoot.querySelector(`#${this._id}-tabStrip`)}_getStartOverflow(){return this.shadowRoot.querySelector(".ui5-tc__overflow--start")}_getEndOverflow(){return this.shadowRoot.querySelector(".ui5-tc__overflow--end")}_getCustomStartOverflowBtnDOM(){return this.shadowRoot.querySelector("slot[name=startOverflowButton]")}_getStartOverflowBtnDOM(){return this._getStartOverflow().querySelector("[ui5-button]")}_getCustomEndOverflowBtnDOM(){return this.shadowRoot.querySelector("slot[name=overflowButton]")}_getEndOverflowBtnDOM(){return this._getEndOverflow().querySelector("[ui5-button]")}async _respPopover(){const t=await this.getStaticAreaItemDomRef();return t.querySelector(`#${this._id}-overflowMenu`)}get classes(){return{root:{"ui5-tc-root":true,"ui5-tc--textOnly":this.textOnly,"ui5-tc--withAdditionalText":this.withAdditionalText,"ui5-tc--standardTabLayout":this.standardTabLayout},header:{"ui5-tc__header":true},tabStrip:{"ui5-tc__tabStrip":true},separator:{"ui5-tc__separator":true},content:{"ui5-tc__content":true,"ui5-tc__content--collapsed":this._contentCollapsed}}}get mixedMode(){return this.items.some(t=>t.icon)&&this.items.some(t=>t.text)}get textOnly(){return this.items.every(t=>!t.icon)}get withAdditionalText(){return this.items.some(t=>!!t.additionalText)}get standardTabLayout(){return this.tabLayout===y.Standard}get previousIconACCName(){return F.i18nBundle.getText(_.TABCONTAINER_PREVIOUS_ICON_ACC_NAME)}get nextIconACCName(){return F.i18nBundle.getText(_.TABCONTAINER_NEXT_ICON_ACC_NAME)}get overflowMenuTitle(){return F.i18nBundle.getText(_.TABCONTAINER_OVERFLOW_MENU_TITLE)}get tabsAtTheBottom(){return this.tabsPlacement===v.Bottom}get overflowMenuIcon(){return this.tabsAtTheBottom?"slim-arrow-up":"slim-arrow-down"}get overflowButtonText(){return F.i18nBundle.getText(_.TABCONTAINER_END_OVERFLOW)}get popoverCancelButtonText(){return F.i18nBundle.getText(_.TABCONTAINER_POPOVER_CANCEL_BUTTON)}get animate(){return a.getAnimationMode()!==D.None}static get dependencies(){return[p,b,m,g]}static async onDefine(){F.i18nBundle=await u.getI18nBundle("@ui5/webcomponents")}}const q=t=>t.localName==="div"&&t.getAttribute("role")==="tab";const V=t=>{while(t){if(q(t)){return t}t=t.parentElement}return false};const H=(t,e)=>{for(let i=0;i<t.length;i++){const s=e(t[i]);if(s){return i}}return-1};const U=(t,e)=>{[...t].forEach(t=>{e(t);if(t.subTabs){U(t.subTabs,e)}})};F.define();return F});