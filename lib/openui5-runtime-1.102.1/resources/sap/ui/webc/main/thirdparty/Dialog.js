sap.ui.define(["sap/ui/webc/common/thirdparty/base/Device","sap/ui/webc/common/thirdparty/base/util/clamp","sap/ui/webc/common/thirdparty/base/delegate/ResizeHandler","sap/ui/webc/common/thirdparty/base/Keys","./Popup","sap/ui/webc/common/thirdparty/icons/resize-corner","./Icon","./generated/templates/DialogTemplate.lit","./generated/themes/BrowserScrollbar.css","./generated/themes/PopupsCommon.css","./generated/themes/Dialog.css"],function(e,t,i,s,n,r,a,h,o,l,d){"use strict";function u(e){return e&&typeof e==="object"&&"default"in e?e["default"]:e}var p=u(t);var _=u(i);const c=16;const g={tag:"ui5-dialog",slots:{header:{type:HTMLElement},footer:{type:HTMLElement}},properties:{headerText:{type:String},stretch:{type:Boolean},draggable:{type:Boolean},resizable:{type:Boolean},onPhone:{type:Boolean},onDesktop:{type:Boolean}}};class f extends n{constructor(){super();this._screenResizeHandler=this._center.bind(this);this._dragMouseMoveHandler=this._onDragMouseMove.bind(this);this._dragMouseUpHandler=this._onDragMouseUp.bind(this);this._resizeMouseMoveHandler=this._onResizeMouseMove.bind(this);this._resizeMouseUpHandler=this._onResizeMouseUp.bind(this)}static get metadata(){return g}static get dependencies(){return[a]}static get template(){return h}static get styles(){return[o,l,d]}static _isHeader(e){return e.classList.contains("ui5-popup-header-root")||e.getAttribute("slot")==="header"}async show(e=false){await super._open(e)}get isModal(){return true}get shouldHideBackdrop(){return false}get _ariaLabelledBy(){let e;if(this.headerText!==""&&!this._ariaLabel){e="ui5-popup-header-text"}return e}get _ariaModal(){return true}get _displayProp(){return"flex"}get _displayHeader(){return this.header.length||this.headerText||this.draggable||this.resizable}get _movable(){return!this.stretch&&this.onDesktop&&(this.draggable||this.resizable)}get _headerTabIndex(){return this._movable?"0":undefined}get _showResizeHandle(){return this.resizable&&this.onDesktop}_show(){super._show();this._center()}onBeforeRendering(){this._isRTL=this.effectiveDir==="rtl";this.onPhone=e.isPhone();this.onDesktop=e.isDesktop()}onAfterRendering(){if(!this.isOpen()&&this.open){this.show()}else if(this.isOpen()&&!this.open){this.close()}}onEnterDOM(){super.onEnterDOM();this._attachResizeHandlers()}onExitDOM(){super.onExitDOM();this._detachResizeHandlers()}_resize(){super._resize();if(this._resizeHandlersAttached){this._center()}}_attachResizeHandlers(){if(!this._resizeHandlersAttached){_.register(document.body,this._screenResizeHandler);this._resizeHandlersAttached=true}}_detachResizeHandlers(){if(this._resizeHandlersAttached){_.deregister(document.body,this._screenResizeHandler);this._resizeHandlersAttached=false}}_center(){const e=window.innerHeight-this.offsetHeight,t=window.innerWidth-this.offsetWidth;Object.assign(this.style,{top:`${Math.round(e/2)}px`,left:`${Math.round(t/2)}px`})}_revertSize(){Object.assign(this.style,{top:"",left:"",width:"",height:""});this.removeEventListener("ui5-before-close",this._revertSize)}_onDragMouseDown(e){if(!this._movable||!this.draggable||!f._isHeader(e.target)){return}e.preventDefault();const{top:t,left:i}=this.getBoundingClientRect();const{width:s,height:n}=window.getComputedStyle(this);Object.assign(this.style,{top:`${t}px`,left:`${i}px`,width:`${Math.round(Number.parseFloat(s)*100)/100}px`,height:`${Math.round(Number.parseFloat(n)*100)/100}px`});this._x=e.clientX;this._y=e.clientY;this._attachMouseDragHandlers()}_onDragMouseMove(e){e.preventDefault();const t=this._x-e.clientX;const i=this._y-e.clientY;const{left:s,top:n}=this.getBoundingClientRect();Object.assign(this.style,{left:`${Math.floor(s-t)}px`,top:`${Math.floor(n-i)}px`});this._x=e.clientX;this._y=e.clientY}_onDragMouseUp(){this._x=null;this._y=null;this._detachMouseDragHandlers()}_onDragOrResizeKeyDown(e){if(!this._movable||!f._isHeader(e.target)){return}if(this.draggable&&[s.isUp,s.isDown,s.isLeft,s.isRight].some(t=>t(e))){this._dragWithEvent(e);return}if(this.resizable&&[s.isUpShift,s.isDownShift,s.isLeftShift,s.isRightShift].some(t=>t(e))){this._resizeWithEvent(e)}}_dragWithEvent(e){const{top:t,left:i,width:n,height:r}=this.getBoundingClientRect();let a,h;switch(true){case s.isUp(e):a=t-c;h="top";break;case s.isDown(e):a=t+c;h="top";break;case s.isLeft(e):a=i-c;h="left";break;case s.isRight(e):a=i+c;h="left";break}a=p(a,0,h==="left"?window.innerWidth-n:window.innerHeight-r);this.style[h]=`${a}px`}_resizeWithEvent(e){this._detachResizeHandlers();this.addEventListener("ui5-before-close",this._revertSize);const{top:t,left:i}=this.getBoundingClientRect(),n=window.getComputedStyle(this),r=Number.parseFloat(n.minWidth),a=Number.parseFloat(n.minHeight),h=window.innerWidth-i,o=window.innerHeight-t;let l=Number.parseFloat(n.width),d=Number.parseFloat(n.height);switch(true){case s.isUpShift(e):d-=c;break;case s.isDownShift(e):d+=c;break;case s.isLeftShift(e):l-=c;break;case s.isRightShift(e):l+=c;break}l=p(l,r,h);d=p(d,a,o);Object.assign(this.style,{width:`${l}px`,height:`${d}px`})}_attachMouseDragHandlers(){this._detachResizeHandlers();window.addEventListener("mousemove",this._dragMouseMoveHandler);window.addEventListener("mouseup",this._dragMouseUpHandler)}_detachMouseDragHandlers(){window.removeEventListener("mousemove",this._dragMouseMoveHandler);window.removeEventListener("mouseup",this._dragMouseUpHandler)}_onResizeMouseDown(e){if(!this._movable||!this.resizable){return}e.preventDefault();const{top:t,left:i}=this.getBoundingClientRect();const{width:s,height:n,minWidth:r,minHeight:a}=window.getComputedStyle(this);this._initialX=e.clientX;this._initialY=e.clientY;this._initialWidth=Number.parseFloat(s);this._initialHeight=Number.parseFloat(n);this._initialTop=t;this._initialLeft=i;this._minWidth=Number.parseFloat(r);this._minHeight=Number.parseFloat(a);Object.assign(this.style,{top:`${t}px`,left:`${i}px`});this._attachMouseResizeHandlers()}_onResizeMouseMove(e){const{clientX:t,clientY:i}=e;let s,n;if(this._isRTL){s=p(this._initialWidth-(t-this._initialX),this._minWidth,this._initialLeft+this._initialWidth);n=p(this._initialLeft+(t-this._initialX),0,this._initialX+this._initialWidth-this._minWidth)}else{s=p(this._initialWidth+(t-this._initialX),this._minWidth,window.innerWidth-this._initialLeft)}const r=p(this._initialHeight+(i-this._initialY),this._minHeight,window.innerHeight-this._initialTop);Object.assign(this.style,{height:`${r}px`,width:`${s}px`,left:n?`${n}px`:undefined})}_onResizeMouseUp(){this._initialX=null;this._initialY=null;this._initialWidth=null;this._initialHeight=null;this._initialTop=null;this._initialLeft=null;this._minWidth=null;this._minHeight=null;this._detachMouseResizeHandlers()}_attachMouseResizeHandlers(){this._detachResizeHandlers();window.addEventListener("mousemove",this._resizeMouseMoveHandler);window.addEventListener("mouseup",this._resizeMouseUpHandler);this.addEventListener("ui5-before-close",this._revertSize)}_detachMouseResizeHandlers(){window.removeEventListener("mousemove",this._resizeMouseMoveHandler);window.removeEventListener("mouseup",this._resizeMouseUpHandler)}}f.define();return f});