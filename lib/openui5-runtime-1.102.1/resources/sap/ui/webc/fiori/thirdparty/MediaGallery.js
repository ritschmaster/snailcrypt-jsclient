sap.ui.define(["sap/ui/webc/common/thirdparty/base/delegate/ItemNavigation","sap/ui/webc/common/thirdparty/base/delegate/ResizeHandler","sap/ui/webc/common/thirdparty/base/Device","sap/ui/webc/common/thirdparty/base/MediaRange","sap/ui/webc/common/thirdparty/base/renderer/LitRenderer","sap/ui/webc/common/thirdparty/base/types/Integer","sap/ui/webc/common/thirdparty/base/types/NavigationMode","sap/ui/webc/common/thirdparty/base/UI5Element","sap/ui/webc/main/thirdparty/Button","sap/ui/webc/main/thirdparty/Carousel","./MediaGalleryItem","./types/MediaGalleryItemLayout","./types/MediaGalleryLayout","./types/MediaGalleryMenuHorizontalAlign","./types/MediaGalleryMenuVerticalAlign","./generated/templates/MediaGalleryTemplate.lit","./generated/themes/MediaGallery.css"],function(e,t,i,a,s,l,n,r,o,h,u,d,c,m,_,f,g){"use strict";function y(e){return e&&typeof e==="object"&&"default"in e?e["default"]:e}var p=y(e);var v=y(t);var I=y(a);var b=y(s);var w=y(l);var S=y(n);var M=y(r);var A=y(o);var H=y(h);const T={S:1,M:2,L:3,XL:4};const L={tag:"ui5-media-gallery",managedSlots:true,slots:{default:{propertyName:"items",type:HTMLElement,individualSlots:true,invalidateOnChildChange:true}},properties:{showAllThumbnails:{type:Boolean},interactiveDisplayArea:{type:Boolean},layout:{type:c,defaultValue:"Auto"},menuHorizontalAlign:{type:m,defaultValue:m.Left},menuVerticalAlign:{type:_,defaultValue:_.Bottom},effectiveLayout:{type:c,defaultValue:"Vertical"},mediaRange:{type:String},_overflowSize:{type:w,noAttribute:true,defaultValue:0}},events:{"selection-change":{detail:{item:{type:HTMLElement}}},"overflow-click":{},"display-area-click":{}}};class R extends M{constructor(){super();this._onResize=this._updateLayout.bind(this);this._selectedItem=null;this._initItemNavigation()}onEnterDOM(){!i.isPhone()&&v.register(this,this._onResize)}onExitDOM(){!i.isPhone()&&v.deregister(this,this._onResize)}onAfterRendering(){this._updateLayout();this._updateSelection()}_initItemNavigation(){if(!this._itemNavigation){this._itemNavigation=new p(this,{navigationMode:S.Auto,getItemsCallback:()=>this._getFocusableItems()})}}_updateSelection(){let e=this.items.find(e=>e.selected);if(!e||!this._isSelectableItem(e)){e=this._findSelectableItem()}if(e&&e!==this._selectedItem){this._selectItem(e)}}_isSelectableItem(e){return!e.disabled&&!e.hidden}_findSelectableItem(){return this.items.find(this._isSelectableItem)}_updateMediaRange(e){this.mediaRange=I.getCurrentRange(I.RANGESETS.RANGE_4STEPS,e)}_updateLayout(){const e=this.getDomRef(),t=e.offsetHeight,a=e.offsetWidth;if(!a||!t||i.isPhone()){return}this._updateMediaRange(a);this.effectiveLayout=this._infereffectiveLayout();this._overflowSize=this._calculateOverflowSize(a,t);this._toggleDisplaySquareSize(this._shouldHaveSquareDisplay);this._toggleMainItem9x16size(this._shouldHaveWideDisplay)}_calculateOverflowSize(e,t){const i=R.THUMBNAIL_MARGIN;let a,s;if(this.showAllThumbnails){return 0}if(this.effectiveLayout===c.Horizontal){a=t-i;s=this.showAllThumbnails?T[this.mediaRange]:1}else{a=e-i*2;s=1}return this._getOverflowSize(a,s)}_toggleDisplaySquareSize(e){this._display.style.width="";if(e){const e=R.THUMBNAIL_MARGIN,t=this._display.offsetWidth;let i=this.getDomRef().offsetHeight-2*e;if(this.effectiveLayout===c.Vertical){i-=R.THUMBNAIL_HEIGHT+e}if(t>i){this._display.style.width=`${i}px`}}}_toggleMainItem9x16size(e){if(!this._mainItem){return}const t=this._mainItem.offsetWidth,i=e?`${t/16*9}px`:"";this._mainItem.contentHeight=i}_infereffectiveLayout(){if(this.layout===c.Auto){return this._isPhoneSize?c.Vertical:c.Horizontal}return this.layout}_getMaxAllowedThumbnailsInColumn(e){let t=Math.floor(e/R.THUMBNAIL_HEIGHT);if(!this.showAllThumbnails){t=Math.min(t,5)}return t}_getOverflowSize(e,t){const i=this._getMaxAllowedThumbnailsInColumn(e),a=Math.max(0,this.items.length-i*t);if(a===this.items.length||a===0){return a}return a+1}_getFocusableItems(){if(!this._showThumbnails){return[]}const e=this._visibleItems.filter(e=>!e.disabled);if(this._overflowBtn){e.push(this._overflowBtn)}return e}_selectItem(e,t){if(e===this._selectedItem){return}this._selectedItem=e;this._updateSelectedFlag(e);this._itemNavigation.setCurrentItem(e);if(t){this.fireEvent("selection-change",{item:e})}if(i.isPhone()){this._selectItemOnPhone(e)}else{this._displayContent(e)}}_updateSelectedFlag(e){this.items.forEach(e=>{e.selected=false});e.selected=true}_selectItemOnPhone(e){const t=this._selectableItems.indexOf(e),i=this._carousel;i&&i.navigateTo(t)}_displayContent(e){let t;const i=this._mainItem,a=i._content,s=e._content;i._thumbnailDesign=false;a&&a.remove();if(s){t=s.cloneNode(true);i.layout=e.layout;i.appendChild(t)}}_onThumbnailClick(e){const t=e.target.closest("[ui5-media-gallery-item]");if(t.disabled){return}if(t!==this._selectedItem){this._selectItem(t,true)}}_onOverflowBtnClick(){this.fireEvent("overflow-click")}_onDisplayAreaClick(e){if(!this.interactiveDisplayArea){return}this.fireEvent("display-area-click")}_onCarouselNavigate(e){const t=e.detail.selectedIndex,i=this._selectableItems[t];this.fireEvent("selection-change",{item:i})}get _mainItemTabIndex(){return this.interactiveDisplayArea?0:undefined}get _selectableItems(){return this.items.filter(this._isSelectableItem)}get _carousel(){return this.shadowRoot.querySelector("[ui5-carousel]")}get _display(){return this.shadowRoot.querySelector(".ui5-media-gallery-display")}get _mainItem(){return this.shadowRoot.querySelector(".ui5-media-gallery-display [ui5-media-gallery-item]")}get _overflowBtn(){return this.shadowRoot.querySelector(".ui5-media-gallery-overflow [ui5-button]")}get _visibleItems(){const e=this.items.length-this._overflowSize;return this.items.slice(0,e)}get _isPhonePlatform(){return i.isPhone()}get _showThumbnails(){return!i.isPhone()}get _showOverflowBtn(){return this._overflowSize>0}get _isPhoneSize(){return this.mediaRange==="S"}get _mainItemHasWideLayout(){return this._mainItem&&this._mainItem.layout===d.Wide}get _shouldHaveWideDisplay(){return this._mainItemHasWideLayout&&this.showAllThumbnails&&this.effectiveLayout===c.Horizontal}get _shouldHaveSquareDisplay(){return!this._shouldHaveWideDisplay}static get metadata(){return L}static get render(){return b}static get template(){return f}static get staticAreaTemplate(){return f}static get styles(){return[g]}static get staticAreaStyles(){return null}static get dependencies(){return[u,A,H]}static get THUMBNAIL_HEIGHT(){return 80}static get THUMBNAIL_MARGIN(){return 16}}R.define();return R});