/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/fl/LayerUtils","sap/ui/fl/changeHandler/condenser/Classification","sap/ui/fl/changeHandler/JsControlTreeModifier"],function(L,C,J){"use strict";var S={};S.applyChange=function(c,o,p){var s;var m=p.modifier;return Promise.resolve().then(m.getStashed.bind(m,o)).then(function(r){s=r;return m.findIndexInParentAggregation(o);}).then(function(O){this.setChangeRevertData(c,s,O);if(L.isDeveloperLayer(c.getLayer())){return m.setStashed(o,true);}return m.setVisible(o,false);}.bind(this));};function h(u,r,U,m){var a;if(u!==r.originalIndex){var p=m.getParent(U);return Promise.return().then(m.getParentAggregationName.bind(m,U)).then(function(R){a=R;return m.removeAggregation(p,a,U);}).then(m.insertAggregation.bind(m,p,a,U,r.originalIndex));}return Promise.resolve();}S.revertChange=function(c,o,p){var r=c.getRevertData();var m=p.modifier;return Promise.resolve().then(function(){if(L.isDeveloperLayer(c.getLayer())){var u=m.setStashed(o,r.originalValue,p.appComponent);if(u){return Promise.resolve().then(m.findIndexInParentAggregation.bind(m,u)).then(function(U){return h(U,r,u,m);});}return Promise.resolve();}return m.setVisible(o,!r.originalValue);}).then(function(){c.resetRevertData();});};S.completeChangeContent=function(){};S.setChangeRevertData=function(c,v,o){c.setRevertData({originalValue:v,originalIndex:o});};S.getCondenserInfo=function(c){return{affectedControl:c.getSelector(),classification:C.Reverse,uniqueKey:"stashed"};};S.getChangeVisualizationInfo=function(c,a){var s=c.getSelector();var e=J.bySelector(s,a);return{affectedControls:[s],displayControls:[e.getParent().getId()]};};return S;});
