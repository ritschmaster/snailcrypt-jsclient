/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/fl/Utils","sap/ui/util/Storage","sap/ui/fl/write/_internal/fieldExtensibility/UriParser"],function(U,S,a){"use strict";var b={};var _="sap.ui.fl.fieldExt.Access";var c=1*7*24*60*60*1000;function d(){return Date.now();}function e(){return b.getLocalStorage();}function f(){return e()&&e().isSupported();}function g(){if(!f()){return{};}var s=e().get(_);if(!s){return{};}return JSON.parse(s);}function h(s){return s.expirationDate<=d();}function i(s){return g()[s.serviceKey]||null;}function j(s){var E=d()+c;var o=m();var p=k(s);return{serviceKey:o.getName()+o.getClient()+p.serviceName+p.serviceVersion,expirationDate:E};}function k(s){if(typeof s==="string"){return a.parseServiceUri(s);}return s;}function l(){return m();}function m(){var u=U.getUshellContainer();return u&&u.getLogonSystem();}function n(D){if(f()){e().put(_,JSON.stringify(D));}}b.getLocalStorage=function(){return new S(S.Type.local);};b.isServiceOutdated=function(s){if(!l()){return false;}var o=i(j(s));if(o){if(h(o)){this.setServiceValid(s);return false;}return true;}return false;};b.setServiceValid=function(s){if(l()){var D=g();delete D[j(s).serviceKey];n(D);}};b.setServiceInvalid=function(s){if(l()){var D=g();var I=j(s);D[I.serviceKey]=I;n(D);}};return b;});
