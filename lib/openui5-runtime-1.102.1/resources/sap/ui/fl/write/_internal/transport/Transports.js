/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/fl/initial/_internal/connectors/LrepConnector","sap/ui/fl/Utils","sap/ui/fl/initial/_internal/connectors/Utils","sap/ui/fl/write/_internal/connectors/Utils"],function(A,F,I,W){"use strict";var R={ACTION_GET_TRANSPORTS:"/actions/gettransports/",ACTION_MAKE_CHANGE_TRANSPORTABLE:"/actions/make_changes_transportable/",ACTION_GET_TOKEN:"/actions/getcsrftoken/"};return{getTransports:function(p){if(F.getClient()){p["sap-client"]=F.getClient();}var g=I.getUrl(R.ACTION_GET_TRANSPORTS,{url:F.getLrepUrl()},p);g=decodeURIComponent(g);return I.sendRequest(g,"GET").then(function(r){if(r.response){if(!r.response.localonly){r.response.localonly=false;}if(!r.response.errorCode){r.response.errorCode="";}return Promise.resolve(r.response);}return Promise.reject('response is empty');});},makeChangesTransportable:function(p){if(!p.transportId){return Promise.reject(new Error("no transportId provided as attribute of mParameters"));}if(!p.changeIds){return Promise.reject(new Error("no changeIds provided as attribute of mParameters"));}if(!p.reference){return Promise.reject(new Error("no reference provided as attribute of mParameters"));}var u=F.getClient()?{"sap-client":F.getClient()}:{};var m=I.getUrl(R.ACTION_MAKE_CHANGE_TRANSPORTABLE,{url:F.getLrepUrl()},u);var t=I.getUrl(R.ACTION_GET_TOKEN,{url:F.getLrepUrl()});var r=W.getRequestOptions(A,t,p,"application/json; charset=utf-8","json");return W.sendRequest(m,"POST",r);},convertToChangeTransportData:function(l,a){var t=[];var i;if(a&&a.length){for(i=0;i<a.length;i++){var o=a[i];var p={};p.namespace=o.getNamespace();p.fileName=o.getDefinition().fileName;p.fileType=o.getDefinition().fileType;t.push(p);}}var b=l.length;for(i=0;i<b;i++){var c=l[i];var d={};d.namespace=c.getNamespace();d.fileName=c.getId();d.fileType=c.getDefinition().fileType;t.push(d);}return t;}};},true);
