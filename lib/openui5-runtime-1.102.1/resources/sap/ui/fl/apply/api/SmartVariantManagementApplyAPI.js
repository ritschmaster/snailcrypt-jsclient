/*
 * ! OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/fl/apply/_internal/flexState/compVariants/CompVariantMerger","sap/ui/fl/apply/_internal/flexState/compVariants/Utils","sap/ui/fl/apply/_internal/flexState/FlexState","sap/ui/fl/apply/_internal/flexState/ManifestUtils","sap/ui/fl/Utils","sap/ui/fl/LayerUtils"],function(C,a,F,M,U,L){"use strict";function g(o){var r=M.getFlexReferenceForControl(o);var p=a.getPersistencyKey(o);var m=F.getCompVariantsMap(r);return m._getOrCreate(p);}function b(p){var o=p.control;var r=M.getFlexReferenceForControl(o);return F.initialize({reference:r,componentData:{},manifest:U.getAppDescriptor(o),componentId:U.getAppComponentForControl(o).getId()}).then(function(){var P=a.getPersistencyKey(o);var m=F.getCompVariantsMap(r);F.setInitialNonFlCompVariantData(r,P,p.standardVariant,p.variants);return m._initialize(P,p.variants);});}function c(s){if(s.length>0&&s.indexOf(".Component")<0){s+=".Component";}return s;}var S={loadVariants:function(p){return b(p).then(function(m){var P=a.getPersistencyKey(p.control);return C.merge(P,m,p.standardVariant);});},isApplicationVariant:function(p){var o=p.control;var A=U.getAppComponentForControl(o);var f=M.getFlexReferenceForControl(A);var s=c(U.getAppIdFromManifest(A.getManifest()));if(f!==s){return true;}var d=U.getComponentForControl(o);if(d&&d.getAppComponent){d=d.getAppComponent();if(d){return true;}}return false;},isVendorLayer:function(){return L.isVendorLayer();},isVariantDownport:function(){return S.isVendorLayer()&&U.isHotfixMode();},getDefaultVariantId:function(p){var d=g(p.control).defaultVariants;var o=d[d.length-1];return o?o.getContent().defaultVariantName:"";}};return S;});
