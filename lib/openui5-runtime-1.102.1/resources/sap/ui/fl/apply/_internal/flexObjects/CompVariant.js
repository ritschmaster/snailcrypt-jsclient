/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/util/restricted/_pick","sap/ui/fl/apply/_internal/flexObjects/States","sap/ui/fl/Change","sap/ui/fl/Layer","sap/ui/fl/registry/Settings","sap/ui/fl/LayerUtils","sap/ui/fl/Utils"],function(_,S,C,L,a,b,U){"use strict";function i(A){var s=a.getInstanceOrUndef();var u=s&&s.getUserId();return!u||u.toUpperCase()===A.toUpperCase();}function c(l,A,u){if(A){return l===A;}else if(l===L.USER){return true;}var s=a.getInstanceOrUndef();if(b.isSapUiLayerParameterProvided()){A=b.getCurrentLayer();}else if(!A){A=s.isPublicLayerAvailable()?L.PUBLIC:L.CUSTOMER;}var g=l===A;var h=s.isKeyUser()||i(u);return g&&h;}function d(o){return!o||U.getCurrentLanguage()===o;}function e(s,g){var o=a.getInstanceOrUndef();if(!o){return true;}if(!s||!g){return true;}var h=o.getSystem();var j=o.getClient();return h===s&&g===j;}var f=C.extend("sap.ui.fl.apply._internal.flexObjects.Variant",{metadata:{properties:{favorite:{type:"boolean",defaultValue:false},executeOnSelection:{type:"boolean",defaultValue:false},standardVariant:{type:"boolean",defaultValue:false},contexts:{type:"object",defaultValue:{}},persisted:{type:"boolean",defaultValue:true},name:{type:"string",defaultValue:""},content:{type:"object",defaultValue:{}}},aggregations:{revertInfo:{type:"sap.ui.fl.apply._internal.flexObjects.CompVariantRevertData",multiple:true,singularName:"revertInfo",defaultValue:[]},changes:{type:"sap.ui.fl.Change",multiple:true,defaultValue:[]}}},constructor:function(F){C.apply(this,arguments);var E=F.content&&(F.content.executeOnSelect||F.content.executeOnSelection);if(F.executeOnSelection!==undefined){E=F.executeOnSelection;}this.setExecuteOnSelection(E);this.setContexts(F.contexts||{});this.setContent(F.content||{});this.setName(this.getText("variantName"));if(F.layer===L.VENDOR||F.layer===L.CUSTOMER_BASE){this.setFavorite(true);}if(F.favorite!==undefined){this.setFavorite(!!F.favorite);}if(F.persisted!==undefined){this.setPersisted(!!F.persisted);}}});f.STANDARD_VARIANT_ID="*standard*";f.prototype.getVariantId=function(){return this.getId();};f.prototype.isRenameEnabled=function(l){return!this.getStandardVariant()&&this.isEditEnabled(l)&&d(this._oDefinition.content.originalLanguage);};f.prototype.isEditEnabled=function(A){var D=A&&b.isDeveloperLayer(A);var o=e(this._oDefinition.sourceSystem,this._oDefinition.sourceClient);var u=c(this.getLayer(),A,this.getOwnerId());return D||o&&u;};f.prototype.isDeleteEnabled=function(l){return e(this._oDefinition.sourceSystem,this._oDefinition.sourceClient)&&c(this.getLayer(),l,this.getOwnerId())&&!this.getStandardVariant();};f.prototype.storeFavorite=function(F){if(F!==undefined){this._oDefinition.favorite=F;}else{delete this._oDefinition.favorite;}this.setState(S.DIRTY);this.setFavorite(F);};f.prototype.setContent=function(o){this.setProperty("content",o||{});};f.prototype.getContent=function(){return this.getProperty("content");};f.prototype.getOwnerId=function(){return this._oDefinition.support?this._oDefinition.support.user:"";};f.prototype.storeContent=function(o){this._oDefinition.content=o||{};this.setState(S.DIRTY);this.setContent(o);};f.prototype.storeExecuteOnSelection=function(E){if(E!==undefined){this._oDefinition.executeOnSelection=E;}else{delete this._oDefinition.executeOnSelection;}delete this._oDefinition.content.executeOnSelection;this.setState(S.DIRTY);this.setExecuteOnSelection(E);};f.prototype.storeName=function(n){this._oDefinition.texts.variantName.value=n;this.setState(S.DIRTY);this.setName(n);};f.prototype.storeContexts=function(m){if(m!==undefined){this._oDefinition.contexts=m;}else{delete this._oDefinition.contexts;}this.setContexts(m);this.setState(S.DIRTY);};f.createInitialFileContent=function(p){var n=C.createInitialFileContent(p);if(p.contexts){n.contexts=p.contexts;}if(p.favorite!==undefined){n.favorite=p.favorite;}if(p.executeOnSelection!==undefined){n.executeOnSelection=p.executeOnSelection;}return _(n,["changeType","namespace","service","content","reference","fileName","fileType","packageName","layer","favorite","executeOnSelection","selector","texts","support","contexts"]);};return f;});
