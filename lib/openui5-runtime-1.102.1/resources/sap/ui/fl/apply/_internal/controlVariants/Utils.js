/*
 * ! OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/core/Core","sap/ui/fl/Variant","sap/ui/fl/Utils"],function(J,C,V,U){"use strict";function g(A,c){if(!c){return undefined;}if(A.indexOf(c.getId())>-1){return c.getId();}return g(A,c.getParent());}function a(c,u){var A=U.getAppComponentForControl(c);var r=A.getRootControl();var v=[];if(!u&&r.getDomRef()){v=Array.from(r.getDomRef().querySelectorAll(".sapUiFlVarMngmt"));}if(u||v.length===0){v=Array.from(C.getStaticAreaRef().querySelectorAll(".sapUiFlVarMngmt"));}return v.map(function(o){return o.id;});}var b={DEFAULT_AUTHOR:"SAP",VARIANT_TECHNICAL_PARAMETER:"sap-ui-fl-control-variant-id",compareVariants:function(v,o){if(v.content.content.title.toLowerCase()<o.content.content.title.toLowerCase()){return-1;}else if(v.content.content.title.toLowerCase()>o.content.content.title.toLowerCase()){return 1;}return 0;},getIndexToSortVariant:function(v,o){var s=v.length;v.some(function(e,i){if(b.compareVariants(o,e)<0){s=i;return true;}});return s;},createVariant:function(p){var v;var o;var s=p.variantSpecificData.content.variantManagementReference;if(s){var c=J.checkControlId(s,p.model.oAppComponent);if(!c){throw new Error("Generated ID attribute found - to offer flexibility a stable VariantManagement ID is needed to assign the changes to, but for this VariantManagement control the ID was generated by SAPUI5 "+s);}}p.variantSpecificData.content.reference=p.model.sFlexReference;p.variantSpecificData.content.packageName="$TMP";o=V.createInitialFileContent(p.variantSpecificData);v=new V(o);return v;},getRelevantVariantManagementControlId:function(c,v,u){var A={};if(!v||!v.length){v=a(c,u);}var d=v.reduce(function(e,f){var o=C.byId(f);if(o){var F=o.getFor();F.forEach(function(h){A[h]=f;});e=e.concat(F);}return e;},[]);var s=g(d,c);return A[s];},belongsToVariantManagement:function(e){var v=a(e);return!!b.getRelevantVariantManagementControlId(e,v);},getAllVariantManagementControlIds:function(e){return a(e);}};return b;});
