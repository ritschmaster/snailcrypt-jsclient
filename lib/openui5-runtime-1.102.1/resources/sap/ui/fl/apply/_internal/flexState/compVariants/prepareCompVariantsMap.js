/*
 * ! OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/fl/apply/_internal/flexObjects/CompVariant","sap/ui/fl/apply/_internal/flexObjects/States","sap/ui/fl/apply/_internal/flexObjects/UpdatableChange","sap/ui/fl/apply/_internal/flexState/compVariants/CompVariantMerger"],function(C,S,U,a){"use strict";function g(m,p){m[p]=m[p]||{byId:{},variants:[],nonPersistedVariants:[],changes:[],defaultVariants:[],standardVariantChange:undefined,standardVariant:undefined};return m[p];}function i(m,p,v){v=v||[];var M=g(m,p);M.nonPersistedVariants.forEach(function(V){delete M.byId[V.getId()];});M.nonPersistedVariants=v.map(function(V){var o=Object.assign({id:V.id,persisted:false},V);o=a.createVariant(p,o);M.byId[V.id]=o;return o;});return M;}function b(c,s,m){var d=s==="variants"?C:U;var f=c[s].map(function(o){var F=new d(o);F.setState(S.PERSISTED);return F;});f.forEach(function(F){var p=F.getSelector().persistencyKey;g(m,p).byId[F.getId()]=F;switch(s){case"standardVariants":g(m,p).standardVariantChange=F;break;default:g(m,p)[s].push(F);}});}return function(p){var c={};c._getOrCreate=g.bind(undefined,c);c._initialize=i.bind(undefined,c);if(p.storageResponse.changes.comp){["variants","changes","defaultVariants","standardVariants"].forEach(function(s){b(p.storageResponse.changes.comp,s,c);});}return c;};});
