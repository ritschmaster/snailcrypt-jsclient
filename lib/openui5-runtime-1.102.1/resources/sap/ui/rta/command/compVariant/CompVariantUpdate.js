/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/util/each","sap/ui/fl/write/api/SmartVariantManagementWriteAPI","sap/ui/rta/command/BaseCommand"],function(e,S,B){"use strict";var C=B.extend("sap.ui.rta.command.CompVariantUpdate",{metadata:{library:"sap.ui.rta",properties:{newVariantProperties:{type:"object"},newDefaultVariantId:{type:"string"},oldDefaultVariantId:{type:"string"},onlySave:{type:"boolean"}}}});C.prototype.prepare=function(f,v,s){this.mInformation={layer:f.layer,command:s,generator:sap.ui.rta.GENERATOR_NAME};return true;};function c(f,k,v){var p=Object.assign({},v,this.mInformation,{id:k,control:this.getElement()});return S[f](p);}C.prototype.execute=function(){if(this.getOnlySave()){this.getElement().setModified(false);var k=Object.keys(this.getNewVariantProperties())[0];c.call(this,"updateVariant",k,this.getNewVariantProperties()[k]);}else{e(this.getNewVariantProperties(),function(v,V){if(V.deleted){c.call(this,"removeVariant",v,{});this.getElement().removeVariant({variantId:v});}else{var o=c.call(this,"updateVariant",v,V);this.getElement().updateVariant(o);}}.bind(this));if(this.getNewDefaultVariantId()){c.call(this,"setDefaultVariantId",undefined,{defaultVariantId:this.getNewDefaultVariantId()});this.getElement().setDefaultVariantId(this.getNewDefaultVariantId());}}return Promise.resolve();};C.prototype.undo=function(){if(this.getOnlySave()){this.getElement().setModified(true);var v=Object.keys(this.getNewVariantProperties())[0];c.call(this,"revert",v,{});}else{e(this.getNewVariantProperties(),function(v,V){var o=c.call(this,"revert",v,{});if(V.deleted){this.getElement().addVariant(o);}else{this.getElement().updateVariant(o);}}.bind(this));if(this.getNewDefaultVariantId()){c.call(this,"revertSetDefaultVariantId",this.getOldDefaultVariantId());this.getElement().setDefaultVariantId(this.getOldDefaultVariantId());}}return Promise.resolve();};return C;});
