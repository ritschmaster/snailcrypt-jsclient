/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/fl/Utils","sap/m/MessageBox","sap/base/util/ObjectPath","sap/ui/rta/util/validateStableIds","sap/ui/rta/util/showMessageBox","sap/base/Log","sap/ui/rta/Utils","sap/ui/dt/Util"],function(F,M,O,v,s,L,U,D){"use strict";return function(r){var m={};var p=[];var c=F.getAppComponentForControl(r.getRootControlInstance());function _(r,c,t,I,T){var C=c.getId();if(!m[C]){s(r._getTextResources().getText(t),{icon:M.Icon[I],title:r._getTextResources().getText(T),styleClass:U.getRtaStyleClassName()},"show");a(C,true);}}function a(C,V){m[C]=V;}function b(c){var o=c.getManifest();return(O.get(["sap.app","id"],o)!=="sap.ui.documentation.sdk"&&!(O.get(["sap.app","id"],o)||"").startsWith("sap.ui.rta")&&!O.get(["sap.ovp"],o));}function d(){return("QUnit"in window||(window.frameElement&&(window.frameElement.getAttribute("id")||"").toLowerCase()==="opaframe"));}function e(C){return C&&!C._bIsBeingDestroyed;}function f(E){var n=E.getParameters().mode;if(n==="adaptation"){var r=E.getSource();var c=F.getAppComponentForControl(r.getRootControlInstance());p=p.filter(e);h(r,c,p);p=[];}}function g(E,r){var j=E.getParameters().elementOverlay;if(r.getMode()==="adaptation"){var c=F.getAppComponentForControl(r.getRootControlInstance());D.waitForSynced(r._oDesignTime,function(k){if(e(k)){h(r,c,[k]);}})(j);}else{p.push(j);}}function h(r,c,E){var u=v(E,c);if(u.length){u.forEach(function(j){L.error("Control ID was generated dynamically by SAPUI5. To support SAPUI5 flexibility, a stable control ID is needed to assign the changes to.",j.getElement().getId());});_(r,c,"MSG_UNSTABLE_ID_FOUND","ERROR","HEADER_ERROR");}}r.attachEventOnce("stop",function(){a(c.getId(),false);});if(c&&b(c)){var o=c.getManifest();var i=O.get(["sap.ui5","flexEnabled"],o);if(typeof i!=="boolean"){if(!d()){_(r,c,"MSG_NO_FLEX_ENABLED_FLAG","WARNING","HEADER_WARNING");}}else{r.attachEvent("modeChanged",f);r._oDesignTime.attachEvent("elementOverlayCreated",r,g);h(r,c,r._oDesignTime.getElementOverlays());}}};});
