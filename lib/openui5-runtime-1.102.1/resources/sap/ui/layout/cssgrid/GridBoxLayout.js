/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/layout/cssgrid/GridLayoutBase","sap/ui/layout/cssgrid/GridSettings","sap/ui/Device","sap/ui/thirdparty/jquery"],function(G,a,D,q){"use strict";var S=/^([X][L](?:[1-9]|1[0-2]))? ?([L](?:[1-9]|1[0-2]))? ?([M](?:[1-9]|1[0-2]))? ?([S](?:[1-9]|1[0-2]))?$/i;var b=S.exec("XL7 L6 M4 S2");var s={"Phone":"sapUiLayoutCSSGridBoxLayoutSizeS","Tablet":"sapUiLayoutCSSGridBoxLayoutSizeM","Desktop":"sapUiLayoutCSSGridBoxLayoutSizeL","LargeDesktop":"sapUiLayoutCSSGridBoxLayoutSizeXL"};var c={"XL":"sapUiLayoutCSSGridBoxLayoutSpanXL7","L":"sapUiLayoutCSSGridBoxLayoutSpanL6","M":"sapUiLayoutCSSGridBoxLayoutSpanM4","S":"sapUiLayoutCSSGridBoxLayoutSpanS2"};var d="0.5rem";var e=G.extend("sap.ui.layout.cssgrid.GridBoxLayout",{metadata:{library:"sap.ui.layout",properties:{boxMinWidth:{type:"sap.ui.core.CSSSize",defaultValue:""},boxWidth:{type:"sap.ui.core.CSSSize",defaultValue:""},boxesPerRowConfig:{type:"sap.ui.layout.BoxesPerRowConfig",group:"Behavior",defaultValue:"XL7 L6 M4 S2"}}}});e.prototype.getActiveGridSettings=function(){return new a({gridTemplateColumns:this._getTemplateColumns(),gridGap:d+" "+d});};e.prototype._applySingleGridLayout=function(E){G.prototype._applySingleGridLayout.call(this,E);var g=sap.ui.getCore().byId(E.parentElement.id);if(g&&g.isA("sap.f.GridList")&&g.isGrouped()){this._flattenHeight(g);}};e.prototype.addGridStyles=function(r){G.prototype.addGridStyles.apply(this,arguments);this._addSpanClasses(r);r.class("sapUiLayoutCSSGridBoxLayoutContainer");};e.prototype.onGridAfterRendering=function(g){g.getGridDomRefs().forEach(function(o){if(o.children){for(var i=0;i<o.children.length;i++){if(!o.children[i].classList.contains("sapMGHLI")&&!o.children[i].classList.contains("sapUiBlockLayerTabbable")){o.children[i].classList.add("sapUiLayoutCSSGridItem");}}}});if(!this._hasBoxWidth()){this._applySizeClass(g);}if(g.isA("sap.f.GridList")&&g.getGrowing()){var C=g._oGrowingDelegate._onAfterPageLoaded;g._oGrowingDelegate._onAfterPageLoaded=function(){C.call(g._oGrowingDelegate);if(g.isA("sap.f.GridList")&&g.isGrouped()){this._flattenHeight(g);}}.bind(this);}};e.prototype.isResponsive=function(){return true;};e.prototype.onGridResize=function(E){if(E.control&&E.control.isA("sap.f.GridList")&&E.control.isGrouped()){this._flattenHeight(E.control);}if(E){if(!this._hasBoxWidth()){this._applySizeClass(E.control);}}};e.prototype._flattenHeight=function(C){var m=0,M;this._loopOverGridItems(C,function(g){if(!g.classList.contains("sapMGHLI")){g.style.height="";}});this._loopOverGridItems(C,function(g){if(!g.classList.contains("sapMGHLI")){m=Math.max(q(g).outerHeight(),m);}});M=m+"px";this._loopOverGridItems(C,function(g){if(!g.classList.contains("sapMGHLI")){g.style.height=M;}});};e.prototype._applySizeClass=function(C){var r=D.media.getCurrentRange("StdExt",C.$().width());if(!r){return;}var f=s[r.name];C.getGridDomRefs().forEach(function(o){if(!o.classList.contains(f)){Object.keys(s).map(function(g){o.classList.remove(s[g]);});o.classList.add(f);}});};e.prototype._getTemplateColumns=function(){var t="";if(this.getBoxWidth()){t="repeat(auto-fit, "+this.getBoxWidth()+")";}else if(this.getBoxMinWidth()){t="repeat(auto-fit, minmax("+this.getBoxMinWidth()+", 1fr))";}return t;};e.prototype._hasBoxWidth=function(){if(this.getBoxWidth()||this.getBoxMinWidth()){return true;}else{return false;}};e.prototype._addSpanClasses=function(r){var f,g=this.getBoxesPerRowConfig(),h,j,k,l;if(this._hasBoxWidth()){return;}if(!g||!g.length===0){f=b;}else{f=S.exec(g);}if(f){for(var i=1;i<f.length;i++){var m=f[i];if(!m){continue;}m=m.toUpperCase();switch(m.substr(0,1)){case"X":if(m.substr(1,1)==="L"){h=this._getBoxesPerRowClass(m,2);}break;case"L":j=this._getBoxesPerRowClass(m,1);break;case"M":k=this._getBoxesPerRowClass(m,1);break;case"S":l=this._getBoxesPerRowClass(m,1);break;default:break;}}}h=h||c.XL;j=j||c.L;k=k||c.M;l=l||c.S;r.class(h).class(j).class(k).class(l);};e.prototype._getBoxesPerRowClass=function(f,i){var g=parseInt(f.substr(i,f.length));if(g&&g>0&&g<13){return"sapUiLayoutCSSGridBoxLayoutSpan"+f;}};e.prototype._loopOverGridItems=function(C,f){C.getGridDomRefs().forEach(function(o){if(o&&o.children){for(var i=0;i<o.children.length;i++){if(o.children[i].style.display!=="none"&&o.children[i].style.visibility!=="hidden"){f(o.children[i]);}}}});};return e;});
