/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/util/ObjectPath","sap/ui/base/DataType","sap/ui/test/generic/GenericTestCollection","require"],function(O,D,G,r){"use strict";var U={loadClass:function(c,C){return new Promise(function(a){var m=C?C:c.replace(/\./g,"/");r([m],function(b){if(C){b=O.get(c);}a({className:c,fnClass:b,error:undefined});},function(e){var b=O.get(c);a({className:c,fnClass:b,error:e});});});},loadAllControls:function(t,o){var l=t.library;var c=t.objectCapabilities||{};var L=[];o=o||{};var a=[];var b=function(){return sap.ui.getCore().loadLibrary(l,true).then(function(d){var C=d?d.controls:[];if(o.includeElements){C=C.concat(d.elements);}C=C.filter(function(s){return!L.includes(s);});if(C.length>0){C.forEach(function(s){var m=c[s]&&c[s].moduleName;a.push(U.loadClass(s,m));L.push(s);});return Promise.all(a).then(b);}return Promise.all(a);});};return b().then(function(C){var i;var d=C.filter(function(e){return e.error!==undefined;});C=C.filter(function(e){return!!e.fnClass;});if(d.length){QUnit.test("Controls only available in global namespace",function(e){for(i=0;i<d.length;i++){e.ok(false,d[i].className+" seems to be only available using global namespace."+" If the class exists, but is not a module of its own, then specify the module that contains the class within the testsuite config.");}});}return C;});},createControlOrElement:function(C,o,s){if(o&&o.create){return o.create(C,s);}else{return new C(s);}},fillControlProperties:function(c,o){var p=c.getMetadata().getAllProperties(),P=o&&o.properties||{},v="test";for(var s in p){var a=p[s],b;if(P[s]){if(G.ExcludeReason.hasOwnProperty(P[s])){b=P[s];}else{v=P[s];}}if(b!==G.ExcludeReason.NotChangeableAfterInit&&b!==G.ExcludeReason.SetterNeedsSpecificSettings&&b!==G.ExcludeReason.OnlyChangeableViaBinding){try{if(a.type==="boolean"){v=false;}else if(a.type==="int"){v=100;}else if(a.type.startsWith("sap.")){var E=r(a.type.replace(/\./g,"\/"));v=E[Object.keys(E)[0]];}c[a._sMutator](v);}catch(e){}}}try{c.setTooltip("test");}catch(d){QUnit.assert.ok(true,"WARNING: setTooltip is not able to handle strings");}},fillControlAggregations:function(c,o){var m=c.getMetadata(),a=o[m.getName()],A=m.getAggregations();return Promise.all(Object.values(A).map(function(b){var s=b.type;switch(b.type){case"sap.ui.core.Control":s="sap.m.Text";break;case"sap.ui.core.Element":s="sap.ui.core.Icon";break;case"sap.ui.core.Toolbar":s="sap.m.Bar";break;default:s=b.type;break;}if(a&&a.aggregations&&a.aggregations[b.name]){if(G.ExcludeReason.hasOwnProperty(a.aggregations[b.name])){var d=a.aggregations[b.name];if(d===G.ExcludeReason.NotChangeableAfterInit||d===G.ExcludeReason.SetterNeedsSpecificSettings){return Promise.resolve(undefined);}}else{s=a.aggregations[b.name];}}var M=o[s]&&o[s].moduleName?o[s].moduleName:undefined;if(D.isInterfaceType(s)){return Promise.resolve(undefined);}return U.loadClass(s,M).then(function(C){var e;if(!C.fnClass){QUnit.assert.ok(false,"No class of type "+s+" for aggregation '"+b.name+"' of "+c+" could be loaded. Does this class exist? Is it properly implemented?");return;}if(C.fnClass.getMetadata().isAbstract()){return;}else{e=new C.fnClass();}if(e){c[b._sMutator](e);}return e;}).catch(function(){});}));}};return U;});
