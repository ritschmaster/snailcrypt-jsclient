/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./WaiterBase","sap/ui/thirdparty/jquery"],function(W,q){"use strict";var S={PENDING:"PENDING",LOADED:"LOADED",ERROR:"ERROR"};var M=W.extend("sap.ui.test.autowaiter._ModuleWaiter",{constructor:function(){this._aModules=[];var t=this;var s=Object.getOwnPropertyDescriptor(HTMLScriptElement.prototype,"src");Object.defineProperty(HTMLScriptElement.prototype,"src",{set:function(v){if(!this.dataset.sapUiTestModuleWaiterHandled){var n={src:v,state:S.PENDING,script:this};t._aModules.push(n);this.addEventListener("load",function(){n.state=S.LOADED;t._oLogger.trace("Script with src '"+v+"' loaded successfully");});this.addEventListener("error",function(){n.state=S.ERROR;t._oLogger.trace("Script with src '"+v+"' failed to load");});this.dataset.sapUiTestModuleWaiterHandled="true";t._oLogger.trace("Script with src '"+v+"' is tracked");}s.set.call(this,v);},get:s.get});W.apply(this,arguments);},hasPending:function(){var p=this._aModules.filter(function(m){if(!q(m.script).length){this._oLogger.trace("Script with src '"+m.src+"' was removed");return false;}if(m.script.noModule){this._oLogger.trace("Script with src '"+m.src+"' and 'nomodule' will be ignored because the browser supports ES6 modules");return false;}return m.state===S.PENDING;}.bind(this));var h=p.length>0;if(h){this._oHasPendingLogger.debug("There are "+p.length+" modules still loading");p.forEach(function(m){this._oHasPendingLogger.debug("Pending module: "+m.src);}.bind(this));}return h;}});return new M();});
