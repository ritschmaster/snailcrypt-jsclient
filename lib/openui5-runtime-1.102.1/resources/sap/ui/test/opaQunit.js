/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['sap/base/util/each','sap/ui/test/Opa','sap/ui/test/Opa5','sap/ui/test/qunitPause','sap/ui/thirdparty/jquery'],function(e,O,a,Q,q){"use strict";Q.setupAfterQUnit();QUnit.begin(function(D){var h=document.getElementById("#qunit-userAgent");if(sap&&sap.ui&&h){h.innerText+="; UI5: "+sap.ui.version;}O._usageReport.begin({uri:window.location.href,totalTests:D.totalTests});});QUnit.moduleStart(function(D){O._usageReport.moduleStart(D);});QUnit.testStart(function(){O._usageReport.testStart();});QUnit.testDone(function(D){O._usageReport.testDone(D);var h=D.assertions.some(function(A){return!A.result&&A.message==="Test timed out";});if(h){O._stopQueue({qunitTimeout:QUnit.config.testTimeout/1000});}});QUnit.moduleDone(function(D){O._usageReport.moduleDone(D);});QUnit.done(function(D){O._usageReport.done(D);});window.opaSkip=c;window.opaTest=o;window.opaTodo=QUnit.todo?b:o;function o(){d("test",arguments,function(h,D){O._usageReport.opaEmpty();r();D();},function(h,D,j){O._usageReport.opaEmpty(j);h.ok(false,j.errorMessage);r();if(!Q.shouldPauseOnAssert()){Q.emitPause();}var p=q.Deferred();Q.onResume(function(){if(!j.qunitTimeout){setTimeout(D,0);}p.resolve();});return p.promise();});}function b(){d("todo",arguments,function(h,D){r();D();},function(h,D,j){if(j.qunitTimeout){r();}else{h.ok(false,j.errorMessage);r();setTimeout(D,0);}});}function c(t,h,j,k){g();var T=function(){};if(i()){QUnit.skip(t,T);}else{QUnit.skip(t,h,T,k);}}function d(s,A,D,F){g();var t={testName:A[0],expected:A.length===2?null:A[1],callback:A.length===2?A[1]:A[2],async:A[3]};if(i()&&typeof t.async!=="undefined"){throw new Error("Qunit >=2.0 is used, which no longer supports the 'async' parameter for tests.");}var T=f(t,D,F);var m=[t.testName,T,t.async];if(!i()){m.splice(1,0,t.expected);}QUnit[s].apply(this,m);}function f(C,D,F){return function(h){var A=h.async();O.config.testName=C.testName;O.assert=h;a.assert=h;if(i()&&C.expected!==null){h.expect(C.expected);}C.callback.call(this,O.config.arrangements,O.config.actions,O.config.assertions);Q.setupBeforeOpaTest();O.emptyQueue().done(function(){D(h,A);}).fail(function(j){F(h,A,j);});};}function g(){if(!QUnit.config.testTimeout||QUnit.config.testTimeout===30000){QUnit.config.testTimeout=90000;}QUnit.config.reorder=false;QUnit.config.scrolltop=false;}function r(){O.assert=undefined;a.assert=undefined;}function i(){return QUnit.test.length===2;}QUnit.config.urlConfig.push({id:"opaExecutionDelay",value:{400:"fast",700:"medium",1000:"slow"},label:"Opa speed",tooltip:"Each waitFor will be delayed by a number of milliseconds. If it is not set Opa will execute the tests as fast as possible"});a._getEventProvider().attachEvent('onExtensionAfterInit',function(E){var p=E.getParameters();if(p.extension.getAssertions){var A=p.extension.getAssertions();e(A,function(n,h){QUnit.assert[n]=function(){var j=this;var k=h.apply(p.appWindow,arguments).always(function(R){j.push(R.result,R.actual,R.expected,R.message);});O.config.assertions._schedulePromiseOnFlow(k);};});}});return o;});
