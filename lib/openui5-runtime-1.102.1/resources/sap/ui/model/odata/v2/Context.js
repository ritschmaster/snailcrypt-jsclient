/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/base/SyncPromise","sap/ui/model/Context","sap/ui/model/_Helper"],function(S,B,_){"use strict";var d=["changeSetId","groupId","refreshAfterChange"];var C=B.extend("sap.ui.model.odata.v2.Context",{constructor:function(m,p,D,c,i){var t=this;B.call(this,m,p);this.oCreatePromise=undefined;this.sDeepPath=D||p;this.bForceRefresh=false;this.bPreliminary=false;this.oSyncCreatePromise=c;this.bUpdated=false;this.bInactive=!!i;this.fnActivate=undefined;this.oActivatedPromise=i?new S(function(r){t.fnActivate=r;}):S.resolve();}});C.prototype.activate=function(){this.bInactive=false;if(this.fnActivate){this.fnActivate();}};C.prototype.created=function(){if(this.oSyncCreatePromise&&!this.oCreatePromise){this.oCreatePromise=Promise.resolve(this.oSyncCreatePromise).then(function(){});}return this.oCreatePromise;};C.prototype.delete=function(p){var P,m=this.getModel(),t=this;p=p||{};for(P in p){if(!d.includes(P)){throw new Error("Parameter '"+P+"' is not supported");}}if(this.isInactive()){m._discardEntityChanges(m._getKey(this),true);m.checkUpdate();return Promise.resolve();}else if(this.isTransient()){return m.resetChanges([this.getPath()],false,true);}return new Promise(function(r,a){var g=m._resolveGroup(t.getPath());m.remove("",_.merge({changeSetId:g.changeSetId,context:t,error:a,groupId:g.groupId,success:function(){r();}},p));});};C.prototype.fetchActivated=function(){return this.oActivatedPromise;};C.prototype.getDeepPath=function(){return this.sDeepPath;};C.prototype.hasChanged=function(){return this.bUpdated||this.bForceRefresh;};C.prototype.isInactive=function(){return this.bInactive;};C.prototype.isPreliminary=function(){return this.bPreliminary;};C.prototype.isRefreshForced=function(){return this.bForceRefresh;};C.prototype.isTransient=function(){return this.oSyncCreatePromise&&this.oSyncCreatePromise.isPending();};C.prototype.isUpdated=function(){return this.bUpdated;};C.prototype.resetCreatedPromise=function(){this.oCreatePromise=undefined;this.oSyncCreatePromise=undefined;};C.prototype.setDeepPath=function(D){this.sDeepPath=D;};C.prototype.setForceRefresh=function(f){this.bForceRefresh=f;};C.prototype.setPreliminary=function(p){this.bPreliminary=p;};C.prototype.setUpdated=function(u){this.bUpdated=u;};return C;});
