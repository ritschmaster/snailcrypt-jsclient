/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/model/ParseException","sap/ui/model/ValidateException"],function(P,V){"use strict";var c=new Map(),r=/\.(\d+)$/,a=/\.$/,b=/0+$/;function g(k,p){return sap.ui.getCore().getLibraryResourceBundle().getText(k,p);}return function(p,B,f,m){function d(k,t){var F,l=this;if(this.mCustomUnits===undefined&&k&&k[2]!==undefined){if(k[2]===null){this.mCustomUnits=null;}else{this.mCustomUnits=c.get(k[2]);if(!this.mCustomUnits){this.mCustomUnits={};Object.keys(k[2]).forEach(function(K){l.mCustomUnits[K]=l.getCustomUnitForKey(k[2],K);});c.set(k[2],this.mCustomUnits);}F={};F[f]=this.mCustomUnits;B.prototype.setFormatOptions.call(this,Object.assign(F,this.oFormatOptions));}}if(!k||k[0]===undefined||k[1]===undefined||this.mCustomUnits===undefined&&k[2]===undefined){return null;}return B.prototype.formatValue.call(this,k.slice(0,2),t);}function e(){var o=B.prototype.getFormatOptions.call(this);delete o[f];return o;}function h(){if(!this.bShowMeasure){return[1,2];}else if(!this.bShowNumber){return[0,2];}return[2];}function i(D){var t;if(!this.bShowNumber){t=D?g(m+".WithDecimals",[D]):g(m+".WithoutDecimals");}else{t=D?g("EnterNumberFraction",[D]):g("EnterInt");}return new V(t);}function j(k,s){var l;if(this.mCustomUnits===undefined){throw new P("Cannot parse value without customizing");}l=B.prototype.parseValue.apply(this,arguments);if(l[0]&&typeof l[0]==="string"&&l[0].includes(".")){l[0]=l[0].replace(b,"").replace(a,"");}return l;}function v(k){var D,F,M,n=k[0],u=k[1];if(this.mCustomUnits===undefined){throw new V("Cannot validate value without customizing");}if(!n||!u||!this.mCustomUnits||this.oConstraints.skipDecimalsValidation){return;}M=r.exec(n);F=M?M[1].replace(b,"").length:0;D=this.mCustomUnits[u].decimals;if(F>D){throw this.getValidateException(D);}}function U(F,C){var k=C?Object.keys(C):[];function l(s){if(s!=="skipDecimalsValidation"){throw new Error("Only 'skipDecimalsValidation' constraint is supported");}}if(F&&F[f]){throw new Error("Format option "+f+" is not supported");}k.forEach(l);if(arguments.length>2){throw new Error("Only parameters oFormatOptions and oConstraints are supported");}F=Object.assign({emptyString:0,parseAsString:true,unitOptional:!F||["showMeasure","showNumber"].every(function(o){return!(o in F)||F[o];})},F);C=Object.assign({},C);B.call(this,F,C);this.mCustomUnits=undefined;this.setConstraints=function(){throw new Error("Constraints are immutable");};this.setFormatOptions=function(){throw new Error("Format options are immutable");};}p._applyUnitMixin=U;p.formatValue=d;p.getFormatOptions=e;p.getPartsIgnoringMessages=h;p.getValidateException=i;p.parseValue=j;p.validateValue=v;};});
