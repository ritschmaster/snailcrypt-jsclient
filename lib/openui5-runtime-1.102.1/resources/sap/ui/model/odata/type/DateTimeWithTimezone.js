/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/format/DateFormat","sap/ui/model/_Helper","sap/ui/model/CompositeType","sap/ui/model/FormatException","sap/ui/model/ParseException"],function(D,_,C,F,P){"use strict";var d="For type 'object', at least one of the format options 'showDate' or"+" 'showTime' must be enabled",o=new Date(Date.UTC(new Date().getFullYear(),11,31,23,59,58));function g(t){var f;if(!t.oFormat){f=_.extend({strictParsing:true},t.oFormatOptions);t.oFormat=D.getDateTimeWithTimezoneInstance(f);}return t.oFormat;}var a=C.extend("sap.ui.model.odata.type.DateTimeWithTimezone",{constructor:function(f,c){if(c&&Object.keys(c).length){throw new Error("Type "+this.getName()+" does not support constraints");}f=Object.assign({},f);C.call(this,f);this.oFormat=null;this.bParseWithValues=true;this.bUseInternalValues=true;this.vEmptyTimezoneValue=null;this.bShowDate=f.showDate===undefined||f.showDate;this.bShowTime=f.showTime===undefined||f.showTime;this.bShowTimezone=f.showTimezone===undefined||f.showTimezone;this.setConstraints=function(){throw new Error("Constraints are immutable");};this.setFormatOptions=function(){throw new Error("Format options are immutable");};}});a.prototype._getErrorMessage=function(){var m=!this.bShowDate&&!this.bShowTime?"EnterDateTimeTimezone":"EnterDateTime";return sap.ui.getCore().getLibraryResourceBundle().getText(m,[this.formatValue([o,"America/New_York"],"string")]);};a.prototype.formatValue=function(v,t){var T=v&&v[0],s=v&&v[1];if(!v||s===undefined||T===undefined||(!T&&!this.bShowTimezone)){return null;}if(T&&!(T instanceof Date)){throw new F("Timestamp value for "+this.getName()+" is not an instance of Date: "+T);}switch(this.getPrimitiveType(t)){case"object":if(!this.bShowDate&&!this.bShowTime){throw new F(d);}return T;case"string":return g(this).format(T,s);default:throw new F("Don't know how to format "+this.getName()+" to "+t);}};a.prototype.getName=function(){return"sap.ui.model.odata.type.DateTimeWithTimezone";};a.prototype.getPartsIgnoringMessages=function(){if(!this.bShowDate&&!this.bShowTime){return[0];}else if(!this.bShowTimezone){return[1];}return[];};a.prototype.parseValue=function(v,s,c){var b;if(!c){throw new P("'aCurrentValues' is mandatory");}switch(this.getPrimitiveType(s)){case"object":if(!this.bShowDate&&!this.bShowTime){throw new P(d);}if(!v){return[null,undefined];}if(!(v instanceof Date)){throw new P("Given value must be an instance of Date");}return[v,undefined];case"string":if(!v){if(!this.bShowDate&&!this.bShowTime){return[undefined,this.vEmptyTimezoneValue];}return[null,undefined];}try{b=g(this).parse(v,c[1]);}catch(e){throw new P(e.message);}if(!b){throw new P(this._getErrorMessage());}return b;default:throw new P("Don't know how to parse "+this.getName()+" from "+s);}};a.prototype.processPartTypes=function(p){var t=p[1];if(t&&t.isA("sap.ui.model.odata.type.String")&&t.getFormatOptions().parseKeepsEmptyString===true){this.vEmptyTimezoneValue="";}};a.prototype.validateValue=function(v){};a.prototype._handleLocalizationChange=function(){this.oFormat=null;};return a;});
