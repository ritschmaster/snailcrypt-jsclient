/*
 * ! OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['./BaseController','sap/ui/mdc/p13n/P13nBuilder','sap/m/p13n/SortPanel'],function(B,P,S){"use strict";var a=B.extend("sap.ui.mdc.p13n.subcontroller.SortController",{constructor:function(){B.apply(this,arguments);this._bResetEnabled=true;}});a.prototype.getStateKey=function(){return"sorters";};a.prototype.getUISettings=function(){return{tabText:sap.ui.getCore().getLibraryResourceBundle("sap.ui.mdc").getText("p13nDialog.TAB_Sort"),title:sap.ui.getCore().getLibraryResourceBundle("sap.ui.mdc").getText("sort.PERSONALIZATION_DIALOG_TITLE")};};a.prototype.getDelta=function(p){p.deltaAttributes.push("descending");return B.prototype.getDelta.apply(this,arguments);};a.prototype.getAdaptationUI=function(p){var s;s=new S();var A=this.mixInfoAndState(p);s.setP13nData(A.items);this._oPanel=s;return Promise.resolve(s);};a.prototype.model2State=function(){var i=[];if(this._oPanel){this._oPanel.getP13nData(true).forEach(function(I){if(I.sorted){i.push({name:I.name});}});return i;}};a.prototype.getChangeOperations=function(){return{add:"addSort",remove:"removeSort",move:"moveSort"};};a.prototype._getPresenceAttribute=function(b){return"sorted";};a.prototype.mixInfoAndState=function(p){var i=this.getCurrentState();var e=P.arrayToMap(i);var o=P.prepareAdaptationData(p,function(I,b){var E=e[b.name];I.sorted=E?true:false;I.sortPosition=E?E.position:-1;I.descending=E?!!E.descending:false;return!(b.sortable===false);});P.sortP13nData({visible:"sorted",position:"sortPosition"},o.items);o.presenceAttribute=this._getPresenceAttribute();o.items.forEach(function(I){delete I.sortPosition;});return o;};return a;});
