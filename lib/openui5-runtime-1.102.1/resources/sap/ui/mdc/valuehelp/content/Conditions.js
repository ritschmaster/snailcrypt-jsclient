/*
 * ! OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['sap/ui/mdc/valuehelp/base/Content','sap/ui/mdc/util/loadModules','sap/ui/mdc/enum/SelectType','sap/ui/mdc/enum/ConditionValidated','sap/ui/mdc/util/Common'],function(C,l,S,a,b){"use strict";var c=C.extend("sap.ui.mdc.valuehelp.content.Conditions",{metadata:{library:"sap.ui.mdc",interfaces:["sap.ui.mdc.valuehelp.ITypeaheadContent","sap.ui.mdc.valuehelp.IDialogContent"],properties:{label:{type:"string"}},aggregations:{},events:{}}});c.prototype.init=function(){C.prototype.init.apply(this,arguments);this._oResourceBundle=sap.ui.getCore().getLibraryResourceBundle("sap.ui.mdc");};c.prototype.exit=function(){b.cleanup(this,["_oScrollContainer","_oDefineConditionPanel"]);C.prototype.exit.apply(this,arguments);};c.prototype.getContent=function(){return this._retrievePromise("content",function(){var m=["sap/ui/mdc/field/DefineConditionPanel","sap/ui/model/base/ManagedObjectModel"];if(this.provideScrolling()){m.push("sap/m/ScrollContainer");}return l(m).then(function(m){var D=m[0];var M=m[1];var f=m.length>2&&m[2];this._oManagedObjectModel=new M(this);this._oDefineConditionPanel=new D(this.getId()+"-DCP",{label:"{$help>/label}",conditions:"{$help>/conditions}",inputOK:"{$valueHelp>/_valid}",formatOptions:{path:"$help>/config",formatter:e},conditionProcessed:d.bind(this)}).setModel(this._oManagedObjectModel,"$help");if(f){this._oScrollContainer=new f(this.getId()+"-SC",{height:"100%",width:"100%",vertical:true,content:[this._oDefineConditionPanel]});this.setAggregation("displayContent",this._oScrollContainer);return this._oScrollContainer;}else{this.setAggregation("displayContent",this._oDefineConditionPanel);return this._oDefineConditionPanel;}}.bind(this));}.bind(this));};c.prototype.getCount=function(f){var g=0;for(var i=0;i<f.length;i++){var o=f[i];if(o.isEmpty!==true&&o.validated===a.NotValidated){g++;}}return g;};c.prototype.getUseAsValueHelp=function(){return false;};c.prototype.getValueHelpIcon=function(){return"sap-icon://value-help";};c.prototype.isFocusInHelp=function(){return true;};c.prototype.getRequiresTokenizer=function(){return false;};c.prototype.getFormattedTitle=function(i){var t=C.prototype.getFormattedTitle.apply(this,arguments);if(!t){t=this._oResourceBundle.getText(i?"valuehelp.DEFINECONDITIONS":"valuehelp.DEFINECONDITIONSNONUMBER",i);}return t;};c.prototype.getFormattedShortTitle=function(){var s=this.getShortTitle();if(!s){s=this._oResourceBundle.getText("valuehelp.DEFINECONDITIONS.Shorttitle");}return s;};c.prototype.getAriaAttributes=function(m){return{contentId:this.getId()+"-DCP",ariaHasPopup:"dialog",roleDescription:null};};c.prototype.getContainerConfig=function(){return{'sap.ui.mdc.valuehelp.Popover':{showArrow:true,showHeader:true,getContentWidth:function(){return"500px";},getFooter:function(){return this._retrievePromise("footer",function(){return l(["sap/m/library","sap/m/Button"]).then(function(m){var M=m[0];var B=M.ButtonType;var f=m[1];var o=new f(this.getId()+"-ok",{text:this._oResourceBundle.getText("valuehelp.OK"),enabled:"{$valueHelp>/_valid}",type:B.Emphasized,press:_.bind(this)});var g=new f(this.getId()+"-cancel",{text:this._oResourceBundle.getText("valuehelp.CANCEL"),press:this.fireCancel.bind(this)});return[o,g];}.bind(this));}.bind(this));}.bind(this)}};};function _(E){this.fireConfirm({close:true});}function d(E){var n=this.getConditions();if(this._getMaxConditions()===1){n=n.filter(function(o){return o.validated==="NotValidated";});}this.fireSelect({type:S.Set,conditions:n});}function e(o){var f={};if(o){f.valueType=o.dataType;f.maxConditions=o.maxConditions;f.delegate=o.delegate;f.delegateName=o.delegateName;f.payload=o.payload;f.operators=o.operators;f.display=o.display;f.defaultOperatorName=o.defaultOperatorName;}return f;}return c;});
