/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['sap/ui/thirdparty/jquery','sap/ui/Device','sap/ui/mdc/enum/EditMode','sap/ui/mdc/enum/FieldDisplay','sap/ui/mdc/enum/ConditionValidated','sap/ui/mdc/field/FieldBaseRenderer','sap/ui/mdc/condition/FilterOperatorUtil','sap/ui/mdc/condition/Condition','sap/ui/mdc/field/ConditionType','sap/ui/mdc/field/ConditionsType','sap/ui/mdc/enum/BaseType','sap/ui/mdc/field/content/ContentFactory','sap/ui/mdc/Control','sap/ui/core/library','sap/ui/core/LabelEnablement','sap/ui/core/message/MessageMixin','sap/base/util/deepEqual','sap/base/util/merge','sap/base/Log','sap/ui/dom/containsOrEquals','sap/ui/model/BindingMode','sap/ui/model/FormatException','sap/ui/model/ParseException','sap/ui/model/ValidateException','sap/ui/model/base/ManagedObjectModel','sap/ui/base/ManagedObjectObserver','sap/ui/base/SyncPromise','sap/base/util/restricted/_debounce','sap/ui/events/KeyCodes'],function(q,D,E,F,C,a,b,c,d,e,B,f,g,h,L,M,k,m,l,n,o,p,P,V,r,s,S,t,K){"use strict";var u=h.ValueState;var T=h.TextAlign;var v=h.TextDirection;var w=g.extend("sap.ui.mdc.field.FieldBase",{metadata:{interfaces:["sap.ui.core.IFormContent","sap.ui.core.ISemanticFormContent"],designtime:"sap/ui/mdc/designtime/field/FieldBase.designtime",library:"sap.ui.mdc",properties:{dataType:{type:"string",group:"Data",defaultValue:'sap.ui.model.type.String'},dataTypeConstraints:{type:"object",group:"Data",defaultValue:null},dataTypeFormatOptions:{type:"object",group:"Data",defaultValue:null},editMode:{type:"sap.ui.mdc.enum.EditMode",group:"Data",defaultValue:E.Editable},required:{type:"boolean",group:"Data",defaultValue:false},display:{type:"sap.ui.mdc.enum.FieldDisplay",defaultValue:F.Value},textAlign:{type:"sap.ui.core.TextAlign",group:"Appearance",defaultValue:T.Initial},textDirection:{type:"sap.ui.core.TextDirection",group:"Appearance",defaultValue:v.Inherit},placeholder:{type:"string",group:"Misc",defaultValue:""},valueState:{type:"sap.ui.core.ValueState",group:"Appearance",defaultValue:u.None},valueStateText:{type:"string",group:"Misc",defaultValue:null},width:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:null},multipleLines:{type:"boolean",group:"Appearance",defaultValue:false},maxConditions:{type:"int",group:"Behavior",defaultValue:-1},conditions:{type:"object[]",group:"Data",defaultValue:[],byValue:true},label:{type:"string",group:"Misc",defaultValue:""},delegate:{type:"object",defaultValue:{name:"sap/ui/mdc/field/FieldBaseDelegate",payload:{}}},showEmptyIndicator:{type:"boolean",group:"Appearance",defaultValue:false},_fieldHelpEnabled:{type:"boolean",group:"Appearance",defaultValue:false,visibility:"hidden"},_ariaAttributes:{type:"object",defaultValue:{},byValue:true,visibility:"hidden"}},aggregations:{content:{type:"sap.ui.core.Control",multiple:false},contentEdit:{type:"sap.ui.core.Control",multiple:false},contentDisplay:{type:"sap.ui.core.Control",multiple:false},_content:{type:"sap.ui.core.Control",multiple:true,visibility:"hidden"},fieldInfo:{type:"sap.ui.mdc.field.FieldInfoBase",multiple:false}},associations:{fieldHelp:{type:"sap.ui.mdc.ValueHelp",multiple:false},ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},events:{liveChange:{parameters:{value:{type:"string"},escPressed:{type:"boolean"},previousValue:{type:"string"}}},press:{},submit:{parameters:{promise:{type:"Promise"}}}},publicMethods:[],defaultAggregation:"content"},renderer:a,_oManagedObjectModel:null});M.call(w.prototype);var x={onsapprevious:d1,onsapnext:d1,onsapup:d1,onsapdown:d1,onsapbackspace:d1};var y={onsapenter:H};var z;w._init=function(){if(z&&z.bool&&z.bool.control){z.bool.control.destroy();}if(z&&z.defineConditions&&z.defineConditions.control){z.defineConditions.control.destroy();}z={bool:{name:"sap/ui/mdc/field/BoolFieldHelp",id:"BoolDefaultHelp",getDelegate:"getDefaultFieldHelpBaseDelegate",properties:{},control:undefined},defineConditions:{name:"sap/ui/mdc/field/FieldValueHelp",id:"Field-DefineConditions-Help",getDelegate:"getDefaultFieldValueHelpDelegate",properties:{showConditionPanel:true},control:undefined}};};w._init();w.prototype.init=function(){g.prototype.init.apply(this,arguments);this._oObserver=new s(this._observeChanges.bind(this));this._oObserver.observe(this,{properties:["display","editMode","dataType","dataTypeFormatOptions","dataTypeConstraints","multipleLines","maxConditions","conditions","delegate"],aggregations:["fieldInfo","content","contentEdit","contentDisplay"],associations:["fieldHelp","ariaLabelledBy"]});this.attachEvent("modelContextChange",this._handleModelContextChange,this);this._oResourceBundle=sap.ui.getCore().getLibraryResourceBundle("sap.ui.mdc");this._aAsyncChanges=[];this._bPreventGetDescription=false;this._oContentFactory=new f(this.getId()+"-contentFactory",{field:this,handleTokenUpdate:v1.bind(this),handleContentChange:p1.bind(this),handleContentLiveChange:s1.bind(this),handleValueHelpRequest:A1.bind(this),handleEnter:H.bind(this),handleContentPress:u1.bind(this)});this._oCreateContentPromise=undefined;this._sFilterValue="";};w.prototype.exit=function(){var i=this.getFieldInfo();if(i){i.detachEvent("dataUpdate",K1,this);}var j=this.getContent();if(j){Z.call(this,j);}var R1=this.getContentEdit();if(R1){Z.call(this,R1);}var S1=this.getContentDisplay();if(S1){Z.call(this,S1);}if(this._oManagedObjectModel){this._oManagedObjectModel.destroy();delete this._oManagedObjectModel;}this._oObserver.disconnect();this._oObserver=undefined;this._oCreateContentPromise=undefined;var T1=y1.call(this);if(T1){T1.detachEvent("dataUpdate",F1,this);if(this._bConnected){G1.call(this);T1.connect();}}if(this._oContentFactory){this._oContentFactory.destroy();this._oContentFactory=undefined;}t1.call(this);delete this._fnLiveChangeTimer;};w.prototype.applySettings=function(){g.prototype.applySettings.apply(this,arguments);if(!this.bDelegateInitialized&&!this.bDelegateLoading){this.initControlDelegate();}this._triggerCheckCreateInternalContent();this._bSettingsApplied=true;return this;};w.prototype.setProperty=function(i,j,R1){if(i==="editMode"){var S1=this.getEditMode();if(S1!==E.Display&&S1!==E.EditableDisplay&&j!==E.Display&&j!==E.EditableDisplay){R1=true;}}else if(i!=="width"&&i!=="multipleLines"&&i!=="showEmptyIndicator"){R1=true;}return g.prototype.setProperty.apply(this,[i,j,R1]);};w.prototype.onBeforeRendering=function(){$.call(this);};w.prototype.onAfterRendering=function(){};w.prototype.onfocusin=function(i){H1.call(this);};w.prototype.onsapfocusleave=function(i){t1.call(this);};function _(i){var j=i.indexOf(this.getId());if(j>-1){if(this._bPendingChange){var R1=document.activeElement;var S1=y1.call(this);if(!(R1&&S1&&n(S1.getDomRef(),R1))){var T1=M1.call(this);if(T1){G.call(this,undefined,undefined,undefined,T1);}else{G.call(this,this.getConditions(),!this._bParseError);}}}if(i.length>1){i.splice(j,1);this.fireValidateFieldGroup({fieldGroupIds:i});}}}w.prototype.onsapup=function(i){if(this.getEditMode()===E.Editable){var j=y1.call(this);var R1=i.srcControl;if(j&&(!j.valueHelpEnabled||j.valueHelpEnabled()||j.isOpen())&&(!this._oContentFactory.isMeasure()||R1.getShowValueHelp())){i.preventDefault();i.stopPropagation();j.setFilterValue(this._sFilterValue);j.navigate(-1);}}};w.prototype.onsapdown=function(i){if(this.getEditMode()===E.Editable){var j=y1.call(this);var R1=i.srcControl;if(j&&(!j.valueHelpEnabled||j.valueHelpEnabled()||j.isOpen())&&(!this._oContentFactory.isMeasure()||R1.getShowValueHelp())){i.preventDefault();i.stopPropagation();j.setFilterValue(this._sFilterValue);j.navigate(1);}}};w.prototype.onsapenter=function(i){var j=y1.call(this);if(j&&j.isOpen(true)){j.close();}this._sFilterValue="";};w.prototype.onsapescape=function(i){this.onsapenter(i);};w.prototype.ontap=function(i){var j=y1.call(this);if(j){if(j.shouldOpenOnClick()&&!j.isOpen(true)){j.open(true);}var R1=i.srcControl;if(j.isOpen(true)&&(!this._oContentFactory.isMeasure()||(R1.getShowValueHelp&&R1.getShowValueHelp()))){R1.addStyleClass("sapMFocus");j.removeFocus();}}};w.prototype.clone=function(i,j){this.detachEvent("modelContextChange",this._handleModelContextChange,this);var R1=this.getContent();if(R1){Z.call(this,R1);}var S1=this.getContentEdit();if(S1){Z.call(this,S1);}var T1=this.getContentDisplay();if(T1){Z.call(this,T1);}var U1=this.getFieldInfo();if(U1){U1.detachEvent("dataUpdate",K1,this);}var V1=g.prototype.clone.apply(this,arguments);this.attachEvent("modelContextChange",this._handleModelContextChange,this);if(R1){Y.call(this,R1);}if(S1){Y.call(this,S1);}if(T1){Y.call(this,T1);}if(U1){U1.attachEvent("dataUpdate",K1,this);}if(this._bTriggerable){V1._bTriggerable=this._bTriggerable;}return V1;};w.prototype.getFieldPath=function(){var i=this.getBindingPath("conditions");if(i&&i.startsWith("/conditions/")){return i.slice(12);}else{return"";}};function A(i,j,R1,S1){if(this._getContent().length>1){this._bPendingChange=true;}else{G.call(this,i,j,R1,S1);}}function G(i,j,R1,S1){if(!S1){if(j){S1=Promise.resolve(this._getResultForPromise(i));}else{S1=Promise.reject(R1);}}this._fireChange(i,j,R1,S1);this._bPendingChange=false;}w.prototype._fireChange=function(i,j,R1,S1){};function H(i){var j=this.getEditMode();if(f._getEditable(j)&&(this.hasListeners("submit")||this._bPendingChange)){var R1=M1.call(this);var S1=false;if(R1){S1=true;}else if(this._bParseError){R1=Promise.reject();}else{R1=Promise.resolve(this._getResultForPromise(this.getConditions()));}if(this._bPendingChange){if(S1){G.call(this,undefined,undefined,undefined,R1);}else{G.call(this,this.getConditions(),!this._bParseError,undefined,R1);}}this.fireSubmit({promise:R1});}}w.prototype._initDataType=function(){if(this._oContentFactory.getDataType()){this._oContentFactory.getDataType().destroy();this._oContentFactory.setDataType(undefined);}if(this._oContentFactory.getDateOriginalType()){if(this._oContentFactory.getDateOriginalType()._bCreatedByField){this._oContentFactory.getDateOriginalType().destroy();}this._oContentFactory.setDateOriginalType(undefined);}if(this._oContentFactory.getUnitOriginalType()){if(this._oContentFactory.getUnitOriginalType()._bCreatedByField){this._oContentFactory.getUnitOriginalType().destroy();}this._oContentFactory.getUnitOriginalType(undefined);}};function I(){if(this._oContentFactory.getDataType()&&typeof this._oContentFactory.getDataType()==="object"){return this._oContentFactory.getDataType().getMetadata().getName();}else if(this.bDelegateInitialized){return this.getControlDelegate().getDataTypeClass(this.getPayload(),this.getDataType());}else{return this.getDataType();}}function J(){var i=this._oContentFactory.getDataType();if(i&&typeof i==="object"&&i.getConstraints()){return i.getConstraints();}else{return this.getDataTypeConstraints();}}function N(){var i=this._oContentFactory.getDataType();if(i&&typeof i==="object"&&i.getFormatOptions()){return i.getFormatOptions();}else{return this.getDataTypeFormatOptions();}}w.prototype.getBaseType=function(){var i=I.call(this);var j=J.call(this);var R1=N.call(this);var S1=this.getTypeUtil().getBaseType(i,R1,j);return S1;};function O(i,j){var R1=y1.call(this);if(R1&&this._bConnected){z1.call(this,i,R1);}}w.prototype._getContent=function(){var i=this.getContent();if(!i){if(this.getEditMode()===E.Display){i=this.getContentDisplay();}else{i=this.getContentEdit();}}if(i){return[i];}else{return this.getAggregation("_content",[]);}};w.prototype._handleModelContextChange=function(i){};function Q(i){this.setValueState(u.Error);this.setValueStateText(i);}w.prototype._removeUIMessage=function(){this.setValueState(u.None);this.setValueStateText();};w.prototype._observeChanges=function(j){if(j.name==="dataType"){if(this._oContentFactory.getDataType()){var R1=function(U1){var V1=this.getTypeUtil().getDataTypeClass(j.current);if(!(this._oContentFactory.getDataType()instanceof V1)){this._initDataType();this.destroyAggregation("_content");this._oContentFactory.updateConditionType();}}.bind(this);if(!this.bDelegateInitialized){this.awaitControlDelegate().then(function(){R1.call(this,j.current);}.bind(this));return;}R1.call(this,j.current);}}if(j.name==="dataTypeFormatOptions"||j.name==="dataTypeConstraints"){if(this._oContentFactory.getDataType()){this._initDataType();this.destroyAggregation("_content");this._oContentFactory.updateConditionType();}}if(j.name==="maxConditions"){this._updateInternalContent();}if(j.name==="conditions"){this._bParseError=false;O.call(this,j.current,j.old);var S1=false;var i=0;for(i=0;i<this._aAsyncChanges.length;i++){var T1=this._aAsyncChanges[i];if(T1.waitForUpdate&&k(T1.result,j.current)){q1.call(this,T1);S1=true;break;}}if(S1){this._aAsyncChanges.splice(i,1);}if((j.current.length===0||j.old.length===0)&&this.getShowEmptyIndicator()&&this.getEditMode()===E.Display&&!this.getContent()&&!this.getContentDisplay()){this.invalidate();}}if(j.name==="display"){this._destroyInternalContent();this._oContentFactory.updateConditionType();}if(j.name==="fieldHelp"&&j.ids){w1.call(this,j.ids,j.mutation);this._oContentFactory.updateConditionType();}if(j.name==="fieldInfo"&&j.child){J1.call(this,j.child,j.mutation);}if(j.name==="content"&&j.child){X.call(this,j.child,j.mutation,j.name);}if(j.name==="contentEdit"&&j.child){X.call(this,j.child,j.mutation,j.name);}if(j.name==="contentDisplay"&&j.child){X.call(this,j.child,j.mutation,j.name);}if(j.name==="delegate"&&!this.bDelegateInitialized&&!this.bDelegateLoading){this.initControlDelegate.call(this);}if(j.name==="ariaLabelledBy"&&j.ids){R.call(this,j.ids,j.mutation);}if(j.name==="editMode"){W.call(this);if(this._bSettingsApplied&&(j.old===E.Display||j.old===E.EditableDisplay||j.current===E.Display||j.current===E.EditableDisplay)){this._triggerCheckCreateInternalContent();}}};w.prototype._updateInternalContent=function(){if(this.getAggregation("_content",[]).length>0){$.call(this);this._oContentFactory.updateConditionType();}};w.prototype.getFocusDomRef=function(){var i=this._getContent();if(i.length>0){return i[0].getFocusDomRef();}else{return this.getDomRef();}};w.prototype.getIdForLabel=function(){var i;var j=this._getContent();if(j.length>0){i=j[0].getIdForLabel();}else{i=b1.call(this);}return i;};w.prototype.getEditable=function(){return f._getEditable(this.getEditMode());};w.prototype.getControlForSuggestion=function(){var i=this._getContent();if(i.length>0){if(this._oContentFactory.isMeasure()){return i[1];}else{return i[0];}}else{return this;}};w.prototype.getFocusElementForValueHelp=function(j){var R1=this.getControlForSuggestion();var S1=R1&&R1.getMetadata().getAllPrivateAggregations()._endIcon&&R1.getAggregation("_endIcon",[]);var T1;for(var i=0;i<S1.length;i++){if(S1[i].getVisible()){T1=S1[i];break;}}return j||!T1?R1:T1;};w.prototype.getMaxConditionsForHelp=function(){if(this._oContentFactory.isMeasure()){return 1;}else{return this.getMaxConditions();}};w.prototype.getFormFormattedValue=function(){var i=this.getConditions();var j=this.getShowEmptyIndicator()&&i.length===0&&!this.getContent()&&!this.getContentDisplay();if(j){if(!this._oResourceBundleM){this._oResourceBundleM=sap.ui.getCore().getLibraryResourceBundle("sap.m");}return this._oResourceBundleM.getText("EMPTY_INDICATOR");}else if(this._oContentFactory.isMeasure()&&this._oContentFactory.getUnitOriginalType()){var R1=i.length>0?i[0].values[0]:[0,null];return this._oContentFactory.getUnitOriginalType().formatValue(R1,"string");}else if(this._oContentFactory.getDateOriginalType()){var S1=i.length>0?i[0].values[0]:null;return this._oContentFactory.getDateOriginalType().formatValue(S1,"string");}else{var T1=this._oContentFactory.getConditionsType();return T1.formatValue(i);}};w.prototype.getFormValueProperty=function(){return"conditions";};w.prototype.enhanceAccessibilityState=function(i,j){var R1=this.getParent();if(R1&&R1.enhanceAccessibilityState){R1.enhanceAccessibilityState(this,j);}};w.prototype.getAccessibilityInfo=function(){var i=this._getContent();if(i.length>0&&i[0].getAccessibilityInfo){return i[0].getAccessibilityInfo();}else{return{};}};function R(j,R1){var S1=this.getAggregation("_content",[]);var T1=this.getContent();if(T1){S1.push(T1);}T1=this.getContentDisplay();if(T1){S1.push(T1);}T1=this.getContentEdit();if(T1){S1.push(T1);}for(var i=0;i<S1.length;i++){T1=S1[i];if(T1.getMetadata().getAllAssociations().ariaLabelledBy){if(R1==="remove"){T1.removeAriaLabelledBy(j);}else if(R1==="insert"){T1.addAriaLabelledBy(j);}}}}function U(i,j){var R1={aria:{}};var S1=y1.call(this);if(S1){var T1=S1.getAriaAttributes(this.getMaxConditionsForHelp());var U1=T1.roleDescription;R1["role"]=T1.role;if(U1){R1.aria["roledescription"]=U1;}R1.aria["haspopup"]=T1.ariaHasPopup;R1["autocomplete"]="off";if(i){R1.aria["expanded"]="true";R1.aria["controls"]=T1.contentId;if(j){R1.aria["activedescendant"]=j;}}else{R1.aria["expanded"]="false";}R1["valueHelpEnabled"]=T1.valueHelpEnabled;}this.setProperty("_ariaAttributes",R1,true);}w.prototype.connectLabel=function(i){c1.call(this,i);i.bindProperty("text",{path:"$field>/label"});i.setLabelFor(this);return this;};function W(){var j=L.getReferencingLabels(this);for(var i=0;i<j.length;i++){var R1=sap.ui.getCore().byId(j[i]);R1.invalidate();}}function X(i,j,R1){if(j==="remove"){Z.call(this,i);f1.call(this,i);h1.call(this,i);if(this._oContentFactory.getContentConditionTypes()){delete this._oContentFactory.getContentConditionTypes()[R1];}i.setModel(null,"$field");}else if(j==="insert"){if(!i.isA("sap.ui.core.IFormContent")){throw new Error(i+" is not a valid content! Only use valid content in "+this);}e1.call(this,i,true);Y.call(this,i);g1.call(this,i,true);if(this.getAggregation("_content",[]).length>0){this._destroyInternalContent();}if(!this._oContentFactory.getContentConditionTypes()){this._oContentFactory.setContentConditionTypes({});}if(!this._oContentFactory.getContentConditionTypes()[R1]){this._oContentFactory.getContentConditionTypes()[R1]={};}var S1;var T1;for(T1 in i.getMetadata().getAllProperties()){if(i.getBindingPath(T1)==="/conditions"){S1=i.getBindingInfo(T1);if(S1&&S1.type&&S1.type instanceof e){this._oContentFactory.getContentConditionTypes()[R1].oConditionsType=S1.type;}this._oContentFactory.setBoundProperty(T1);}if(T1==="editable"&&!i.getBindingPath(T1)&&i.isPropertyInitial(T1)){i.bindProperty(T1,{path:"$field>/editMode",formatter:f._getEditable});}if(T1==="enabled"&&!i.getBindingPath(T1)&&i.isPropertyInitial(T1)){i.bindProperty(T1,{path:"$field>/editMode",formatter:f._getEnabled});}if(T1==="displayOnly"&&!i.getBindingPath(T1)&&i.isPropertyInitial(T1)){i.bindProperty(T1,{path:"$field>/editMode",formatter:f._getDisplayOnly});}if(T1==="required"&&!i.getBindingPath(T1)&&i.isPropertyInitial(T1)){i.bindProperty(T1,{path:"$field>/required"});}if(T1==="textAlign"&&!i.getBindingPath(T1)&&i.isPropertyInitial(T1)){i.bindProperty(T1,{path:"$field>/textAlign"});}if(T1==="textDirection"&&!i.getBindingPath(T1)&&i.isPropertyInitial(T1)){i.bindProperty(T1,{path:"$field>/textDirection"});}if(T1==="valueState"&&!i.getBindingPath(T1)&&i.isPropertyInitial(T1)){i.bindProperty(T1,{path:"$field>/valueState"});}if(T1==="valueStateText"&&!i.getBindingPath(T1)&&i.isPropertyInitial(T1)){i.bindProperty(T1,{path:"$field>/valueStateText"});}if(T1==="placeholder"&&!i.getBindingPath(T1)&&i.isPropertyInitial(T1)){i.bindProperty(T1,{path:"$field>/placeholder"});}if(T1==="showValueHelp"&&!i.getBindingPath(T1)&&i.isPropertyInitial(T1)){i.bindProperty(T1,{path:"$field>/_fieldHelpEnabled"});}if(T1==="valueHelpIconSrc"&&!i.getBindingPath(T1)&&i.isPropertyInitial(T1)){i.setValueHelpIconSrc(this._getFieldHelpIcon());}}for(var U1 in i.getMetadata().getAllAggregations()){if(i.getBindingPath(U1)==="/conditions"){S1=i.getBindingInfo(U1);if(S1&&S1.template){for(T1 in S1.template.getMetadata().getAllProperties()){var V1=S1.template.getBindingInfo(T1);if(V1&&V1.type&&V1.type instanceof d){this._oContentFactory.getContentConditionTypes()[R1].oConditionType=V1.type;break;}}}}if(U1==="tooltip"&&!i.getBindingPath(U1)&&!i.getAggregation(U1)){i.bindProperty(U1,{path:"$field>/tooltip"});}}if(i.getMetadata().getAllAssociations().ariaLabelledBy){this._oContentFactory.setAriaLabelledBy(i);}}}function Y(i){if(i.getMetadata().getEvents().change){i.attachEvent("change",p1,this);}if(i.getMetadata().getEvents().liveChange){i.attachEvent("liveChange",s1,this);}if(i.getMetadata().getEvents().press){i.attachEvent("press",u1,this);}if(i.getMetadata().getEvents().valueHelpRequest){i.attachEvent("valueHelpRequest",A1,this);}}function Z(i){if(i.getMetadata().getEvents().change){i.detachEvent("change",p1,this);}if(i.getMetadata().getEvents().liveChange){i.detachEvent("liveChange",s1,this);}if(i.getMetadata().getEvents().press){i.detachEvent("press",u1,this);}if(i.getMetadata().getEvents().valueHelpRequest){i.detachEvent("valueHelpRequest",A1,this);}}function $(){var i=function(){if(!this.bDelegateInitialized){this.awaitControlDelegate().then(function(){$.call(this);}.bind(this));}else{a1.call(this);}};if(this._oCreateContentPromise){this._oCreateContentPromise.then(function(){i.call(this);}.bind(this));}else{i.call(this);}}w.prototype._checkCreateInternalContent=function(){if(this.getVisible()&&this._oContentFactory.getDataType()){$.call(this);}};w.prototype._triggerCheckCreateInternalContent=function(){if(!this._oCheckCreateInternalContentPromise){this._oCheckCreateInternalContentPromise=this.awaitControlDelegate().then(function(){delete this._oCheckCreateInternalContentPromise;this._checkCreateInternalContent();}.bind(this));}};function a1(){var i=this.getEditMode();var j=this.getContent();this._oContentFactory._setUsedConditionType(j,i);x1.call(this,this.getFieldHelp());U.call(this,false);if(j||this._bIsBeingDestroyed||(i===E.Display&&this.getContentDisplay())||(i!==E.Display&&this.getContentEdit())){this._destroyInternalContent();var R1=this._getContent();if(R1.length===1){c1.call(this,R1[0]);}return;}var S1=this.getMaxConditions();var T1=this._getOperators();var U1;var V1=this.getAggregation("_content",[]);var W1;var X1;var Y1=this.getMultipleLines();var Z1=this._bTriggerable;var $1=this._oContentFactory.getContentType(this.getBaseType(),this.getMaxConditions(),Z1);if(V1.length>0){W1=V1[0];X1=W1.getMetadata().getName().replace(/\./g,"/");}var _1=this._oContentFactory.getContentMode($1,i,S1,Y1,T1);var a2=$1.getControlNames(_1,T1[0]);U1=a2[0];if(U1!==X1){this._oContentFactory.setHideOperator(l1.call(this,T1));if(W1){this._destroyInternalContent();if(W1.isA("sap.m.DateTimeField")){this._initDataType();}this._oContentFactory.updateConditionType();}if(k1.call(this,$1,T1,i,S1)){i1.call(this,$1.getUseDefaultFieldHelp().name);}else if(this._sDefaultFieldHelp){delete this._sDefaultFieldHelp;}var b2=b1.call(this);this._oCreateContentPromise=this._oContentFactory.createContent($1,_1,b2);this._oCreateContentPromise.then(function(c2){for(var d2=0;d2<c2.length;d2++){var e2=c2[d2];e2.attachEvent("parseError",m1,this);e2.attachEvent("validationError",n1,this);e2.attachEvent("validationSuccess",o1,this);e1.call(this,e2,$1.getUseDefaultEnterHandler());g1.call(this,e2,false);c1.call(this,e2);if(this._bConnected&&((d2===0&&!this._oContentFactory.isMeasure())||(d2===1&&this._oContentFactory.isMeasure()))){I1.call(this,e2);}this.addAggregation("_content",e2);}W.call(this);delete this._oCreateContentPromise;}.bind(this));}}function b1(){return this.getId()+"-inner";}w.prototype._destroyInternalContent=function(){this.destroyAggregation("_content");if(this._oContentFactory.getDateOriginalType()){this._oContentFactory.setDataType(this._oContentFactory.getDateOriginalType());this._oContentFactory.setDateOriginalType(undefined);}else if(this._oContentFactory.getUnitOriginalType()){this._oContentFactory.setDataType(this._oContentFactory.getUnitOriginalType());this._oContentFactory.setUnitOriginalType(undefined);}if(this._bParseError){this._bParseError=false;this._removeUIMessage();}if(this._oContentFactory.isMeasure()){this._oContentFactory.setIsMeasure(false);}};function c1(i){if(!this._oManagedObjectModel&&!this._bIsBeingDestroyed){this._oManagedObjectModel=new r(this);}i.setModel(this._oManagedObjectModel,"$field");}function d1(i){var j=false;var R1=y1.call(this);if(!R1){return;}else if(R1.isOpen()){j=true;}else{switch(i.type){case"sapprevious":case"sapup":if(i.keyCode===K.ARROW_UP){j=true;}break;case"sapnext":case"sapdown":if(i.keyCode===K.ARROW_DOWN){j=true;}break;default:break;}}if(j){i.stopPropagation();i.stopImmediatePropagation(true);switch(i.type){case"sapup":this.onsapup(i);break;case"sapdown":this.onsapdown(i);break;default:break;}}}function e1(i,j){i.addDelegate(x,true,this);if(j){i.addDelegate(y,false,this);}}function f1(i){i.removeDelegate(x);i.removeDelegate(y);}function g1(i,j){if(j){i._OriginalGetFieldGroupIds=i._getFieldGroupIds;i._OriginalTriggerValidateFieldGroup=i.triggerValidateFieldGroup;}i._getFieldGroupIds=function(){var R1=this.getFieldGroupIds();var S1=this.getParent();if(S1){R1=R1.concat(S1._getFieldGroupIds());}return R1;};i.triggerValidateFieldGroup=function(R1){var S1=this.getParent();if(S1){var T1=R1.indexOf(S1.getId());if(T1>-1){_.call(S1,R1);}else{S1.fireValidateFieldGroup({fieldGroupIds:R1});}}};}function h1(i){if(i._OriginalGetFieldGroupIds&&i._OriginalTriggerValidateFieldGroup){i._getFieldGroupIds=i._OriginalGetFieldGroupIds;delete i._OriginalGetFieldGroupIds;i.triggerValidateFieldGroup=i._OriginalTriggerValidateFieldGroup;delete i._OriginalTriggerValidateFieldGroup;}}function i1(i){this.setProperty("_fieldHelpEnabled",true,true);this._sDefaultFieldHelp=z[i].id;var j=z[i].control;if(j&&j.bIsDestroyed){z[i].control=undefined;j=undefined;}if(!j){if(z[i].promise){z[i].promise.then(j1.bind(this,z[i].id));}var R1=sap.ui.require(z[i].name);if(!R1&&!z[i].promise){z[i].promise=new Promise(function(U1){z[i].resolve=U1;sap.ui.require([z[i].name],function(V1){i1.call(this,i);}.bind(this));}.bind(this)).then(j1.bind(this,z[i].id));}if(R1){var S1=this.bDelegateInitialized&&this.getControlDelegate()[z[i].getDelegate]();var T1=m({delegate:S1},z[i].properties);j=new R1(z[i].id,T1);j._bIsDefaultHelp=true;z[i].control=j;j.connect(this);if(z[i].resolve){z[i].resolve();delete z[i].resolve;}if(!z[i].promise){j1.call(this,z[i].id);}}}else{j1.call(this,z[i].id);}U.call(this,false);}function j1(i){w1.call(this,i,"insert");}function k1(i,j,R1,S1){var T1=i.getUseDefaultFieldHelp();if(T1&&!this.getFieldHelp()&&R1!==E.Display){if((S1===1&&T1.single)||(S1!==1&&T1.multi)){if(j.length===1){var U1=l1.call(this,j);if(S1===1){if(!(i.getEditOperator()&&i.getEditOperator()[j[0]])&&(T1.oneOperatorSingle||!U1)){return true;}}else if(T1.oneOperatorMulti||!U1){return true;}}else{return true;}}}return false;}function l1(i){if(i.length===1){var j=b.getOperator(i[0]);return!j||j.isSingleValue();}else{return false;}}function m1(i){this._bParseError=true;this._sFilterValue="";}function n1(R1){this._bParseError=true;this._sFilterValue="";var S1=R1.getParameter("newValue");var T1=false;var i=0;for(i=0;i<this._aAsyncChanges.length;i++){var U1=this._aAsyncChanges[i];if(U1.waitForUpdate&&Array.isArray(U1.result)){if(U1.result.length===0&&S1===""){U1.reject(R1.getParameter("exception"));T1=true;}else{for(var j=0;j<U1.result.length;j++){var V1=U1.result[j];if(k(V1.values[0],S1)||(V1.operator==="BT"&&k(V1.values[1],S1))){U1.reject(R1.getParameter("exception"));T1=true;break;}}}if(T1){break;}}}if(T1){this._aAsyncChanges.splice(i,1);}}function o1(i){this._bParseError=false;}function p1(i){var j={parameters:m({},i.getParameters()),source:i.getSource()};var R1=this._aAsyncChanges.length;if(R1>0&&!this._aAsyncChanges[R1-1].changeFired){this._aAsyncChanges[R1-1].changeFired=true;this._aAsyncChanges[R1-1].changeEvent=j;A.call(this,undefined,undefined,undefined,this._aAsyncChanges[R1-1].promise);return;}var S1={changeEvent:j};q1.call(this,S1);}function q1(i){var j=this.getConditions();var R1;var S1=true;var T1;var U1;var V1=i.changeEvent.source;var W1=false;var X1=true;var Y1=false;if(i.changeEvent.parameters.hasOwnProperty("valid")){S1=i.changeEvent.parameters["valid"];if(!S1&&i.changeEvent.parameters.hasOwnProperty("value")){T1=i.changeEvent.parameters["value"];}}var Z1=false;var $1=this._oContentFactory.getBoundProperty();var _1=$1&&V1.getBinding($1);if(_1&&_1.getBindingMode()!==o.OneWay&&_1.getPath()==="/conditions"&&S1){U1=j[0];R1=j[0]&&j[0].values[0];}else if(i.changeEvent.parameters.hasOwnProperty("value")){R1=i.changeEvent.parameters["value"];if(S1){Z1=true;}}else{U1=j[0];R1=j[0]&&j[0].values[0];}if(Z1){this._removeUIMessage();var a2;var b2;if(this._bIgnoreInputValue){this._bIgnoreInputValue=false;V1.setDOMValue("");if(V1.getMetadata().hasProperty("value")){V1.setValue();}return;}U1=S.resolve().then(function(){var d2=this.getMaxConditions();if(this._oNavigateCondition){S1=true;return this._oNavigateCondition;}else if(R1===""&&d2!==1){return null;}else{a2=this._oContentFactory.getConditionType();var e2=a2.parseValue(R1);var f2=this._aAsyncChanges.length;if(f2>0&&!this._aAsyncChanges[f2-1].changeFired){b2=this._aAsyncChanges[f2-1];b2.changeFired=true;b2.changeEvent=i.changeEvent;A.call(this,undefined,undefined,undefined,b2.promise);}return e2;}}.bind(this)).then(function(U1){X1=r1.call(this,U1,j,a2,S1,R1,V1,b2||i);X1=X1||Y1;return U1;}.bind(this)).catch(function(d2){if(d2&&!(d2 instanceof P)&&!(d2 instanceof p)&&!(d2 instanceof V)){throw d2;}S1=false;T1=R1;this._bParseError=true;this._sFilterValue="";Q.call(this,d2.message);if(b2&&b2.reject){if(O1.call(this,b2)){b2.reject(d2);}}else if(W1){A.call(this,j,S1,T1);}}.bind(this)).unwrap();if(U1 instanceof Promise){W1=true;}}else if(!i.changeEvent.parameters.hasOwnProperty("valid")&&this._bParseError){T1=i.changeEvent.parameters["value"];S1=false;}var c2=y1.call(this);if(c2&&this._bConnected){if(sap.ui.getCore().getCurrentFocusedControlId()===V1.getId()){c2.close();}this._sFilterValue="";if(!W1&&S1){z1.call(this,j,c2);c2.onControlChange();}t1.call(this);}if(this._oNavigateCondition){this._oNavigateCondition=undefined;this._oContentFactory.updateConditionType();}if(i.resolve){N1.call(this,i);}else if(!W1&&X1){A.call(this,j,S1,T1);}}function r1(i,j,R1,S1,T1,U1,V1){var W1=this.getMaxConditions();var X1=false;if(i===null&&W1!==1){return true;}if(R1){R1.validateValue(i);}if(S1){if(i){if(this._oContentFactory.isMeasure()&&j.length===1&&j[0].values[0][0]===undefined){j=[];}if(W1!==1&&b.indexOfCondition(i,j)>=0){throw new P(this._oResourceBundle.getText("field.CONDITION_ALREADY_EXIST",[T1]));}else{if(W1>0&&W1<=j.length){j.splice(0,j.length-W1+1);}j.push(i);}}else if(W1===1){j=[];}if(!k(j,this.getConditions())){this.setProperty("conditions",j,true);X1=true;}if(W1!==1){U1.setValue("");}}if(V1.resolve){var Y1=y1.call(this);if(Y1&&this._bConnected){z1.call(this,j,Y1);Y1.onControlChange();}V1.result=j;N1.call(this,V1);O1.call(this,V1);}return X1;}function s1(j){var R1;var S1;var T1=false;var U1=j.getSource();this._oNavigateCondition=undefined;this._oContentFactory.updateConditionType();if("value"in j.getParameters()){R1=j.getParameter("value");}else if("newValue"in j.getParameters()){R1=j.getParameter("newValue");}if("escPressed"in j.getParameters()){T1=j.getParameter("escPressed");}if("previousValue"in j.getParameters()){S1=j.getParameter("previousValue");}else{var V1=this.getConditions();S1=V1[0]&&V1[0].values[0];}var W1=y1.call(this);if(W1&&(!this._oContentFactory.isMeasure()||U1.getShowValueHelp())){if(T1){if(W1.isOpen(true)){W1.close();z1.call(this,this.getConditions(),W1);t1.call(this);this._sFilterValue="";}}else{var X1=this._getOperators();var Y1=false;for(var i=0;i<X1.length;i++){var Z1=b.getOperator(X1[i]);if(Z1.validateInput){Y1=true;break;}}if(Y1){this._bIgnoreInputValue=false;this._vLiveChangeValue=R1;if(!this._fnLiveChangeTimer){this._fnLiveChangeTimer=t(function(){var _1=this.getDisplay();this._sFilterValue="";if(this._vLiveChangeValue){var Z1=b.getEQOperator();var a2=Z1.getValues(this._vLiveChangeValue,_1,true);if(a2[0]){this._sFilterValue=a2[0];if(a2[1]){this._sFilterValue=this._sFilterValue+" ";}}if(a2[1]){this._sFilterValue=this._sFilterValue+a2[1];}}var $1=this.hasOwnProperty("_bOpenByTyping")?this._bOpenByTyping:W1.isTypeaheadSupported();if(this._bConnected&&this._getContent()[0]&&$1&&(sap.ui.getCore().getCurrentFocusedControlId()===this._getContent()[0].getId()||(this._getContent()[1]&&sap.ui.getCore().getCurrentFocusedControlId()===this._getContent()[1].getId()))){W1.setFilterValue(this._sFilterValue);if(this.getMaxConditionsForHelp()===1&&W1.getConditions().length>0){W1.setConditions([]);}W1.open(true);U.call(this,true);delete this._vLiveChangeValue;}}.bind(this),300,{leading:false,trailing:true});W1.initBeforeOpen(true);}var $1=W1.isTypeaheadSupported();if($1 instanceof Promise){$1.then(function(_1){var a2=document.activeElement;if(a2&&(n(this.getDomRef(),a2))&&this._fnLiveChangeTimer){this._fnLiveChangeTimer();}this._bOpenByTyping=_1;}.bind(this));}this._fnLiveChangeTimer();}}}this.fireLiveChange({value:R1,escPressed:T1,previousValue:S1});}function t1(){if(this._fnLiveChangeTimer){this._fnLiveChangeTimer.cancel();delete this._vLiveChangeValue;}}function u1(i){var j=this.getFieldInfo();if(j){j.getTriggerHref().then(function(R1){if(!R1){j.open(this._getContent()[0]);U.call(this,true);}}.bind(this));}this.firePress();}function v1(j){if(j.getParameter("type")==="removed"){var R1=j.getParameter("removedTokens");var S1=this.getConditions();var T1;var i;for(i=0;i<R1.length;i++){var U1=R1[i];var V1=U1.getBindingContext("$field").sPath;var W1=parseInt(V1.slice(V1.lastIndexOf("/")+1));S1[W1].delete=true;}for(i=S1.length-1;i>=0;i--){if(S1[i].delete){if(this._oContentFactory.isMeasure()){T1=S1[i].values[0][1];}S1.splice(i,1);}}if(this._oContentFactory.isMeasure()&&T1&&S1.length===0){S1=[c.createItemCondition([undefined,T1],undefined)];}this.setProperty("conditions",S1,true);G.call(this,S1,true);j.preventDefault(true);}}function w1(i,j){if(j==="remove"){var R1=sap.ui.getCore().byId(i);if(R1){R1.detachEvent("select",B1,this);R1.detachEvent("navigated",C1,this);R1.detachEvent("dataUpdate",F1,this);R1.detachEvent("disconnect",G1,this);R1.detachEvent("afterClose",D1,this);R1.detachEvent("switchToValueHelp",E1,this);}this.setProperty("_fieldHelpEnabled",false,true);this._bConnected=false;}else if(j==="insert"){x1.call(this,i);}var S1=this._getContent()[0];if(S1&&S1.setValueHelpIconSrc){S1.setValueHelpIconSrc(this._getFieldHelpIcon());}O.call(this,this.getConditions());}function x1(i){if(i&&!this.getProperty("_fieldHelpEnabled")){var j=sap.ui.getCore().byId(i);if(j){j.attachEvent("dataUpdate",F1,this);if(!j.valueHelpEnabled||j.valueHelpEnabled()){this.setProperty("_fieldHelpEnabled",true,true);}}}}function y1(){var i=this.getFieldHelp();var j;if(!i&&this._sDefaultFieldHelp){i=this._sDefaultFieldHelp;}if(i){j=sap.ui.getCore().byId(i);}return j;}function z1(j,R1){if(!R1){R1=y1.call(this);}if(this._oContentFactory.isMeasure()){var S1=[];for(var i=0;i<j.length;i++){var T1=j[i];if(T1.values[0]&&T1.values[0][1]){var U1=c.createItemCondition(T1.values[0][1],undefined,T1.inParameters,T1.outParameters);S1.push(U1);}}R1.setConditions(S1);}else{R1.setConditions(j);}}function A1(i){var j=y1.call(this);if(j){j.setFilterValue(this._sFilterValue);var R1=this.getConditions();z1.call(this,R1,j);j.toggleOpen(false);U.call(this,true);if(!j.isFocusInHelp()){var S1=i.getSource();if(S1.bValueHelpRequested){S1.bValueHelpRequested=false;}}}}function B1(j){var R1=this.getConditions();var S1=j.getParameter("conditions");var T1=j.getParameter("add");var U1=j.getParameter("close");var V1=j.oSource;var W1=this.getMaxConditions();var X1;var Y1=this.getControlForSuggestion();var Z1;var i=0;if(this._oContentFactory.isMeasure()){if(S1.length>1){throw new Error("Only one item must be selected! "+this);}if(S1[0].operator!=="EQ"){throw new Error("Only EQ allowed! "+this);}if(R1.length>0){for(i=0;i<R1.length;i++){R1[i].values[0][1]=S1[0].values[0];if(R1[i].operator==="BT"){R1[i].values[1][1]=S1[0].values[0];}if(S1[0].inParameters){R1[i].inParameters=S1[0].inParameters;}if(S1[0].outParameters){R1[i].outParameters=S1[0].outParameters;}if(S1[0].payload){R1[i].payload=S1[0].payload;}}}else{var $1=b.getEQOperator(this._getOperators());var _1=this.getControlDelegate().enhanceValueForUnit(this.getPayload(),[null,S1[0].values[0]],this._oTypeInitialization);X1=c.createCondition($1.name,[_1],S1[0].inParameters,S1[0].outParameters,C.NotValidated);R1.push(X1);var a2=this._oContentFactory.getConditionType(true);var b2=this._oContentFactory.getUnitConditionsType(true);if(a2){Z1=a2.formatValue(X1);}else if(b2){Z1=b2.formatValue(R1);}}}else{if(!T1){R1=[];}for(i=0;i<S1.length;i++){X1=S1[i];if(!P1.call(this,X1.operator)){continue;}var c2=T1?-1:b.indexOfCondition(X1,R1);if(c2===-1){R1.push(X1);}else if(X1.values[1]!==R1[c2].values[1]&&R1[c2].values[1]){R1[c2].values[1]=X1.values[1];}}}if(W1>0&&W1<R1.length){R1.splice(0,R1.length-W1);}var d2=false;if(Y1&&Y1.setDOMValue){if(this.getMaxConditionsForHelp()===1&&R1.length>0){if(this._oContentFactory.isMeasure()&&this._oContentFactory.getUnitConditionsType()){Z1=this._oContentFactory.getUnitConditionsType().formatValue(R1);}else if(this._oContentFactory.getConditionType(true)){Z1=this._oContentFactory.getConditionType().formatValue(R1[0]);}else if(this._oContentFactory.getConditionsType(true)){Z1=this._oContentFactory.getConditionsType().formatValue(R1);}if(Z1 instanceof Promise){Z1.then(function(f2){Y1.setDOMValue("");Y1.setDOMValue(f2);});}else{Y1.setDOMValue("");Y1.setDOMValue(Z1);}this._sFilterValue="";}else if(U1){if(this.getMaxConditions()!==1&&!this._oContentFactory.getBoundProperty()&&Y1.getMetadata().hasProperty("value")&&Y1.getProperty("value")){Y1.setValue();}Y1.setDOMValue("");this._sFilterValue="";this._bIgnoreInputValue=false;}else{this._bIgnoreInputValue=true;}if(this._bParseError){this._bParseError=false;this._removeUIMessage();d2=true;}}var e2=this.getConditions();if(!k(R1,e2)){this._oNavigateCondition=undefined;this._oContentFactory.updateConditionType();this.setProperty("conditions",R1,true);if(!b.compareConditionsArray(R1,e2)){V1.onControlChange();A.call(this,R1,true);}}else if(d2){A.call(this,R1,true);}}function C1(i){var j=i.getParameter("value");var R1=i.getParameter("key");var S1=i.getParameter("condition");var T1=i.getParameter("itemId");var U1=i.getParameter("leaveFocus");if(!S1&&R1){S1=c.createItemCondition(R1,j);}var V1;var W1;var X1=this.getControlForSuggestion();var Y1=b.getEQOperator(this._getOperators());var Z1=y1.call(this);if(U1){X1.addStyleClass("sapMFocus");X1.focus();Z1.removeFocus();return;}if(S1){this._oNavigateCondition=m({},S1);this._oNavigateCondition.operator=Y1.name;R1=S1.values[0];j=S1.values[1];}else{this._oNavigateCondition=c.createCondition(Y1.name,[R1,j],undefined,undefined,C.Validated);}if(this._oContentFactory.isMeasure()){var $1=this.getConditions();if($1.length>0){this._oNavigateCondition.operator=$1[0].operator;this._oNavigateCondition.values[0]=[$1[0].values[0][0],R1];if($1[0].operator==="BT"){this._oNavigateCondition.values[1]=[$1[0].values[1][0],this._oNavigateCondition.values[0][1]];}else if(this._oNavigateCondition.values.length>1){this._oNavigateCondition.values.splice(1);}}else{this._oNavigateCondition.values=[this.getControlDelegate().enhanceValueForUnit(this.getPayload(),[null,R1],this._oTypeInitialization)];}}this._bPreventGetDescription=true;this._oContentFactory.updateConditionType();if(this.getDisplay()!==F.Value){V1=R1;}else if(j){V1=j;}else{V1=R1;}if(X1&&X1.setDOMValue){if(!W1){if(this._oContentFactory.isMeasure()&&this._oContentFactory.getUnitConditionsType()&&this._oNavigateCondition){W1=this._oContentFactory.getUnitConditionsType().formatValue([this._oNavigateCondition]);}else if(this._oContentFactory.getConditionType(true)&&this._oNavigateCondition){W1=this._oContentFactory.getConditionType().formatValue(this._oNavigateCondition);}else if(this._oContentFactory.getConditionsType(true)&&this._oNavigateCondition){W1=this._oContentFactory.getConditionsType().formatValue([this._oNavigateCondition]);}else{W1=j||R1;}}X1.setDOMValue(W1);X1._doSelect();if(Z1.isOpen()){X1.removeStyleClass("sapMFocus");}}this._bPreventGetDescription=false;this._oContentFactory.updateConditionType();U.call(this,true,T1);this._bIgnoreInputValue=false;this.fireLiveChange({value:V1});}function D1(i){if(this._bIgnoreInputValue){var j=this.getControlForSuggestion();this._bIgnoreInputValue=false;j.setDOMValue("");this._sFilterValue="";if(this.getMaxConditions()!==1&&!this._oContentFactory.getBoundProperty()&&j.getMetadata().hasProperty("value")&&j.getProperty("value")){j.setValue();}}U.call(this,false);var R1=i.getSource();var S1=this.getConditions();z1.call(this,S1,R1);}function E1(i){var j=this.getControlForSuggestion();j.focus();if(j.fireValueHelpRequest){j.bValueHelpRequested=true;j.fireValueHelpRequest();}}function F1(i){var j=this.getEditMode()===E.Editable&&this._getContent().length>0&&sap.ui.getCore().getCurrentFocusedControlId()===this._getContent()[0].getId();if(!j&&!this._bPendingConditionUpdate&&this.getConditions().length>0&&(this.getMaxConditions()!==1||(this.getDisplay()!==F.Value&&!this._bParseError))&&this._oManagedObjectModel){this._oManagedObjectModel.checkUpdate(true);}}function G1(i){var j=y1.call(this);j.detachEvent("select",B1,this);j.detachEvent("navigated",C1,this);j.detachEvent("disconnect",G1,this);j.detachEvent("afterClose",D1,this);j.detachEvent("switchToValueHelp",E1,this);j.detachEvent("closed",D1,this);this._bConnected=false;}function H1(){var i=y1.call(this);if(i&&!this._bConnected){var j=Q1.call(this);var R1;var S1=this._oContentFactory.isMeasure();if(S1){var T1=this._oContentFactory.getCompositeTypes();if(T1&&T1.length>1){R1=T1[1];}}else{R1=this._oContentFactory.getDataType();}var U1={maxConditions:this.getMaxConditions(),dataType:R1,operators:this._getOperators(),display:S1?F.Value:this.getDisplay(),delegate:this.getControlDelegate(),delegateName:this.getDelegate()&&this.getDelegate().name,payload:this.getPayload(),conditionModel:j.model,conditionModelName:j.name,defaultOperatorName:this.getDefaultOperator?this.getDefaultOperator():null};i.connect(this,U1);this._bConnected=true;i.attachEvent("select",B1,this);i.attachEvent("navigated",C1,this);i.attachEvent("disconnect",G1,this);i.attachEvent("afterClose",D1,this);i.attachEvent("switchToValueHelp",E1,this);i.attachEvent("closed",D1,this);var V1=this.getConditions();z1.call(this,V1,i);var W1=this.getControlForSuggestion();I1.call(this,W1);if(i._bIsDefaultHelp&&i.setTitle){i.setTitle(this.getLabel());}}}function I1(i){if(i&&!i.orgOnsapfocusleave&&i.onsapfocusleave){i.orgOnsapfocusleave=i.onsapfocusleave;i.onsapfocusleave=function(j){var R1=y1.call(this.getParent());if(R1){var S1=sap.ui.getCore().byId(j.relatedControlId);if(S1){if(n(R1.getDomRef(),S1.getFocusDomRef())){j.stopPropagation();return;}else{R1.skipOpening();}}}this.orgOnsapfocusleave(j);};}}w.prototype._getFieldHelpIcon=function(){var i=y1.call(this);if(i){return i.getIcon();}};function J1(i,j){if(j==="remove"){i.detachEvent("dataUpdate",K1,this);}else if(j==="insert"){i.attachEvent("dataUpdate",K1,this);K1.call(this);}}function K1(){var i=this.getFieldInfo();var j=this;i.isTriggerable().then(function(R1){j._bTriggerable=R1;var S1=j.getAggregation("_content",[]);if(S1.length>0&&j.getEditMode()===E.Display){$.call(j);if(j._bTriggerable){S1=j.getAggregation("_content",[]);var T1=S1[0];i.getDirectLinkHrefAndTarget().then(function(U1){f._updateLink(T1,U1);});}}});}w.prototype._getFormatOptions=function(){if(!this._asyncParsingCall){this._asyncParsingCall=L1.bind(this);}var i=Q1.call(this);return{valueType:this._oContentFactory.retrieveDataType(),originalDateType:this._oContentFactory.getDateOriginalType()||this._oContentFactory.getUnitOriginalType(),additionalType:this._oContentFactory.getUnitType(),compositeTypes:this._oContentFactory.getCompositeTypes(),display:this._oContentFactory.isMeasure()?F.Value:this.getDisplay(),fieldHelpID:this._oContentFactory.isMeasure()?undefined:this.getFieldHelp()||this._sDefaultFieldHelp,operators:this._getOperators(),hideOperator:this._oContentFactory.getHideOperator(),maxConditions:this.getMaxConditions(),bindingContext:this.getBindingContext(),asyncParsing:this._asyncParsingCall,navigateCondition:this._oNavigateCondition,delegate:this.getControlDelegate(),delegateName:this.getDelegate()&&this.getDelegate().name,payload:this.getPayload(),preventGetDescription:this._bPreventGetDescription,conditionModel:i.model,conditionModelName:i.name,convertWhitespaces:this.getEditMode()===E.Display||this.getMaxConditions()!==1,control:this,defaultOperatorName:this.getDefaultOperator?this.getDefaultOperator():null};};w.prototype._checkValueInitial=function(i){if(i===null||i===undefined){return true;}if(i===""||(typeof(i)==="string"&&i.match(/^0+$/))){var j=this._oContentFactory.retrieveDataType();var R1=j.parseValue("","string");if(R1===i){return true;}else{try{j.validateValue(R1);}catch(S1){return true;}}}else{var T1=I.call(this);if(this.getTypeUtil().getBaseType(T1)===B.Unit&&Array.isArray(i)&&i.length>1&&(i[0]===undefined||i[0]===null)&&!i[1]){return true;}}return false;};w.prototype._getUnitFormatOptions=function(){if(!this._asyncParsingCall){this._asyncParsingCall=L1.bind(this);}var i=Q1.call(this);return{valueType:this._oContentFactory.getUnitType(),originalDateType:this._oContentFactory.getDateOriginalType()||this._oContentFactory.getUnitOriginalType(),additionalType:this._oContentFactory.retrieveDataType(),compositeTypes:this._oContentFactory.getCompositeTypes(),display:this.getDisplay(),fieldHelpID:this.getFieldHelp()||this._sDefaultFieldHelp,operators:["EQ"],hideOperator:true,maxConditions:1,bindingContext:this.getBindingContext(),asyncParsing:this._asyncParsingCall,navigateCondition:this._oNavigateCondition,delegate:this.getControlDelegate(),delegateName:this.getDelegate()&&this.getDelegate().name,payload:this.getPayload(),preventGetDescription:this._bPreventGetDescription,conditionModel:i.model,conditionModelName:i.name,convertWhitespaces:this.getEditMode()===E.Display||this.getEditMode()===E.EditableDisplay,control:this,getConditions:this.getConditions.bind(this)};};function L1(i){var j=y1.call(this);if(j&&j.isOpen()){var R1=document.activeElement;if(R1&&(n(this.getDomRef(),R1)||n(j.getDomRef(),R1))){j.close();}}var S1={};var T1=new Promise(function(U1,V1){S1.resolve=U1;S1.reject=V1;i.then(function(W1){S1.result=W1;this._bParseError=false;var X1=this.getConditions();if(k(W1,X1)){N1.call(this,S1);O1.call(this,S1);}else{S1.waitForUpdate=true;}}.bind(this)).catch(function(W1){if(W1&&!(W1 instanceof P)&&!(W1 instanceof p)&&!(W1 instanceof V)){throw W1;}this._bParseError=true;V1(W1);O1.call(this,S1);}.bind(this));}.bind(this));S1.promise=T1;this._aAsyncChanges.push(S1);}function M1(){var j=[];for(var i=0;i<this._aAsyncChanges.length;i++){j.push(this._aAsyncChanges[i].promise);}if(j.length>0){return Promise.all(j).then(function(){return this._getResultForPromise(this.getConditions());}.bind(this));}return null;}w.prototype._getResultForPromise=function(i){return i;};function N1(i){i.resolve(this._getResultForPromise(i.result));}function O1(j){var R1=false;var i=0;for(i=0;i<this._aAsyncChanges.length;i++){if(j===this._aAsyncChanges[i]){R1=true;break;}}if(R1){this._aAsyncChanges.splice(i,1);}return R1;}w.prototype._getOperators=function(){var i=new RegExp("^\\*(.*)\\*|\\$search$");if(i.test(this.getFieldPath())&&this.getMaxConditions()===1){return["Contains"];}var j=this.getBaseType();if(j===B.Unit){j=B.Numeric;}return b.getOperatorsForType(j);};function P1(j){var R1=this._getOperators();for(var i=0;i<R1.length;i++){if(j===R1[i]){return true;}}return false;}function Q1(){var i;var j;var R1=this.getBinding("conditions");if(R1){var S1=R1.getModel();if(S1&&S1.isA("sap.ui.mdc.condition.ConditionModel")){i=S1;var T1=this.getBindingInfo("conditions");if(T1.model){j=T1.model;}else if(T1.parts&&T1.parts.length===1){j=T1.parts[0].model;}}}return{name:j,model:i};}w.prototype._isPropertyInitial=function(i){if(this.isBound(i)&&!this.getBinding(i)){return!Object.prototype.hasOwnProperty.call(this.mProperties,i);}else{return this.isPropertyInitial(i);}};return w;});
