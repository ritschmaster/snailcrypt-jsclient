/*
 * ! OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/mdc/field/content/DefaultContent","sap/ui/model/Filter","sap/base/util/isEmptyObject","sap/base/util/merge","sap/base/util/ObjectPath","sap/ui/mdc/enum/EditMode"],function(D,F,i,m,O,E){"use strict";var U=Object.assign({},D,{getEdit:function(){return["sap/ui/mdc/field/FieldInput","sap/ui/core/InvisibleText"];},getEditMultiValue:function(){return["sap/ui/mdc/field/FieldMultiInput","sap/ui/mdc/field/FieldInput","sap/m/Token","sap/ui/core/InvisibleText"];},getEditMultiLine:function(){return[null];},getUseDefaultFieldHelp:function(){return false;},createEdit:function(c,C,I){c.setIsMeasure(true);var a=C[0];var b=C[1];var o=c.getConditionsType();this._adjustDataTypeForUnit(c);var s=b.getStaticId("sap.ui.mdc","field.NUMBER");var d=[];var e=new a(I,{value:{path:"$field>/conditions",type:o},placeholder:"{$field>/placeholder}",textAlign:"{$field>/textAlign}",textDirection:"{$field>/textDirection}",valueHelpIconSrc:"sap-icon://slim-arrow-down",required:"{$field>/required}",editable:{path:"$field>/editMode",formatter:c.getMetadata()._oClass._getEditable},enabled:{path:"$field>/editMode",formatter:c.getMetadata()._oClass._getEnabled},valueState:"{$field>/valueState}",valueStateText:"{$field>/valueStateText}",showValueHelp:false,width:"70%",tooltip:"{$field>/tooltip}",autocomplete:false,fieldGroupIds:[c.getField().getId()],ariaDescribedBy:[s],change:c.getHandleContentChange(),liveChange:c.getHandleContentLiveChange()});e._setPreferUserInteraction(true);c.setAriaLabelledBy(e);d.push(e);d=this._addUnitControl(c,d,I,a,b);c.setBoundProperty("value");return d;},createEditMultiValue:function(c,C,I){c.setIsMeasure(true);var M=C[0];var T=C[2];var a=C[1];var b=C[3];var o=c.getConditionType();this._adjustDataTypeForUnit(c);var d=[];var t=new T(I+"-token",{text:{path:'$field>',type:o}});var f=new F({path:"values",test:function(v){if(!Array.isArray(v[0])||v[0][0]){return true;}else{return false;}}});var s=b.getStaticId("sap.ui.mdc","field.NUMBER");var e=new M(I,{placeholder:"{$field>/placeholder}",textAlign:"{$field>/textAlign}",textDirection:"{$field>/textDirection}",required:"{$field>/required}",editable:{path:"$field>/editMode",formatter:c.getMetadata()._oClass._getEditable},enabled:{path:"$field>/editMode",formatter:c.getMetadata()._oClass._getEnabled},valueState:"{$field>/valueState}",valueStateText:"{$field>/valueStateText}",showValueHelp:false,width:"70%",tooltip:"{$field>/tooltip}",fieldGroupIds:[c.getField().getId()],ariaDescribedBy:[s],tokens:{path:"$field>/conditions",template:t,filters:[f]},dependents:[t],change:c.getHandleContentChange(),liveChange:c.getHandleContentLiveChange(),tokenUpdate:c.getHandleTokenUpdate()});e._setPreferUserInteraction(true);c.setAriaLabelledBy(e);d.push(e);d=this._addUnitControl(c,d,I,a,b);c.setBoundProperty("value");return d;},createEditMultiLine:function(){throw new Error("sap.ui.mdc.field.content.UnitContent - createEditMultiLine not defined!");},_addUnitControl:function(c,C,I,a,b){var u=c.getUnitConditionsType();if(c.getField().getEditMode()===E.EditableDisplay){C[0].bindProperty("description",{path:"$field>/conditions",type:u});C[0].setWidth("100%");C[0].setFieldWidth("70%");}else{var s;var t=c.getUnitOriginalType();var n=t&&t.getMetadata().getName();if(n&&n.indexOf("Currency")>=0){s=b.getStaticId("sap.ui.mdc","field.CURRENCY");}else{s=b.getStaticId("sap.ui.mdc","field.UNIT");}var o=new a(I+"-unit",{value:{path:"$field>/conditions",type:u},placeholder:"{$field>/placeholder}",textAlign:"{$field>/textAlign}",textDirection:"{$field>/textDirection}",required:"{$field>/required}",editable:{path:"$field>/editMode",formatter:c.getMetadata()._oClass._getEditableUnit},enabled:{path:"$field>/editMode",formatter:c.getMetadata()._oClass._getEnabled},valueState:"{$field>/valueState}",valueHelpIconSrc:c.getFieldHelpIcon(),valueStateText:"{$field>/valueStateText}",showValueHelp:"{$field>/_fieldHelpEnabled}",ariaAttributes:"{$field>/_ariaAttributes}",width:"30%",tooltip:"{$field>/tooltip}",autocomplete:false,fieldGroupIds:[c.getField().getId()],ariaDescribedBy:[s],change:c.getHandleContentChange(),liveChange:c.getHandleContentLiveChange(),valueHelpRequest:c.getHandleValueHelpRequest()});o._setPreferUserInteraction(true);c.setAriaLabelledBy(o);C.push(o);}return C;},_adjustDataTypeForUnit:function(c){var f=c.getField();var t=c.retrieveDataType();var n=t.getMetadata().getName();var o=t.getFormatOptions();var C=i(t.getConstraints())?undefined:t.getConstraints();var s=!o||!o.hasOwnProperty("showMeasure")||o.showMeasure;var S=!o||!o.hasOwnProperty("showNumber")||o.showNumber;if(s&&S){o=m({},o);o.showMeasure=false;o.showNumber=true;o.strictParsing=true;var T=O.get(n);c.setUnitOriginalType(c.getDataType());c.setDataType(new T(o,C));f.getControlDelegate().initializeInternalUnitType(f.getPayload(),c.getDataType(),c.getFieldTypeInitialization());o=m({},o);o.showMeasure=true;o.showNumber=false;o.strictParsing=true;T=O.get(n);c.setUnitType(new T(o,C));f.getControlDelegate().initializeInternalUnitType(f.getPayload(),c.getUnitType(),c.getFieldTypeInitialization());c.updateConditionType();}}});return U;});
