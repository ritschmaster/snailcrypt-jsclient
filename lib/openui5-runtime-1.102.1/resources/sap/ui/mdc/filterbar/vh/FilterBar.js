/*
 * ! OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/m/library","sap/ui/mdc/filterbar/FilterBarBase","sap/ui/mdc/filterbar/FilterBarBaseRenderer","sap/ui/mdc/filterbar/aligned/FilterItemLayout","sap/ui/mdc/filterbar/vh/FilterContainer","sap/m/Button","sap/ui/mdc/enum/PersistenceMode"],function(l,F,a,b,c,B,P){"use strict";var d=F.extend("sap.ui.mdc.filterbar.vh.FilterBar",{metadata:{properties:{expandFilterFields:{type:"boolean",defaultValue:true},filterFieldThreshold:{type:"int",defaultValue:8}},aggregations:{}},renderer:a});var e=l.ButtonType;d.prototype._createInnerLayout=function(){this._cLayoutItem=b;this._oFilterBarLayout=new c(this.getId()+"-innerLayout",{});this.setAggregation("layout",this._oFilterBarLayout,true);this._oBtnFilters=new B(this.getId()+"-btnShowFilters",{type:e.Transparent,press:this._onToggleFilters.bind(this)});this._oBtnFilters.bindProperty("text",{model:F.INNER_MODEL_NAME,path:"/expandFilterFields",formatter:function(E){return this._oRb.getText("valuehelp."+(E?"HIDE":"SHOW")+"ADVSEARCH");}.bind(this)});this._oBtnFilters.bindProperty("visible",{model:F.INNER_MODEL_NAME,path:"/filterItems",formatter:function(i){return i.length>0;}});this._oFilterBarLayout.addControl(this._getSearchButton().bindProperty("visible",{parts:[{path:'/showGoButton',model:F.INNER_MODEL_NAME},{path:"/liveMode",model:F.INNER_MODEL_NAME}],formatter:function(s,L){return s&&((this._isPhone())?true:!L);}.bind(this)}));this._oFilterBarLayout.addControl(this._oBtnFilters);this._oShowAllFiltersBtn=new B(this.getId()+"-btnShowAllFilters",{type:e.Transparent,press:this._onShowAllFilters.bind(this),text:this._oRb.getText("valuehelp.SHOWALLFILTERS")});this._oFilterBarLayout.addEndContent(this._oShowAllFiltersBtn);};d.prototype.applySettings=function(s,S){this._applySettings(s,S);this._waitForMetadata();};d.prototype._handleConditionModelPropertyChange=function(){F.prototype._handleConditionModelPropertyChange.apply(this,arguments);this.fireFiltersChanged({conditionsBased:true});};d.prototype.init=function(){F.prototype.init.apply(this,arguments);this._bPersistValues=true;this.getEngine().defaultProviderRegistry.attach(this,P.Transient);};d.prototype.exit=function(){this.getEngine().defaultProviderRegistry.detach(this);if(this._oCollectiveSearch){this._oFilterBarLayout.removeControl(this._oCollectiveSearch);this._oCollectiveSearch=null;}F.prototype.exit.apply(this,arguments);this._oBasicSearchField=null;this._oBtnFilters=null;this._oShowAllFiltersBtn=null;};d.prototype._onToggleFilters=function(E){this.setExpandFilterFields(!this.getExpandFilterFields());};d.prototype._onShowAllFilters=function(E){this._oFilterBarLayout._updateFilterBarLayout(true);};d.prototype.setCollectiveSearch=function(C){if(this._oCollectiveSearch){if(this._oFilterBarLayout){this._oFilterBarLayout.removeControl(this._oCollectiveSearch);}}this._oCollectiveSearch=C;if(this._oFilterBarLayout&&this._oCollectiveSearch){this._oFilterBarLayout.insertControl(this._oCollectiveSearch,0);}return this;};d.prototype.getCollectiveSearch=function(){return this._oCollectiveSearch;};d.prototype.destroyCollectiveSearch=function(){if(this._oCollectiveSearch&&this._oFilterBarLayout){this._oFilterBarLayout.removeControl(this._oCollectiveSearch);this._oCollectiveSearch.destroy();this._oCollectiveSearch=undefined;}return this;};d.prototype.setBasicSearchField=function(o){if(this._oBasicSearchField){if(this._oFilterBarLayout){this._oFilterBarLayout.removeControl(this._oBasicSearchField);}this._oBasicSearchField.detachSubmit(this._handleFilterItemSubmit,this);}this._oBasicSearchField=o;if(o){if(this.isPropertyInitial("expandFilterFields")){this.setExpandFilterFields(false);}if(this._oFilterBarLayout){this._oFilterBarLayout.insertControl(o,this._oCollectiveSearch?1:0);}o.attachSubmit(this._handleFilterItemSubmit,this);if(!this._oObserver.isObserved(o,{properties:["visible"]})){this._oObserver.observe(o,{properties:["visible"]});}}return this;};d.prototype.getBasicSearchField=function(){return this._oBasicSearchField;};d.prototype.destroyBasicSearchField=function(){if(this._oBasicSearchField&&this._oFilterBarLayout){this._oFilterBarLayout.removeControl(this._oBasicSearchField);this._oBasicSearchField.detachSubmit(this._handleFilterItemSubmit,this);if(this._oObserver.isObserved(this._oBasicSearchField,{properties:["visible"]})){this._oObserver.unobserve(this._oBasicSearchField);}this._oBasicSearchField.destroy();this._oBasicSearchField=undefined;}return this;};return d;});
