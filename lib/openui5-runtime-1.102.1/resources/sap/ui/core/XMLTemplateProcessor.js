/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['sap/ui/thirdparty/jquery','sap/ui/base/DataType','sap/ui/base/ManagedObject','sap/ui/core/CustomData','sap/ui/core/Component','./mvc/View','./mvc/ViewType','./mvc/XMLProcessingMode','./mvc/EventHandlerResolver','./ExtensionPoint','./StashedControlSupport','sap/ui/base/SyncPromise','sap/base/Log','sap/base/util/ObjectPath','sap/base/util/values','sap/base/assert','sap/base/security/encodeXML','sap/base/util/LoaderExtensions','sap/base/util/JSTokenizer','sap/base/util/isEmptyObject'],function(q,D,M,C,a,V,b,X,E,c,S,d,L,O,v,f,g,h,J,k){"use strict";function l(e,i,N,j,R){var p=M.bindingParser(i,j,true,false,false,false,R);if(p&&typeof p==="object"){return p;}var K=i=typeof p==="string"?p:i;var Q=D.getType(e);if(Q){if(Q instanceof D){K=Q.parseValue(i,{context:j,locals:R});if(!Q.isValid(K)){L.error("Value '"+i+"' is not valid for type '"+Q.getName()+"'.");}}}else{throw new Error("Property "+N+" has unknown type "+e);}return typeof K==="string"?M.bindingParser.escape(K):K;}function m(e){return e.localName||e.nodeName;}var n="http://www.w3.org/1999/xhtml";var o="http://www.w3.org/2000/xmlns/";var r="http://www.w3.org/2000/svg";var s="sap.ui.core";var t="sap.ui.core.mvc";var u="http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1";var w="http://schemas.sap.com/sapui5/extension/sap.ui.core.support.Support.info/1";var x="http://schemas.sap.com/sapui5/extension/sap.ui.core.xmlcomposite/1";var U="http://schemas.sap.com/sapui5/extension/sap.ui.core.Internal/1";var P="http://schemas.sap.com/sapui5/preprocessorextension/";var y=['controllerName','resourceBundleName','resourceBundleUrl','resourceBundleLocale','resourceBundleAlias'];var z=/^(?:area|base|br|col|embed|hr|img|input|link|meta|param|source|track|wbr)$/;function A(e,j){function p(N,Q){var R,W=[];for(var i=0;i<N.childNodes.length;i++){R=j(N,N.childNodes[i],Q);if(R){W.push(R.unwrap());}}return d.resolve(W);}function K(N,Q){var R=Promise.resolve(),W=[Q.chain];for(var i=0;i<N.childNodes.length;i++){R=R.then(j.bind(null,N,N.childNodes[i],Q));W.push(R);}return Promise.all(W);}return e?K:p;}var B={};B.loadTemplate=function(e,i){var R=e.replace(/\./g,"/")+("."+(i||"view")+".xml");return h.loadResource(R).documentElement;};B.loadTemplatePromise=function(e,i){var R=e.replace(/\./g,"/")+("."+(i||"view")+".xml");return h.loadResource(R,{async:true}).then(function(j){return j.documentElement;});};B.parseViewAttributes=function(e,j){var i,p;for(i=0;i<e.attributes.length;i++){p=e.attributes[i];if(y.includes(p.name)){j["_"+p.name]=p.value;}}};B.enrichTemplateIds=function(e,i){B.enrichTemplateIdsPromise(e,i,false);return e;};B.enrichTemplateIdsPromise=function(e,i,j){return I(e,i,true,j).then(function(){return e;});};B.parseTemplate=function(e,i,j){return B.parseTemplatePromise(e,i,false,{settings:j}).unwrap();};B.parseTemplatePromise=function(e,j,p,K){return I(e,j,false,p,K).then(function(R){if(j.isA("sap.ui.core.mvc.View")){var N,i;for(i=R.length-1;i>=0;i--){N=R[i];if(N&&N._isExtensionPoint){var Q=[i,1].concat(N._aControls);Array.prototype.splice.apply(R,Q);}}}return R;});};function F(R){var e,i=/^[a-zA-Z_$][a-zA-Z0-9_$]*$/;if(!R||typeof R!=="object"){e="core:require in XMLView can't be parsed to a valid object";}else{Object.keys(R).some(function(K){if(!i.test(K)){e="core:require in XMLView contains invalid identifier: '"+K+"'";return true;}if(!R[K]||typeof R[K]!=="string"){e="core:require in XMLView contains invalid value '"+R[K]+"'under key '"+K+"'";return true;}});}return e;}function G(j,p){var K=j.getAttributeNS(s,"require"),R,N,Q;if(K){try{R=J.parseJS(K);}catch(e){L.error("Require attribute can't be parsed on Node: ",j.nodeName);throw e;}Q=F(R);if(Q){throw new Error(Q+" on Node: "+j.nodeName);}if(!k(R)){N={};if(p){return new Promise(function(W,Y){var Z=Object.keys(R).reduce(function(i,$){N[$]=sap.ui.require(R[$]);return i&&N[$]!==undefined;},true);if(Z){W(N);return;}sap.ui.require(v(R),function(){var $=arguments;Object.keys(R).forEach(function(_,i){N[_]=$[i];});W(N);},Y);});}else{Object.keys(R).forEach(function(i){N[i]=sap.ui.requireSync(R[i]);});return d.resolve(N);}}}}function T(e,i,j){var K=d.resolve();if(!k(j)){var N=[];var R;if(e){K=new Promise(function(p){R=p;});}Object.keys(j).forEach(function(Q){var W=j[Q];W.forEach(function(Y){Y.targetControl=i;var Z=sap.ui.require(Y.providerClass);if(Z){N.push(Z.applyExtensionPoint(Y));}else{var p=new Promise(function($,_){sap.ui.require([Y.providerClass],function(a1){$(a1);},_);}).then(function($){return $.applyExtensionPoint(Y);});N.push(p);}});});if(e){Promise.all(N).then(R);}}return K;}function H(e,i,p){var j=p;for(var K=0;K<100;K++){var R=e.lookupNamespaceURI(j);if(R==null||R===i){return j;}j=p+K;}throw new Error("Could not find an unused namespace prefix after 100 tries, giving up");}function I(p,K,N,Q,R){var W=[],Y=H(p,U,"__ui5"),Z=G(p,Q)||d.resolve(),$={openStart:function(e,j){W.push(["openStart",[e,j]]);},voidStart:function(e,j){W.push(["voidStart",[e,j]]);},style:function(e,j){W.push(["style",[e,j]]);},"class":function(e){W.push(["class",[e]]);},attr:function(e,j){W.push(["attr",[e,j]]);},openEnd:function(){W.push(["openEnd"]);},voidEnd:function(){W.push(["voidEnd"]);},text:function(e){W.push(["text",[e]]);},unsafeHtml:function(e){W.push(["unsafeHtml",[e]]);},close:function(e){W.push(["close",[e]]);},renderControl:function(e){W.push(e);}};Q=Q&&!!K._sProcessingMode;L.debug("XML processing mode is "+(K._sProcessingMode||"default")+".","","XMLTemplateProcessor");L.debug("XML will be processed "+(Q?"asynchronously":"synchronously")+".","","XMLTemplateProcessor");var _=sap.ui.getCore().getConfiguration().getDesignMode();if(_){K._sapui_declarativeSourceInfo={xmlNode:p,xmlRootNode:K._oContainingView===K?p:K._oContainingView._sapui_declarativeSourceInfo.xmlRootNode};}if(!K.isSubView()){p.setAttributeNS(o,"xmlns:"+Y,U);}var a1=h1(p,Z);var i=0;function b1(){for(;i<W.length;i++){var e=W[i];if(e&&typeof e.then==='function'){return e.then(c1).then(b1);}}return W;}function c1(e){var j=[i,1].concat(e);Array.prototype.splice.apply(W,j);}return Z.then(b1).then(function(W){if(a1){var e=p.parentNode;e.removeChild(p);if(e.parentNode){e.parentNode.replaceChild(p,e);}}return W;});function d1(e){return e;}function e1(e){return K._oContainingView.createId(e);}function f1(e,j){var p1=K.getMetadata().isA("sap.ui.core.mvc.View")?"View":"Fragment";var q1=e.outerHTML?e.cloneNode(false).outerHTML:e.textContent;return"Error found in "+p1+" (id: '"+K.getId()+"').\nXML node: '"+q1+"':\n"+j;}function g1(e){var j=m(e),p1;if(K.isA("sap.ui.core.mvc.XMLView")&&(e.namespaceURI===n||e.namespaceURI===r)){p1=e.ownerDocument.createElementNS(t,"View");}else if(K.isA("sap.ui.core.Fragment")&&(j!=="FragmentDefinition"||e.namespaceURI!==s)){p1=e.ownerDocument.createElementNS(s,"FragmentDefinition");}if(p1){var q1=e.parentNode;if(q1){q1.replaceChild(p1,e);}p1.appendChild(e);}return p1;}function h1(e,j){var a1=false,p1=K.sViewName||K._sFragmentName,q1,r1;if(!p1){var s1=K;var t1=0;while(++t1<1000&&s1&&s1!==s1._oContainingView){s1=s1._oContainingView;}p1=s1.sViewName;}q1=g1(e);if(q1){e=q1;a1=true;}r1=m(e);if(K.isA("sap.ui.core.mvc.XMLView")){if((r1!=="View"&&r1!=="XMLView")||e.namespaceURI!==t){L.error("XMLView's root node must be 'View' or 'XMLView' and have the namespace 'sap.ui.core.mvc'"+(p1?" (View name: "+p1+")":""));}Z=j.then(function(){return l1(e,K.getMetadata().getClass(),j,null,{rootArea:true,rootNode:true});});}else{var u1=A(Q,function(e,v1,w1){if(v1.nodeType===1){return j1(v1,w1.chain,null,undefined,{rootArea:true});}});Z=j.then(function(){return u1(e,{chain:j});});}return a1;}function i1(e,j){var p1;var q1=sap.ui.getCore().getLoadedLibraries();q.each(q1,function(u1,v1){if(e===v1.namespace||e===v1.name){p1=v1.name+"."+((v1.tagNames&&v1.tagNames[j])||j);}});p1=p1||e+"."+j;function r1(t1){if(!t1){L.error("Control '"+p1+"' did not return a class definition from sap.ui.define.","","XMLTemplateProcessor");t1=O.get(p1);}if(!t1){L.error("Can't find object class '"+p1+"' for XML-view","","XMLTemplateProcessor");}return t1;}var s1=p1.replace(/\./g,"/");var t1=sap.ui.require(s1);if(!t1){if(Q){return new Promise(function(u1,v1){sap.ui.require([s1],function(t1){t1=r1(t1);u1(t1);},v1);});}else{t1=sap.ui.requireSync(s1);t1=r1(t1);}}return t1;}function j1(e,j,p1,q1,r1){var s1=r1&&r1.rootArea,t1=r1&&r1.rootNode&&K.isSubView(),u1=m(e),v1=s1&&(K.isA("sap.ui.core.Fragment")||(q1&&q1.name==="content")),w1,i;if(e.nodeType===1){if(e.namespaceURI===n||e.namespaceURI===r){if(s1){if(q1&&q1.name!=="content"){L.error(f1(e,"XHTML nodes can only be added to the 'content' aggregation and not to the '"+q1.name+"' aggregation."));return d.resolve([]);}if(r1&&r1.contentBound){throw new Error(f1(e,"No XHTML or SVG node is allowed because the 'content' aggregation is bound."));}var x1=e.namespaceURI===n;var y1=e.getAttribute("id");if(y1!=null){y1=n1(K,e);}else{y1=t1?K.getId():undefined;}if(u1==="style"){var z1=e.attributes;var A1=e.textContent;e=document.createElement(u1);e.textContent=A1;for(i=0;i<z1.length;i++){var B1=z1[i];if(!B1.prefix){e.setAttribute(B1.name,B1.value);}}if(y1!=null){e.setAttribute("id",y1);}if(t1){e.setAttribute("data-sap-ui-preserve",K.getId());}$.unsafeHtml(e.outerHTML);return d.resolve([]);}var C1=z.test(u1);if(C1){$.voidStart(u1,y1);}else{$.openStart(u1,y1);}for(i=0;i<e.attributes.length;i++){var D1=e.attributes[i];if(D1.name!=="id"){$.attr(x1?D1.name.toLowerCase():D1.name,D1.value);}}if(t1){$.attr("data-sap-ui-preserve",K.getId());}if(C1){$.voidEnd();if(e.firstChild){L.error("Content of void HTML element '"+u1+"' will be ignored");}}else{$.openEnd();var E1=e instanceof HTMLTemplateElement?e.content:e;var F1=A(Q,function(e,G1,I1){return j1(G1,I1.chain,I1.closestBinding,I1.aggregation,I1.config);});w1=F1(E1,{chain:j,closestBinding:p1,aggregation:q1,config:{rootArea:s1}});return w1.then(function(G1){$.close(u1);return G1.reduce(function(I1,J1){if(Array.isArray(J1)){J1.forEach(function(K1){I1.push(K1);});}return I1;},[]);});}}else{var id=e.attributes['id']?e.attributes['id'].textContent||e.attributes['id'].text:null;if(N){return B.enrichTemplateIdsPromise(e,K,Q).then(function(){return[];});}else{var H1=function(G1){var I1={id:id?n1(K,e,id):undefined,xmlNode:e,containingView:K._oContainingView,processingMode:K._sProcessingMode};if(K.fnScopedRunWithOwner){return K.fnScopedRunWithOwner(function(){return new G1(I1);});}return new G1(I1);};return j.then(function(){if(Q){return new Promise(function(I1,J1){sap.ui.require(["sap/ui/core/mvc/XMLView"],function(G1){I1([H1(G1)]);},J1);});}else{var G1=sap.ui.requireSync("sap/ui/core/mvc/XMLView");return[H1(G1)];}});}}}else{w1=k1(e,j,p1);if(v1){$.renderControl(w1);}return w1;}}else if(e.nodeType===3&&v1){if(!r1||!r1.contentBound){$.text(e.textContent);}else if(e.textContent.trim()){throw new Error(f1(e,"Text node isn't allowed because the 'content' aggregation is bound."));}}return d.resolve([]);}function k1(e,j,p1){if(m(e)==="ExtensionPoint"&&e.namespaceURI===s){if(N){return d.resolve([]);}else{var q1=K instanceof V?K._oContainingView:K;var r1=c._factory.bind(null,q1,e.getAttribute("name"),function(){var x1=d.resolve();var y1=[];var z1=e.childNodes;for(var i=0;i<z1.length;i++){var A1=z1[i];if(A1.nodeType===1){x1=x1.then(j1.bind(null,A1,j,p1));y1.push(x1);}}return d.all(y1).then(function(B1){var C1=[];B1.forEach(function(D1){C1=C1.concat(D1);});return C1;});},undefined,undefined,Q);return d.resolve(K.fnScopedRunWithOwner?K.fnScopedRunWithOwner(r1):r1());}}else{var s1=m(e);var t1=s1;var u1=s1.lastIndexOf(".");if(u1>=0){t1=s1.substring(u1+1,s1.length);}if(/^[a-z].*/.test(t1)){var v1=K.sViewName||K._sFragmentName||K.getId();L.warning("View or Fragment '"+v1+"' contains a Control tag that starts with lower case '"+t1+"'",K.getId(),"sap.ui.core.XMLTemplateProcessor#lowerCase");}var w1=i1(e.namespaceURI,s1);if(w1&&typeof w1.then==='function'){return w1.then(function(x1){return l1(e,x1,j,p1);});}else{return l1(e,w1,j,p1);}}}function l1(p1,q1,r1,s1,t1){var ns=p1.namespaceURI,v1={},w1={},x1="",y1=[],z1=null,A1=null,B1=p1.getAttribute("stashed")==="true",C1=t1&&t1.rootArea,D1=t1&&t1.rootNode,E1;if(!N){p1.removeAttribute("stashed");}if(!q1){return d.resolve([]);}if(D1){v1.id=K.getId();}var F1=q1.getMetadata();var G1=F1.getAllSettings();var H1=!C1?G(p1,Q):undefined;if(H1){r1=d.all([r1,H1]).then(function(e){return Object.assign({},e[0],e[1]);});}r1=r1.then(function(j){if(k(j)){j=null;}E1=j;if(!N){for(var i=0;i<p1.attributes.length;i++){var u1=p1.attributes[i],M1=u1.name,N1=u1.namespaceURI,O1=G1[M1],P1=u1.value;if(D1&&y.includes(M1)){continue;}if(M1==="id"&&!D1){v1[M1]=n1(K,p1,P1);}else if(M1==="class"){x1+=P1;}else if(M1==="viewName"){v1[M1]=P1;}else if(M1==="fragmentName"){v1[M1]=P1;v1['containingView']=K._oContainingView;}else if((M1==="binding"&&!O1)||M1==='objectBindings'){if(!B1){var Q1=M.bindingParser(P1,K._oContainingView.oController);if(Q1){v1.objectBindings=v1.objectBindings||{};v1.objectBindings[Q1.model||undefined]=Q1;}}}else if(M1==='metadataContexts'){if(!B1){var R1=null;try{R1=B._calculatedModelMapping(P1,K._oContainingView.oController,true);}catch(e){L.error(K+":"+e.message);}if(R1){v1.metadataContexts=R1;if(B._preprocessMetadataContexts){B._preprocessMetadataContexts(q1.getMetadata().getName(),v1,K._oContainingView.oController);}}}}else if(M1.indexOf(":")>-1){N1=u1.namespaceURI;if(N1===u){var S1=m(u1);y1.push(new C({key:S1,value:l("any",P1,S1,K._oContainingView.oController,j)}));}else if(N1===w){A1=P1;}else if(N1&&N1.startsWith(P)){L.debug(K+": XMLView parser ignored preprocessor attribute '"+M1+"' (value: '"+P1+"')");}else if(N1===U&&m(u1)==="invisible"){O1=G1.visible;if(O1&&O1._iKind===0&&O1.type==="boolean"){v1.visible=false;}}else if(N1===s||N1===U||M1.startsWith("xmlns:")){}else{if(!z1){z1={};}if(!z1.hasOwnProperty(u1.namespaceURI)){z1[u1.namespaceURI]={};}z1[u1.namespaceURI][m(u1)]=u1.nodeValue;L.debug(K+": XMLView parser encountered unknown attribute '"+M1+"' (value: '"+P1+"') with unknown namespace, stored as sap-ui-custom-settings of customData");}}else if(O1&&O1._iKind===0){v1[M1]=l(O1.type,P1,M1,K._oContainingView.oController,j);}else if(O1&&O1._iKind===1&&O1.altTypes){if(!B1){v1[M1]=l(O1.altTypes[0],P1,M1,K._oContainingView.oController,j);}}else if(O1&&O1._iKind===2){if(!B1){var Q1=M.bindingParser(P1,K._oContainingView.oController,false,false,false,false,j);if(Q1){v1[M1]=Q1;}else{L.error(K+": aggregations with cardinality 0..n only allow binding paths as attribute value (wrong value: "+M1+"='"+P1+"')");}}}else if(O1&&O1._iKind===3){if(!B1){v1[M1]=e1(P1);}}else if(O1&&O1._iKind===4){if(!B1){v1[M1]=P1.split(/[\s,]+/g).filter(d1).map(e1);}}else if(O1&&O1._iKind===5){if(!B1){var T1=[];E.parse(P1).forEach(function(U1){var V1=E.resolveEventHandler(U1,K._oContainingView.oController,j);if(V1){T1.push(V1);}else{L.warning(K+": event handler function \""+U1+"\" is not a function or does not exist in the controller.");}});if(T1.length){v1[M1]=T1;}}}else if(O1&&O1._iKind===-1){if(F1.isA("sap.ui.core.mvc.View")&&M1=="async"){v1[M1]=l(O1.type,P1,M1,K._oContainingView.oController,j);}else{L.warning(K+": setting '"+M1+"' for class "+F1.getName()+" (value:'"+P1+"') is not supported");}}else{f(M1==='xmlns',K+": encountered unknown setting '"+M1+"' for class "+F1.getName()+" (value:'"+P1+"')");if(B._supportInfo){B._supportInfo({context:p1,env:{caller:"createRegularControls",error:true,info:"unknown setting '"+M1+"' for class "+F1.getName()}});}}}if(z1){y1.push(new C({key:"sap-ui-custom-settings",value:z1}));}if(y1.length>0){v1.customData=y1;}}return j;}).catch(function(e){if(!e.isEnriched){e=new Error(f1(p1,e));e.isEnriched=true;L.error(e);}if(Q&&K._sProcessingMode!==X.SequentialLegacy){throw e;}});var I1=A(Q,J1);function J1(p1,e,u1){var K1=u1.aggregation,L1=u1.allAggregations,r1=u1.chain,s1=u1.closestBinding,t1=u1.config,M1,N1;if(e.nodeType===1){if(e.namespaceURI===x){v1[m(e)]=e.querySelector("*");return undefined;}M1=e.namespaceURI===ns&&L1&&L1[m(e)];if(M1){return I1(e,{aggregation:M1,allAggregations:null,chain:r1,closestBinding:s1,config:t1});}else if(K1){if(e.getAttribute("stashed")==="true"&&!N){var O1=e;e=e.cloneNode();O1.removeAttribute("stashed");N1=function(){var j=n1(K,e);S.createStashedControl({wrapperId:j,fnCreate:function(){var Q1=Q;Q=false;try{return J1(p1,O1,{aggregation:K1,allAggregations:L1,chain:d.resolve(E1),closestBinding:s1}).unwrap();}finally{Q=Q1;}}});};if(K.fnScopedRunWithOwner){K.fnScopedRunWithOwner(N1);}else{N1();}e.removeAttribute("visible");m1(e,"invisible");}if(v1[K1.name]&&typeof v1[K1.name].path==="string"){s1={aggregation:K1.name,id:v1.id};if(D1&&K1.name==="content"){t1=t1||{};t1.contentBound=true;}}return j1(e,r1,s1,K1,t1).then(function(Q1){for(var j=0;j<Q1.length;j++){var R1=Q1[j];var S1=K1.name;if(R1._isExtensionPoint){if(!v1[S1]){v1[S1]=[];}var T1=w1[S1];if(!T1){T1=w1[S1]=[];}R1.index=v1[S1].length;R1.aggregationName=S1;R1.closestAggregationBindingCarrier=s1&&s1.id;R1.closestAggregationBinding=s1&&s1.aggregation;var U1=T1[T1.length-1];if(U1){U1._nextSibling=R1;}T1.push(R1);}else if(K1.multiple){if(!v1[S1]){v1[S1]=[];}if(typeof v1[S1].path==="string"){f(!v1[S1].template,"list bindings support only a single template object");v1[S1].template=R1;}else{v1[S1].push(R1);}}else{f(!v1[S1],"multiple aggregates defined for aggregation with cardinality 0..1");v1[S1]=R1;}}return Q1;});}else{throw new Error(f1(e,"Cannot add direct child without default aggregation defined for control "+F1.getElementName()));}}else if(e.nodeType===3){if(t1&&t1.rootArea){j1(e,r1,s1,K1,t1);}else{var P1=e.textContent||e.text;if(P1&&P1.trim()){throw new Error(f1(e,"Cannot add text nodes as direct child of an aggregation. For adding text to an aggregation, a surrounding html tag is needed."));}}}}var K1=F1.getDefaultAggregation();var L1=F1.getAllAggregations();return I1(p1,{aggregation:K1,allAggregations:L1,chain:r1,closestBinding:s1,config:t1}).then(function(){var e;var j=d.resolve();var u1=d.resolve();var M1=p1.getAttribute("type");var N1=a.getOwnerComponentFor(K);var O1=N1&&N1.isA("sap.ui.core.IAsyncContentCreation");if(N){if(!C1&&p1.hasAttribute("id")){o1(K,p1);}}else if(!D1&&q1.getMetadata().isA("sap.ui.core.mvc.View")){var P1=function(){if(!q1._sType&&!v1.viewName){v1.viewName="module:"+q1.getMetadata().getName().replace(/\./g,"/");}if(O1&&Q){if(v1.async===false){throw new Error("A nested view contained in a Component implementing 'sap.ui.core.IAsyncContentCreation' is processed asynchronously by default and cannot be processed synchronously.\n"+"Affected Component '"+N1.getMetadata().getComponentName()+"' and View '"+v1.viewName+"'.");}v1.type=q1._sType||M1;u1=V.create(v1);}else{if(q1.getMetadata().isA("sap.ui.core.mvc.XMLView")&&K._sProcessingMode){v1.processingMode=K._sProcessingMode;}return V._create(v1,undefined,q1._sType||M1);}};if(K.fnScopedRunWithOwner){e=K.fnScopedRunWithOwner(P1);}else{e=P1();}}else if(q1.getMetadata().isA("sap.ui.core.Fragment")&&Q){if(M1!==b.JS){v1.processingMode=K._sProcessingMode;}var Q1="sap/ui/core/Fragment";var R1=sap.ui.require(Q1);v1.name=v1.name||v1.fragmentName;if(R1){u1=R1.load(v1);}else{u1=new Promise(function(T1,U1){sap.ui.require([Q1],function(R1){R1.load(v1).then(function(V1){T1(V1);});},U1);});}}else{var S1=function(){var T1;if(D1){T1=K;if(!Q){if(R&&R.settings){Object.keys(v1).forEach(function(U1){if(R.settings.hasOwnProperty(U1)){R.settings[U1]=v1[U1];delete v1[U1];}});}}K.applySettings(v1);}else if(K.fnScopedRunWithOwner){T1=K.fnScopedRunWithOwner(function(){var T1=new q1(v1);return T1;});}else{T1=new q1(v1);}j=T(Q,T1,w1);return T1;};if(R&&R.fnRunWithPreprocessor){e=R.fnRunWithPreprocessor(S1);}else{e=S1();}}return u1.then(function(T1){return T1||e;}).then(function(T1){if(x1&&T1.addStyleClass){T1.addStyleClass(x1);}if(!T1){T1=[];}else if(!Array.isArray(T1)){T1=[T1];}if(B._supportInfo&&T1){for(var i=0,U1=T1.length;i<U1;i++){var V1=T1[i];if(V1&&V1.getId()){var W1=B._supportInfo({context:p1,env:{caller:"createRegularControls",nodeid:p1.getAttribute("id"),controlid:V1.getId()}}),X1=A1?A1+",":"";X1+=W1;B._supportInfo.addSupportInfo(V1.getId(),X1);}}}if(_){T1.forEach(function(V1){if(F1.getCompositeAggregationName){var Y1=p1.getElementsByTagName(V1.getMetadata().getCompositeAggregationName());for(var i=0;i<Y1.length;i++){p1.removeChild(Y1[0]);}}V1._sapui_declarativeSourceInfo={xmlNode:p1,xmlRootNode:K._sapui_declarativeSourceInfo.xmlRootNode,fragmentName:F1.getName()==='sap.ui.core.Fragment'?v1['fragmentName']:null};});}return j.then(function(){return T1;});});});}function m1(e,j){var p1=H(e,U,Y);e.setAttributeNS(U,p1+":"+j,"true");}function n1(K,p,e){if(p.getAttributeNS(U,"id")){return p.getAttribute("id");}else{return e1(e?e:p.getAttribute("id"));}}function o1(K,p){p.setAttribute("id",e1(p.getAttribute("id")));m1(p,"id");}}B._preprocessMetadataContexts=null;B._calculatedModelMapping=function(e,j,p){var K,N={},Q=M.bindingParser(e,j);function R(W){if(W.length%2===0){throw new Error("The last entry is no binding");}for(var i=1;i<=W.length;i=i+2){if(typeof W[i-1]=='string'){throw new Error("Binding expected not a string");}if(W[i]){if((typeof W[i]!='string')||(W[i]!=",")){throw new Error("Missing delimiter ','");}}}}if(Q){if(!Q.formatter){K=Q;Q={parts:[K]};}else{R(Q.formatter.textFragments);}for(var i=0;i<Q.parts.length;i++){K=Q.parts[i];N[K.model]=N[K.model]||(p?[]:null);if(Array.isArray(N[K.model])){N[K.model].push(K);}else{N[K.model]=K;}}}return N;};return B;},true);
