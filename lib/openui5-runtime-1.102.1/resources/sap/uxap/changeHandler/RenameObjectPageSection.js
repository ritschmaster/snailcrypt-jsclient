/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/fl/Utils","sap/base/Log","sap/ui/fl/changeHandler/BaseRename"],function(U,L,B){"use strict";var r={propertyName:"title",changePropertyName:"newText",translationTextType:"XGRP"};var R=B.createRenameChangeHandler(r);R._getControlForRename=function(c,m){var s,t;return Promise.resolve().then(function(){return m.getAggregation(c,"subSections");}).then(function(S){s=S;if(s.length!==1){return[];}return Promise.all([m.getPropertyBindingOrProperty(s[0],"title"),m.getProperty(m.getParent(c),"subSectionLayout")]);}).then(function(p){t=p[0];if(s&&s.length===1&&t&&(typeof t==="object")||(typeof t==="string"&&t.trim()!=="")&&p[1]==="TitleOnTop"){return s[0];}return c;});};R.applyChange=function(c,C,p){var m=p.modifier;var P=r.propertyName;var o=c.getDefinition();var t=o.texts[r.changePropertyName];var v=t.value;return R._getControlForRename(C,m).then(function(a){if(typeof v==="string"&&v.trim()===""){throw new Error("Change cannot be applied as ObjectPageSubSection's title cannot be empty: ["+o.layer+"]"+o.namespace+"/"+o.fileName+"."+o.fileType);}if(o.texts&&t&&typeof(v)==="string"){return Promise.resolve().then(function(){return m.getPropertyBindingOrProperty(a,P);}).then(function(b){c.setRevertData(b);m.setPropertyBindingOrProperty(a,P,v);return true;});}else{L.error("Change does not contain sufficient information to be applied: ["+o.layer+"]"+o.namespace+"/"+o.fileName+"."+o.fileType);}});};R.revertChange=function(c,C,p){var o=c.getRevertData(),m=p.modifier,P=r.propertyName;return R._getControlForRename(C,m).then(function(a){if(o||o===""){m.setPropertyBindingOrProperty(a,P,o);c.resetRevertData();return true;}else{L.error("Change doesn't contain sufficient information to be reverted. Most Likely the Change didn't go through applyChange.");}});};return R;},true);
