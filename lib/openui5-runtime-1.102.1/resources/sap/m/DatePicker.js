/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['sap/ui/thirdparty/jquery','sap/ui/Device',"sap/ui/core/Element","sap/ui/core/format/TimezoneUtil","sap/ui/core/format/DateFormat",'./InputBase','./DateTimeField','./Button','./ResponsivePopover',"./ValueStateHeader",'sap/ui/core/date/UniversalDate','./library','sap/ui/core/Control','sap/ui/core/library',"./DatePickerRenderer","sap/base/util/deepEqual","sap/base/assert","sap/base/Log","sap/ui/core/IconPool","./InstanceManager","sap/ui/unified/Calendar","sap/ui/unified/DateRange",'sap/ui/unified/DateTypeRange',"sap/ui/unified/calendar/CustomMonthPicker","sap/ui/unified/calendar/CustomYearPicker","sap/ui/core/LabelEnablement","sap/ui/unified/library","sap/ui/dom/jquery/cursorPos"],function(q,D,E,T,a,I,b,B,R,V,U,l,C,c,d,e,f,L,g,h,j,k,m,n,o,p,u){"use strict";var r=c.CalendarType;var s=sap.ui.getCore().getLibraryResourceBundle("sap.m");var t=b.extend("sap.m.DatePicker",{metadata:{library:"sap.m",properties:{displayFormatType:{type:"string",group:"Appearance",defaultValue:""},secondaryCalendarType:{type:"sap.ui.core.CalendarType",group:"Appearance",defaultValue:null},minDate:{type:"object",group:"Misc",defaultValue:null},maxDate:{type:"object",group:"Misc",defaultValue:null},showFooter:{type:"boolean",group:"Misc",defaultValue:false},showCurrentDateButton:{type:"boolean",group:"Behavior",defaultValue:false},hideInput:{type:"boolean",group:"Misc",defaultValue:false}},aggregations:{specialDates:{type:"sap.ui.core.Element",multiple:true,singularName:"specialDate"},_popup:{type:"sap.m.ResponsivePopover",multiple:false,visibility:"hidden"}},associations:{legend:{type:"sap.ui.core.Control",multiple:false}},events:{navigate:{parameters:{dateRange:{type:"sap.ui.unified.DateRange"},afterPopupOpened:{type:"boolean"}}},afterValueHelpOpen:{},afterValueHelpClose:{}},designtime:"sap/m/designtime/DatePicker.designtime",dnd:{draggable:false,droppable:true}}});t.prototype.init=function(){b.prototype.init.apply(this,arguments);this._bIntervalSelection=false;this._bOnlyCalendar=true;this._bValid=true;this._oMinDate=new Date(1,0,1);this._oMinDate.setFullYear(1);this._oMaxDate=new Date(9999,11,31,23,59,59,999);var i=this.addEndIcon({id:this.getId()+"-icon",src:this.getIconSrc(),noTabStop:true,tooltip:s.getText("OPEN_PICKER_TEXT")});this._bShouldClosePicker=false;i.addEventDelegate({onmousedown:function(F){this._bShouldClosePicker=!!this.isOpen();}},this);i.attachPress(function(){this.toggleOpen(this._bShouldClosePicker);},this);};t.prototype.isValidValue=function(){return this._bValid;};t.prototype.isOpen=function(){return this._oPopup&&this._oPopup.isOpen();};t.prototype.toggleOpen=function(O){if(this.getEditable()&&this.getEnabled()){if(O){v.call(this);}else{_.call(this);}}};t.prototype.getIconSrc=function(){return g.getIconURI("appointment-2");};t.prototype.exit=function(){I.prototype.exit.apply(this,arguments);if(this._oPopup){if(this._oPopup.isOpen()){this._oPopup.close();}delete this._oPopup;}if(this._getCalendar()){if(this._oCalendarAfterRenderDelegate){this._getCalendar().removeDelegate(this._oCalendarAfterRenderDelegate);}this._getCalendar().destroy();delete this._getCalendar();}if(this._iInvalidateCalendar){clearTimeout(this._iInvalidateCalendar);}this._sUsedDisplayPattern=undefined;this._sUsedDisplayCalendarType=undefined;this._oDisplayFormat=undefined;this._sUsedValuePattern=undefined;this._sUsedValueCalendarType=undefined;this._oValueFormat=undefined;};t.prototype.invalidate=function(O){if(!O||O!=this._getCalendar()){C.prototype.invalidate.apply(this,arguments);this._iInvalidateCalendar=setTimeout(A.bind(this),0);}};t.prototype.onBeforeRendering=function(){b.prototype.onBeforeRendering.apply(this,arguments);this._checkMinMaxDate();var i=this._getValueHelpIcon();if(i){i.setProperty("visible",this.getEditable(),true);}};t.prototype.setDisplayFormat=function(i){this.setProperty("displayFormat",i);if(this._oCalendar){this._oCalendar.removeDelegate(this._oCalendarAfterRenderDelegate);this._oCalendar.destroy();this._oCalendar=null;this._createPopupContent();}return this;};t.prototype.setWidth=function(W){return I.prototype.setWidth.call(this,W||"100%");};t.prototype.getWidth=function(W){return this.getProperty("width")||"100%";};t.prototype.applyFocusInfo=function(F){this._bFocusNoPopup=true;if(!D.support.touch||D.system.desktop){I.prototype.applyFocusInfo.apply(this,arguments);}};t.prototype.onfocusin=function(i){if(!q(i.target).hasClass("sapUiIcon")){b.prototype.onfocusin.apply(this,arguments);}this._bFocusNoPopup=undefined;};t.prototype.onsapshow=function(i){this.toggleOpen(this.isOpen());i.preventDefault();};t.prototype.onsaphide=t.prototype.onsapshow;t.prototype.onsappageup=function(i){var F=this._getCalendarConstructor().getMetadata().getName();i.preventDefault();if(F!="sap.ui.unified.Calendar"){return;}this._increaseDate(1,"day");};t.prototype.onsappageupmodifiers=function(i){var F=this._getCalendarConstructor().getMetadata().getName();i.preventDefault();if(!i.ctrlKey&&i.shiftKey){if(F=="sap.ui.unified.internal.CustomYearPicker"){return;}this._increaseDate(1,"month");}else{this._increaseDate(1,"year");}};t.prototype.onsappagedown=function(i){var F=this._getCalendarConstructor().getMetadata().getName();i.preventDefault();if(F!="sap.ui.unified.Calendar"){return;}this._increaseDate(-1,"day");};t.prototype.onsappagedownmodifiers=function(i){var F=this._getCalendarConstructor().getMetadata().getName();i.preventDefault();if(!i.ctrlKey&&i.shiftKey){if(F=="sap.ui.unified.internal.CustomYearPicker"){return;}this._increaseDate(-1,"month");}else{this._increaseDate(-1,"year");}};t.prototype.onkeypress=function(i){if(!i.charCode||i.metaKey||i.ctrlKey){return;}var F=this._getFormatter(true);var G=String.fromCharCode(i.charCode);if(G&&F.sAllowedCharacters&&F.sAllowedCharacters.indexOf(G)<0){i.preventDefault();}};t.prototype._getValueHelpIcon=function(){var i=this.getAggregation("_endIcon");return i&&i[0];};t.prototype._dateValidation=function(i){this._bValid=true;if(i&&(i.getTime()<this._oMinDate.getTime()||i.getTime()>this._oMaxDate.getTime())){this._bValid=false;f(this._bValid,"Date must be in valid range");}this.setProperty("dateValue",i);return i;};t.prototype.setMinDate=function(i){if(!this._isValidDate(i)){throw new Error("Date must be a JavaScript date object; "+this);}if(e(this.getMinDate(),i)){return this;}if(i){var Y=i.getFullYear();if(Y<1||Y>9999){throw new Error("Date must be between 0001-01-01 and 9999-12-31; "+this);}this._oMinDate=new Date(i.getTime());var F=this.getDateValue();if(F&&F.getTime()<i.getTime()){this._bValid=false;this._bOutOfAllowedRange=true;L.warning("DateValue not in valid date range",this);}}else{this._oMinDate=new Date(1,0,1);this._oMinDate.setFullYear(1);}this.setProperty("minDate",i);if(this._getCalendar()){this._getCalendar().setMinDate(i);}this._oMinDate.setHours(0,0,0,0);return this;};t.prototype.setMaxDate=function(i){if(!this._isValidDate(i)){throw new Error("Date must be a JavaScript date object; "+this);}if(e(this.getMaxDate(),i)){return this;}if(i){var Y=i.getFullYear();if(Y<1||Y>9999){throw new Error("Date must be between 0001-01-01 and 9999-12-31; "+this);}this._oMaxDate=new Date(i.getTime());var F=this.getDateValue();if(F&&F.getTime()>i.getTime()){this._bValid=false;this._bOutOfAllowedRange=true;L.warning("DateValue not in valid date",this);}}else{this._oMaxDate=new Date(9999,11,31,23,59,59,999);}this.setProperty("maxDate",i);if(this._getCalendar()){this._getCalendar().setMaxDate(i);}this._oMaxDate.setHours(23,59,59,999);return this;};t.prototype.setCurrentDateButton=function(S){var i=this._getCalendar();i&&i.setCurrentDateButton(S);return this.setProperty("showCurrentDateButton",S);};t.prototype._checkMinMaxDate=function(){if(this._oMinDate.getTime()>this._oMaxDate.getTime()){L.warning("minDate > MaxDate -> dates switched",this);var M=new Date(this._oMinDate.getTime());var i=new Date(this._oMaxDate.getTime());this._oMinDate=new Date(i.getTime());this._oMaxDate=new Date(M.getTime());this.setProperty("minDate",i,true);this.setProperty("maxDate",M,true);if(this._getCalendar()){this._getCalendar().setMinDate(i);this._getCalendar().setMaxDate(M);}}var F=this.getDateValue();if(F&&(F.getTime()<this._oMinDate.getTime()||F.getTime()>this._oMaxDate.getTime())){this._bValid=false;L.error("dateValue "+F.toString()+"(value="+this.getValue()+") does not match "+"min/max date range("+this._oMinDate.toString()+" - "+this._oMaxDate.toString()+"). App. "+"developers should take care to maintain dateValue/value accordingly.",this);}};t.prototype.getDisplayFormatType=function(){return this.getProperty("displayFormatType");};t.prototype._handleDateValidation=function(i){this._bValid=true;if(!i||i.getTime()<this._oMinDate.getTime()||i.getTime()>this._oMaxDate.getTime()){this._bValid=false;L.warning("Value can not be converted to a valid date",this);}var F=this._formatValue(i,true);if(F!==this.getValue()){this.setLastValue(F);}this.setProperty("value",F);this.setProperty("dateValue",i);};t.prototype.setDisplayFormatType=function(i){if(i){var F=false;for(var G in r){if(G==i){F=true;break;}}if(!F){throw new Error(i+" is not a valid calendar type"+this);}}this.setProperty("displayFormatType",i,true);this.setDisplayFormat(this.getDisplayFormat());return this;};t.prototype.setSecondaryCalendarType=function(i){this._bSecondaryCalendarTypeSet=true;this.setProperty("secondaryCalendarType",i,true);if(this._getCalendar()){this._getCalendar().setSecondaryCalendarType(i);}return this;};t.prototype.setShowFooter=function(F){var P=this._oPopup,i=this._getCalendar();this.setProperty("showFooter",F);if(!P||!i){return this;}P._getButtonFooter().setVisible(F);return this;};t.prototype.addSpecialDate=function(S){z.call(this,S);this.addAggregation("specialDates",S,true);A.call(this);return this;};t.prototype.insertSpecialDate=function(S,i){z.call(this,S);this.insertAggregation("specialDates",S,i,true);A.call(this);return this;};t.prototype.removeSpecialDate=function(S){var i=this.removeAggregation("specialDates",S,true);A.call(this);return i;};t.prototype.removeAllSpecialDates=function(){var i=this.removeAllAggregation("specialDates",true);A.call(this);return i;};t.prototype.destroySpecialDates=function(){this.destroyAggregation("specialDates",true);A.call(this);return this;};t.prototype.setLegend=function(i){this.setAssociation("legend",i,true);var F=this.getLegend();if(F){var G=sap.ui.require("sap/ui/unified/CalendarLegend");i=sap.ui.getCore().byId(F);if(i&&!(typeof G=="function"&&i instanceof G)){throw new Error(i+" is not an sap.ui.unified.CalendarLegend. "+this);}}if(this._getCalendar()){this._getCalendar().setLegend(F);}return this;};t.prototype.onChange=function(i){if(!this.getEditable()||!this.getEnabled()){return;}var F=this._$input.val(),O=this._formatValue(this.getDateValue()),G;if(F==O&&this._bValid){return;}if(this.getShowFooter()&&this._oPopup&&!F){this._oPopup.getBeginButton().setEnabled(false);}this._bValid=true;if(F!=""){G=this._parseValue(F,true);if(!G||G.getTime()<this._oMinDate.getTime()||G.getTime()>this._oMaxDate.getTime()){this._bValid=false;G=undefined;}else{F=this._formatValue(G);}}if(this.getDomRef()&&(this._$input.val()!==F)){this._$input.val(F);this._curpos=this._$input.cursorPos();}if(G){F=this._formatValue(G,true);}if(this.getLastValue()!==F||(G&&this.getDateValue()&&G.getFullYear()!==this.getDateValue().getFullYear())){this.setLastValue(F);this.setProperty("value",F,true);var N=this.getValue();if(this._bValid&&F==N){this.setProperty("dateValue",G,true);}F=N;if(this.isOpen()){if(this._bValid){G=this.getDateValue();}this._getCalendar().focusDate(G);var S=this._oDateRange.getStartDate();if((!S&&G)||(S&&G&&S.getTime()!=G.getTime())){this._oDateRange.setStartDate(new Date(G.getTime()));}else if(S&&!G){this._oDateRange.setStartDate(undefined);}}this.fireChangeEvent(F,{valid:this._bValid});}};t.prototype._getInputValue=function(i){i=(typeof i=="undefined")?this._$input.val():i.toString();var F=this._parseValue(i,true);i=this._formatValue(F,true);return i;};t.prototype.updateDomValue=function(i){if(this.isActive()&&(this._$input.val()!==i)){this._bCheckDomValue=true;i=(typeof i=="undefined")?this._$input.val():i.toString();this._curpos=this._$input.cursorPos();var F=this._parseValue(i,true);i=this._formatValue(F);this._$input.val(i);if(document.activeElement===this._$input[0]){this._$input.cursorPos(this._curpos);}}return this;};function _(i){this._createPopup();this._createPopupContent();var F;var G=this.getBinding("value");if(G&&G.oType&&G.oType.oOutputFormat){F=G.oType.oOutputFormat.oFormatOptions.calendarType;}else if(G&&G.oType&&G.oType.oFormat){F=G.oType.oFormat.oFormatOptions.calendarType;}if(!F){F=this.getDisplayFormatType();}if(F){this._getCalendar().setPrimaryCalendarType(F);}var H=this._bValid?this._formatValue(this.getDateValue()):this.getValue();if(H!=this._$input.val()){this.onChange();}this._fillDateRange();this._openPopup(i);this.fireNavigate({dateRange:this._getVisibleDatesRange(this._getCalendar()),afterPopupOpened:true});}t.prototype._createPopup=function(){var i="";if(!this._oPopup){this._oPopup=new R(this.getId()+"-RP",{showCloseButton:false,showArrow:false,showHeader:false,placement:l.PlacementType.VerticalPreferedBottom,contentWidth:this.$().closest(".sapUiSizeCompact").length>0?"18rem":"21rem",beginButton:new B({type:l.ButtonType.Emphasized,text:s.getText("DATEPICKER_SELECTION_CONFIRM"),press:this._handleOKButton.bind(this)}),afterOpen:w.bind(this),afterClose:x.bind(this)}).addStyleClass("sapMRPCalendar");if(this.getShowFooter()){this._oPopup.addStyleClass("sapMLandscapePadding");}this._oPopup._getPopup().setAutoClose(true);if(D.system.phone){i=p.getReferencingLabels(this).concat(this.getAriaLabelledBy()).reduce(function(F,G){var H=E.registry.get(G);return F+" "+(H.getText?H.getText():"");},"").trim();this._oPopup.setTitle(i);this._oPopup.setShowHeader(true);this._oPopup.setShowCloseButton(true);}else{this._oPopup._getPopup().setDurations(0,0);this._oPopup.setEndButton(new B({text:s.getText("DATEPICKER_SELECTION_CANCEL"),press:this._handleCancelButton.bind(this)}));}this.setAggregation("_popup",this._oPopup,true);}};t.prototype._openPopup=function(i){if(!this._oPopup){return;}if(!i){i=this.getDomRef();}this._oPopup._getPopup().setExtraContent([i]);this._oPopup.openBy(i||this);};t.prototype.openBy=function(i){_.call(this,i);};t.prototype._getVisibleDatesRange=function(i){var F=i._getVisibleDays();return new k({startDate:F[0].toLocalJSDate(),endDate:F[F.length-1].toLocalJSDate()});};t.prototype._createPopupContent=function(){var i=this._getCalendarConstructor();if(!this._getCalendar()){this._oCalendar=new i(this.getId()+"-cal",{intervalSelection:this._bIntervalSelection,minDate:this.getMinDate(),maxDate:this.getMaxDate(),legend:this.getLegend(),startDateChange:function(){this.fireNavigate({dateRange:this._getVisibleDatesRange(this._getCalendar())});}.bind(this)});this._oCalendar.setShowCurrentDateButton(this.getShowCurrentDateButton());this._oDateRange=new k();this._getCalendar().addSelectedDate(this._oDateRange);this._getCalendar()._setSpecialDatesControlOrigin(this);this._getCalendar().attachCancel(v,this);if(this.$().closest(".sapUiSizeCompact").length>0){this._getCalendar().addStyleClass("sapUiSizeCompact");}if(this._bSecondaryCalendarTypeSet){this._getCalendar().setSecondaryCalendarType(this.getSecondaryCalendarType());}if(this._bOnlyCalendar){this._getCalendar().attachSelect(this._handleCalendarSelect,this);this._getCalendar().attachEvent("_renderMonth",y,this);this._oPopup._getButtonFooter().setVisible(this.getShowFooter());this._getCalendar()._bSkipCancelButtonRendering=true;if(!this._oPopup.getContent().length){var H=this._getValueStateHeader();this._oPopup.addContent(this._getValueStateHeader());H.setPopup(this._oPopup._oControl);}this._oPopup.addContent(this._getCalendar());if(!this.getDateValue()){this._oPopup.getBeginButton().setEnabled(false);}}this._attachAfterRenderingDelegate();}};t.prototype._attachAfterRenderingDelegate=function(){this._oCalendarAfterRenderDelegate={onAfterRendering:function(){var P=this._oPopup&&this._oPopup._getPopup();P&&P._oLastPosition&&P._applyPosition(P._oLastPosition);if(this._oPopup.isOpen()){this._oCalendar.focus();}}.bind(this)};this._oCalendar.addDelegate(this._oCalendarAfterRenderDelegate);};t.prototype._getCalendarConstructor=function(){var P=this._getFormatter(true).aFormatArray.map(function(F){return F.type.toLowerCase();}),i=P.indexOf("day")>=0,M=P.indexOf("month")>=0||P.indexOf("monthstandalone")>=0,Y=P.indexOf("year")>=0;if(i&&M&&Y){return j;}else if(M&&Y){return n;}else if(Y){return o;}else{L.warning("Not valid date pattern! Default Calendar constructor function is returned",this);return j;}};t.prototype._fillDateRange=function(){var F;var i=this.getDateValue();if(i&&i.getTime()>=this._oMinDate.getTime()&&i.getTime()<=this._oMaxDate.getTime()){F=this._getPickerParser().format(i,this._getTimezone(true));i=this._getPickerParser().parse(F,T.getLocalTimezone())[0];this._getCalendar().focusDate(new Date(i.getTime()));if(!this._oDateRange.getStartDate()||this._oDateRange.getStartDate().getTime()!=i.getTime()){this._oDateRange.setStartDate(new Date(i.getTime()));}}else{var G=this.getInitialFocusedDateValue();var H=G?G:new Date();F=this._getPickerParser().format(H,this._getTimezone(true));H=this._getPickerParser().parse(F,T.getLocalTimezone())[0];if(H.getTime()<this._oMinDate.getTime()){H=this._oMinDate;}else if(H.getTime()>this._oMaxDate.getTime()){H=this._oMaxDate;}this._getCalendar().focusDate(H);if(this._oDateRange.getStartDate()){this._oDateRange.setStartDate(undefined);}}};t.prototype.getAccessibilityInfo=function(){var i=this.getRenderer();var F=I.prototype.getAccessibilityInfo.apply(this,arguments);var G=this.getValue()||"";if(this._bValid){var H=this.getDateValue();if(H){G=this._formatValue(H);}}F.type=s.getText("ACC_CTR_TYPE_DATEINPUT");F.description=[G,i.getLabelledByAnnouncement(this),i.getDescribedByAnnouncement(this)].join(" ").trim();return F;};t.prototype._selectDate=function(){var i=this.getDateValue(),F=this._getSelectedDate(),G="";var H=this._getPickerParser().format(F,T.getLocalTimezone());var P=this._getPickerParser().parse(H,this._getTimezone(true));F=P&&P[0];if(!e(F,i)){this.setDateValue(new Date(F.getTime()));G=this.getValue();this.fireChangeEvent(G,{valid:true});this._focusInput();}else if(!this._bValid){G=this._formatValue(F);if(G!=this._$input.val()){this._bValid=true;if(this.getDomRef()){this._$input.val(G);this.setLastValue(G);}G=this._formatValue(F,true);this.setProperty("value",G,true);this.fireChangeEvent(G,{valid:true});this._focusInput();}}else if(D.system.desktop||!D.support.touch){this.focus();}this._oPopup.close();};t.prototype._handleCalendarSelect=function(){if(this.getShowFooter()){this._oPopup.getBeginButton().setEnabled(true);return;}this._selectDate();};t.prototype._getTimezone=function(i){return sap.ui.getCore().getConfiguration().getTimezone();};t.prototype._focusInput=function(){if(this.getDomRef()&&(D.system.desktop||!D.support.touch)){this._curpos=this._$input.val().length;this._$input.cursorPos(this._curpos);}return this;};t.prototype._getCalendar=function(){return this._oCalendar;};t.prototype._getSelectedDate=function(){var S=this._getCalendar().getSelectedDates(),i;if(S.length>0){i=S[0].getStartDate();}return i;};t.prototype._handleOKButton=function(){this._selectDate();};t.prototype._handleCancelButton=function(){if(!this.getDateValue()){this._oPopup.getBeginButton().setEnabled(false);}this._oPopup.close();};function v(i){if(this.isOpen()){this._oPopup.close();if((D.system.desktop||!D.support.touch)){this.focus();}}}t.prototype._increaseDate=function(N,i){var O=this.getDateValue();var F=this._$input.cursorPos();if(O&&this.getEditable()&&this.getEnabled()){var G;var H=this.getBinding("value");if(H&&H.oType&&H.oType.oOutputFormat){G=H.oType.oOutputFormat.oFormatOptions.calendarType;}else if(H&&H.oType&&H.oType.oFormat){G=H.oType.oFormat.oFormatOptions.calendarType;}if(!G){G=this.getDisplayFormatType();}var J=U.getInstance(new Date(O.getTime()),G);O=U.getInstance(new Date(O.getTime()),G);switch(i){case"day":J.setDate(J.getDate()+N);break;case"month":J.setMonth(J.getMonth()+N);var M=(O.getMonth()+N)%12;if(M<0){M=12+M;}while(J.getMonth()!=M){J.setDate(J.getDate()-1);}break;case"year":J.setFullYear(J.getFullYear()+N);while(J.getMonth()!=O.getMonth()){J.setDate(J.getDate()-1);}break;default:break;}if(J.getTime()<this._oMinDate.getTime()){J=new U(this._oMinDate.getTime());}else if(J.getTime()>this._oMaxDate.getTime()){J=new U(this._oMaxDate.getTime());}if(!e(this.getDateValue(),J.getJSDate())){this.setDateValue(new Date(J.getTime()));this._curpos=F;this._$input.cursorPos(this._curpos);var K=this.getValue();this.fireChangeEvent(K,{valid:true});}}};t.prototype._getSpecialDates=function(){var F=this.getSpecialDates();for(var i=0;i<F.length;i++){var N=F[i].getSecondaryType()===u.CalendarDayType.NonWorking&&F[i].getType()!==u.CalendarDayType.NonWorking;if(N){var G=new m();G.setType(F[i].getSecondaryType());G.setStartDate(F[i].getStartDate());if(F[i].getEndDate()){G.setEndDate(F[i].getEndDate());}F.push(G);}}return F;};function w(){this.addStyleClass(I.ICON_PRESSED_CSS_CLASS);this._renderedDays=this._getCalendar().$("-Month0-days").find(".sapUiCalItem").length;this.$("inner").attr("aria-owns",this.getId()+"-cal");h.addPopoverInstance(this._oPopup);this._oCalendar.focus();this.fireAfterValueHelpOpen();}function x(){if(!this.getDateValue()){this._oPopup.getBeginButton().setEnabled(false);}this.removeStyleClass(I.ICON_PRESSED_CSS_CLASS);this._getCalendar()._closePickers();h.removePopoverInstance(this._oPopup);this.fireAfterValueHelpClose();}function y(i){var F=i.getParameter("days"),P=this._oPopup._getPopup();if(F>this._renderedDays){this._renderedDays=F;P._applyPosition(P._oLastPosition);}}function z(S){var m=sap.ui.require("sap/ui/unified/DateTypeRange");if(S&&!(m&&S instanceof m)){throw new Error(S+"is not valid for aggregation \"specialDates\" of "+this);}}function A(){if(this.isOpen()){this._getCalendar()._bDateRangeChanged=false;this._getCalendar().invalidate();}}t.prototype._getPickerParser=function(){if(!this._calendarParser){this._calendarParser=a.getDateTimeWithTimezoneInstance({showTimezone:false});}return this._calendarParser;};return t;});
