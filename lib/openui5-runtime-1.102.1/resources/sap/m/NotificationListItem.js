/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['./library','sap/ui/core/Core','./NotificationListBase','sap/ui/core/InvisibleText','sap/ui/core/library','sap/m/Link','sap/m/Avatar',"sap/ui/events/KeyCodes",'./NotificationListItemRenderer'],function(l,C,N,I,c,L,A,K,a){'use strict';var R=C.getLibraryResourceBundle('sap.m'),E=R.getText('NOTIFICATION_LIST_ITEM_SHOW_MORE'),b=R.getText('NOTIFICATION_LIST_ITEM_SHOW_LESS'),d=R.getText('NOTIFICATION_LIST_ITEM_READ'),U=R.getText('NOTIFICATION_LIST_ITEM_UNREAD');var m=44;var e=l.AvatarSize;var f=l.AvatarColor;var P=c.Priority;var g=N.extend('sap.m.NotificationListItem',{metadata:{library:'sap.m',properties:{description:{type:'string',group:'Appearance',defaultValue:''},authorInitials:{type:"string",group:"Data",defaultValue:null},truncate:{type:'boolean',group:'Appearance',defaultValue:true},hideShowMoreButton:{type:'boolean',group:'Appearance',defaultValue:false},authorAvatarColor:{type:"sap.m.AvatarColor",group:"Appearance",defaultValue:f.Accent6}},aggregations:{processingMessage:{type:'sap.m.MessageStrip',multiple:false},_showMoreButton:{type:'sap.m.Link',multiple:false,visibility:"hidden"}}}});g.prototype.init=function(){this.setType('Active');this._footerIvisibleText=new I({id:this.getId()+"-invisibleFooterText"});};g.prototype._getAuthorAvatar=function(){if(this.getAuthorInitials()||this.getAuthorPicture()){if(!this._avatar){this._avatar=new A({displaySize:e.XS});}this._avatar.setInitials(this.getAuthorInitials());this._avatar.setSrc(this.getAuthorPicture());this._avatar.setBackgroundColor(this.getAuthorAvatarColor());return this._avatar;}};g.prototype.onBeforeRendering=function(){N.prototype.onBeforeRendering.call(this);};g.prototype.onAfterRendering=function(){N.prototype.onAfterRendering.call(this);if(this.getHideShowMoreButton()){return;}this._updateShowMoreButtonVisibility();};g.prototype.onkeydown=function(h){if(h.target!==this.getDomRef()){return;}var n=this.getParent(),v,i;if(!n||!n.isA('sap.m.NotificationListGroup')){return;}v=n.getVisibleItems();i=v.indexOf(this);switch(h.which){case K.ARROW_UP:if(i===0){return;}var p=i-1;v[p].focus();break;case K.ARROW_DOWN:var j=i+1;if(j===v.length){return;}v[j].focus();break;}};g.prototype.exit=function(){N.prototype.exit.apply(this,arguments);if(this._footerIvisibleText){this._footerIvisibleText.destroy();this._footerIvisibleText=null;}if(this._avatar){this._avatar.destroy();this._avatar=null;}};g.prototype._onResize=function(){N.prototype._onResize.apply(this,arguments);this._updateShowMoreButtonVisibility();};g.prototype._updateShowMoreButtonVisibility=function(){var $=this.$(),t=$.find('.sapMNLITitleText')[0],h=$.find('.sapMNLIDescription')[0],i;if($.length>0){i=t.scrollHeight>m||h.scrollHeight>m;}this._getShowMoreButton().setVisible(i);};g.prototype._getShowMoreButton=function(){var s=this.getAggregation('_showMoreButton');if(!s){s=new L(this.getId()+'-showMoreButton',{text:this.getTruncate()?E:b,press:function(){var t=!this.getTruncate();this._getShowMoreButton().setText(t?E:b);this.setTruncate(t);}.bind(this)});this.setAggregation("_showMoreButton",s,true);}return s;};g.prototype._getFooterInvisibleText=function(){var r=this.getUnread()?U:d,h=this.getAuthorName(),i=this.getDatetime(),p=this.getPriority(),j=[r];if(h){h=R.getText('NOTIFICATION_LIST_ITEM_CREATED_BY');j.push(h);j.push(this.getAuthorName());}if(i){j.push(R.getText('NOTIFICATION_LIST_ITEM_DATETIME',[i]));}if(p!==P.None){j.push(R.getText('NOTIFICATION_LIST_ITEM_PRIORITY',[p]));}return this._footerIvisibleText.setText(j.join(' '));};return g;});
