/*
 * ! OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/m/p13n/AbstractContainer","sap/m/Bar","sap/m/Button","sap/m/List","sap/m/IconTabBar","sap/m/IconTabFilter","sap/m/p13n/AbstractContainerItem","sap/ui/Device","sap/m/library","sap/m/StandardListItem"],function(A,B,a,L,I,b,C,D,l,S){"use strict";var c=l.ButtonType;var d=l.ListType;var e=A.extend("sap.m.p13n.Container",{metadata:{library:"sap.m",properties:{listLayout:{type:"boolean",defaultValue:false}}},renderer:{apiVersion:2}});e.prototype.DEFAULT_KEY="$default";e.prototype.init=function(){A.prototype.init.apply(this,arguments);this.addStyleClass("sapMP13nContainer");this.setListLayout(D.system.phone);};e.prototype.setListLayout=function(f){this.setProperty("listLayout",f);this._getTabBar().removeAllItems();this._getNavigationList().removeAllItems();var h;if(f){this._getTabBar().setVisible(false);this._getNavigationList();this.switchView(this.DEFAULT_KEY);h=this._getNavBackBtn();}else{this._getTabBar().setVisible(true);var v=this.getViews();if(v.length>1){this.switchView(v[1].getKey());}h=this._getTabBar();}var H=this.getHeader();if(!H){var o=new B({contentLeft:[h]});this.setHeader(o);}else{H.removeAllContentLeft();H.addContentLeft(h);}this.getViews().forEach(function(V){this._addToNavigator(V);}.bind(this));return this;};e.prototype.switchView=function(k){A.prototype.switchView.apply(this,arguments);if(this._bPrevented){return;}var p=this.getParent();if(p&&p.isA("sap.ui.core.Control")){p.invalidate();var f=p.getDependents();if(f){f.forEach(function(o){if(o&&o.isA("sap.ui.core.Control")){o.invalidate();}});}}this.oLayout.setShowHeader(k!==this.DEFAULT_KEY);this.oLayout.setShowFooter(k!==this.DEFAULT_KEY);this._getTabBar().setSelectedKey(k);this._getNavBackBtn().setVisible(k!==this.DEFAULT_KEY);this._getNavBackBtn().setText((this.getView(k)&&this.getView(k).getText())||k);};e.prototype.addView=function(v){this._addToNavigator(typeof v=="string"?this.getView(v):v);A.prototype.addView.apply(this,arguments);return this;};e.prototype.removeView=function(v){this._removeFromNavigator(typeof v=="string"?this.getView(v):v);A.prototype.removeView.apply(this,arguments);return this;};e.prototype.addSeparator=function(){if(!this.getProperty("listLayout")){return;}var i=this._getNavigationList().getItems();var o=i[i.length-1];o.addStyleClass("sapMMenuDivider");return this;};e.prototype._getTabBar=function(){if(!this._oTabBar){this._oTabBar=new I({expandable:false,expanded:true,select:function(E){this.switchView(E.getParameter("key"));}.bind(this)});this.addDependent(this._oTabBar);}return this._oTabBar;};e.prototype._getNavigationList=function(){if(!this._oNavigationList){this._oNavigationList=new L({itemPress:function(E){var i=E.getParameter("listItem");this.switchView(i._key);}.bind(this)}).addStyleClass("p13nContainerDefaultList");this.addDependent(this._oNavigationList);}if(!this.getView(this.DEFAULT_KEY)){var o=new C({key:this.DEFAULT_KEY,content:this._oNavigationList});this.addView(o);}return this._oNavigationList;};e.prototype._getNavBackBtn=function(){if(!this._oNavBackBtn){this._oNavBackBtn=new a({type:c.Back,press:function(E){this.switchView(this.DEFAULT_KEY);}.bind(this)});this.addDependent(this._oNavBackBtn);}return this._oNavBackBtn;};e.prototype._addToNavigator=function(o){var k=o.getKey(),f=o.getBindingInfo("text"),t=o.getText(),i=o.getIcon();if(f&&f.parts){t={parts:f.parts};}if(k==this.DEFAULT_KEY){return;}if(this.getListLayout()){this.getView(this.DEFAULT_KEY);var g=new S({type:d.Navigation,icon:i,title:t});g._key=k;this._getNavigationList().addItem(g);}else{this._getTabBar().addItem(new b({key:k,text:t||k}));}};e.prototype._removeFromNavigator=function(o){var k=o.getKey();if(k==this.DEFAULT_KEY){return;}if(this.getListLayout()){var i=this._getNavigationList().getItems().find(function(f){return f._key===k;});this._getNavigationList().removeItem(i);}else{var t=this._getTabBar().getItems().find(function(t){return t.getKey()===k;});this._getTabBar().removeItem(t);}};e.prototype.exit=function(){A.prototype.exit.apply(this,arguments);if(this._oTabBar){this._oTabBar.destroy();this._oTabBar=null;}if(this._oNavigationList){this._oNavigationList.destroy();this._oNavigationList=null;}this._oNavBackBtn=null;};return e;});
