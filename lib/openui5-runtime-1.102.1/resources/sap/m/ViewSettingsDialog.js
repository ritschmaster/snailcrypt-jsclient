/*!
* OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
*/
sap.ui.define(['./library','sap/ui/core/Core','sap/ui/core/Control','sap/ui/core/IconPool','./Toolbar','./CheckBox','./SearchField','./List','./StandardListItem','./Dialog','./Button','./ToggleButton','./Title','./NavContainer','./Bar','./SegmentedButton','./Page','./ViewSettingsItem','sap/ui/base/ManagedObject','sap/ui/base/ManagedObjectObserver','sap/ui/base/EventProvider','sap/ui/Device','sap/ui/core/InvisibleText','./ViewSettingsDialogRenderer',"sap/m/GroupHeaderListItem","sap/base/Log","sap/ui/thirdparty/jquery","sap/ui/dom/jquery/Focusable"],function(l,C,a,I,T,b,S,L,c,D,B,d,e,N,f,g,P,V,M,h,E,m,n,o,G,p,q){"use strict";var r=l.ListMode;var s=l.ListType;var t=l.StringFilterOperator;var u=l.TitleAlignment;var v=l.ButtonType;var w="-list-item";var x=a.extend("sap.m.ViewSettingsDialog",{metadata:{library:"sap.m",properties:{title:{type:"string",group:"Behavior",defaultValue:null},sortDescending:{type:"boolean",group:"Behavior",defaultValue:false},groupDescending:{type:"boolean",group:"Behavior",defaultValue:false},filterSearchOperator:{type:"sap.m.StringFilterOperator",group:"Behavior",defaultValue:t.StartsWith},titleAlignment:{type:"sap.m.TitleAlignment",group:"Misc",defaultValue:u.Auto}},aggregations:{sortItems:{type:"sap.m.ViewSettingsItem",multiple:true,singularName:"sortItem",bindable:"bindable"},groupItems:{type:"sap.m.ViewSettingsItem",multiple:true,singularName:"groupItem",bindable:"bindable"},filterItems:{type:"sap.m.ViewSettingsItem",multiple:true,singularName:"filterItem",bindable:"bindable"},presetFilterItems:{type:"sap.m.ViewSettingsItem",multiple:true,singularName:"presetFilterItem",bindable:"bindable"},customTabs:{type:"sap.m.ViewSettingsCustomTab",multiple:true,singularName:"customTab",bindable:"bindable"}},associations:{selectedSortItem:{type:"sap.m.ViewSettingsItem",multiple:false},selectedGroupItem:{type:"sap.m.ViewSettingsItem",multiple:false},selectedPresetFilterItem:{type:"sap.m.ViewSettingsItem",multiple:false}},events:{confirm:{parameters:{sortItem:{type:"sap.m.ViewSettingsItem"},sortDescending:{type:"boolean"},groupItem:{type:"sap.m.ViewSettingsItem"},groupDescending:{type:"boolean"},presetFilterItem:{type:"sap.m.ViewSettingsItem"},filterItems:{type:"sap.m.ViewSettingsItem[]"},filterKeys:{type:"object",deprecated:true},filterCompoundKeys:{type:"object"},filterString:{type:"string"}}},cancel:{},resetFilters:{},reset:{},filterDetailPageOpened:{parameters:{parentFilterItem:{type:"sap.m.ViewSettingsFilterItem"}}}}}});x.prototype.init=function(){var j=this.getId();this._rb=C.getLibraryResourceBundle("sap.m");this._sDialogWidth="350px";this._sDialogHeight="434px";this._bAppendedToUIArea=false;this._showSubHeader=false;this._filterDetailList=undefined;this._vContentPage=-1;this._oContentItem=null;this._oPreviousState={};this._sCustomTabsButtonsIdPrefix='-custom-button-';this._sTitleLabelId=j+"-title";this._sFilterDetailTitleLabelId=j+"-detailtitle";this._oFiltersSelectedOnly={};this._oKeylessFilters={};this._aggregationToListItems("sortItems",{text:{listProp:"title"},selected:{}},{tooltip:{}},{type:s.Active},{mode:r.SingleSelectLeft,includeItemInSelection:true,selectionChange:function(k){var W=k.getParameter('listItem'),X=this.getSortItems(),Y=this._getVSItem(W),i;Y.setProperty('selected',k.getParameter('selected'),true,false);this.setAssociation('selectedSortItem',Y,true);for(i=0;i<X.length;i++){if(Y!==X[i]){X[i].setProperty('selected',false,true,false);}}this._checkResetStatus();}.bind(this)});};x.prototype.exit=function(){this._rb=null;this._sDialogWidth=null;this._sDialogHeight=null;this._bAppendedToUIArea=null;this._showSubHeader=null;this._vContentPage=null;this._oContentItem=null;this._oPreviousState=null;this._sortContent=null;this._groupContent=null;this._filterContent=null;this._sCustomTabsButtonsIdPrefix=null;this._fnFilterSearchCallback=null;this._oKeylessFilters=null;if(this._bAppendedToUIArea&&this._dialog){var i=C.getStaticAreaRef();i=C.getUIArea(i);i.removeContent(this._dialog,true);}if(this._dialog){this._dialog.destroy();this._dialog=null;}if(this._navContainer){this._navContainer.destroy();this._navContainer=null;}if(this._titleLabel){this._titleLabel.destroy();this._titleLabel=null;}if(this._page1){this._page1.destroy();this._page1=null;}if(this._header){this._header.destroy();this._header=null;}if(this._resetButton){this._resetButton.destroy();this._resetButton=null;}if(this._subHeader){this._subHeader.destroy();this._subHeader=null;}if(this._segmentedButton){this._segmentedButton.destroy();this._segmentedButton=null;}if(this._sortButton){this._sortButton.destroy();this._sortButton=null;}if(this._groupButton){this._groupButton.destroy();this._groupButton=null;}if(this._filterButton){this._filterButton.destroy();this._filterButton=null;}if(this._sortList){this._sortList.destroy();this._sortList=null;}if(this._ariaSortListInvisibleText){this._ariaSortListInvisibleText.destroy();this._ariaSortListInvisibleText=null;}if(this._sortOrderList){this._sortOrderList.destroy();this._sortOrderList=null;this._ariaSortOrderInvisibleText.destroy();this._ariaSortOrderInvisibleText=null;}if(this._oGroupingNoneItem){this._oGroupingNoneItem.destroy();this._oGroupingNoneItem=null;}if(this._groupList){this._groupList.destroy();this._groupList=null;this._ariaGroupListInvisibleText.destroy();this._ariaGroupListInvisibleText=null;}if(this._groupOrderList){this._groupOrderList.destroy();this._groupOrderList=null;this._ariaGroupOrderInvisibleText.destroy();this._ariaGroupOrderInvisibleText=null;}if(this._presetFilterList){this._presetFilterList.destroy();this._presetFilterList=null;}if(this._filterList){this._filterList.destroy();this._filterList=null;}if(this._ariaFilterByInvisibleText){this._ariaFilterByInvisibleText.destroy();this._ariaFilterByInvisibleText=null;}if(this._page2){this._page2.destroy();this._page2=null;}if(this._detailTitleLabel){this._detailTitleLabel.destroy();this._detailTitleLabel=null;}if(this._filterDetailList){this._filterDetailList.destroy();this._filterDetailList=null;}if(this._oStringFilter){this._oStringFilter=null;}if(this._oSelectedFilterKeys){this._oSelectedFilterKeys=null;}};x.prototype._aggregationToListItems=function(i,j,k,W,X){var Y=this._getListType(i),Z="_"+Y+"List";if(!this.mToList){this.mToList={};}this.mToList[Y]={"itemPropertyMap":j,"itemAggregationMap":k,"listItemOptions":W,"listOptions":X,"listName":Z};};x.prototype._getListType=function(i){return i.replace('Items','');};x.prototype._createList=function(i){var j=this.getId()+"-"+i+"list",k=new L(j,this.mToList[i].listOptions),W=this._createGroupHeaderItem(i);k.addItem(W);this[this.mToList[i].listName]=k;return k;};x.prototype._createGroupHeaderItem=function(i){return new G({title:this._rb.getText("VIEWSETTINGS_"+i.toUpperCase()+"_OBJECT")});};x.prototype._getList=function(i){if(!this.mToList||!this.mToList[i]){return;}return this[this.mToList[i].listName];};x.prototype._createListItem=function(i,j){var k=this.mToList[i].listItemOptions,W=this.mToList[i].itemPropertyMap,X=this.mToList[i].itemAggregationMap,Y,Z;for(var $ in W){if(W.hasOwnProperty($)){Y=W[$].listProp||$;k[Y]=this._createListItemPropertyValue(i,$,j);}}for(var _ in X){if(X.hasOwnProperty(_)){k[_]=j.getAggregation(_);}}Z=new c(k).data('item',j);return Z;};x.prototype._createListItemPropertyValue=function(i,j,k){var W=k.getMetadata().getAllProperties()[j].get(k),X=this.mToList[i].itemPropertyMap[j].fn;return X?X(W):W;};x.prototype._getListItem=function(i,j){var k=this._getList(i).getItems().filter(function(W){return W.data('item')===j;});return k.length?k[0]:null;};x.prototype._getVSItem=function(i){return i.data('item');};x.prototype.addCustomTab=function(i){var j=i.getId();if(j==='sort'||j==='filter'||j==='group'){throw'Id "'+j+'" is reserved and cannot be used as custom tab id.';}this.addAggregation('customTabs',i);return this;};x.prototype.invalidate=function(){if(this._dialog&&(!arguments[0]||arguments[0]&&arguments[0].getId()!==this.getId()+"-dialog")){this._dialog.invalidate(arguments);}};x.prototype.addStyleClass=function(){var i=this._getDialog();i.addStyleClass.apply(i,arguments);return this;};x.prototype.removeStyleClass=function(){var i=this._getDialog();i.removeStyleClass.apply(i,arguments);return this;};x.prototype.toggleStyleClass=function(){var i=this._getDialog();i.toggleStyleClass.apply(i,arguments);return this;};x.prototype.hasStyleClass=function(){var i=this._getDialog();return i.hasStyleClass.apply(i,arguments);};x.prototype.getDomRef=function(){if(this._dialog){return this._dialog.getDomRef.apply(this._dialog,arguments);}else{return null;}};x.prototype.setTitle=function(i){this._getTitleLabel().setText(i);this.setProperty("title",i);return this;};x.prototype.setTitleAlignment=function(i){this.setProperty("titleAlignment",i);if(this._page1){this._page1.setTitleAlignment(i);}if(this._page2){this._page2.setTitleAlignment(i);}return this;};x.prototype.addAggregation=function(i,j,k){a.prototype.addAggregation.apply(this,arguments);var W=this._getListType(i);if(this.mToList[W]){var X=this._createListItem(W,j);var Y=this._getList(W);if(!Y){Y=this._createList(W);}else if(!Y.getItems().length){Y.addItem(this._createGroupHeaderItem(W));}Y.addItem(X);this._attachItemPropertyChange(W,j);}else{this._attachItemEventHandlers(i,j);}if(i==="filterItems"){this._observeItem(j);}return this;};x.prototype.insertAggregation=function(i,j,k,W){a.prototype.insertAggregation.apply(this,arguments);var X=this._getListType(i);if(this.mToList[X]){var Y=this._createListItem(X,j);var Z=this._getList(X);if(!Z){Z=this._createList(X);Z.insertItem(Y,k);}else if(!Z.getItems().length){Z.addItem(this._createGroupHeaderItem(X));Z.insertItem(Y,k+1);}else{Z.insertItem(Y,k);}this._attachItemPropertyChange(X,j);}else{this._attachItemEventHandlers(i,j);}if(i==="filterItems"){this._observeItem(j);}return this;};x.prototype.removeAggregation=function(i,j,k){H.call(this,i,j);var W=a.prototype.removeAggregation.apply(this,arguments);var X=this._getListType(i);if(this.mToList[X]){var Y=this._getListItem(X,W);var Z=this._getList(X);var $=Z.removeItem(Y);$.destroy();this._detachItemPropertyChange(W);}if(i==="filterItems"){this._unobserveItem(W);if(!this.getFilterItems().length){this._disconnectAndDestroyFilterItemsObserver();}}return W;};x.prototype.removeAllAggregation=function(i,j){H.call(this);var k=a.prototype.removeAllAggregation.apply(this,arguments);var W=this._getListType(i);if(this.mToList[W]){var X=this._getList(W);if(X){var Y=X.removeAllItems();Y.forEach(function(Z){Z.destroy();});}k.forEach(function(Z){this._detachItemPropertyChange(Z);},this);}if(i==="filterItems"){this._disconnectAndDestroyFilterItemsObserver();}return k;};x.prototype.destroyAggregation=function(i,j){H.call(this);a.prototype.destroyAggregation.apply(this,arguments);var k=this._getListType(i);if(this.mToList[k]){var W=this._getList(k);if(W){W.destroyItems();}}if(i==="filterItems"){this._disconnectAndDestroyFilterItemsObserver();}return this;};x.prototype._detachItemPropertyChange=function(i){delete E.getEventList(i)["itemPropertyChanged"];};x.prototype._attachItemPropertyChange=function(i,j){j.attachEvent('itemPropertyChanged',function a1(k){var W,X,Y,Z,$,_;W=this._getListItem(i,j);X=k.getParameter('propertyKey');if(!this.mToList[i].itemPropertyMap[X]){return;}Y=this.mToList[i].itemPropertyMap[X].listProp||X;Z=k.getParameter('propertyValue');$=this.mToList[i].itemPropertyMap[X].fn;_=$?$(Z):Z;W.getMetadata().getAllProperties()[Y].set(W,_);},this);};x.prototype._getFilterItemsObserver=function(){if(!this._oFilterItemsObserver){this._oFilterItemsObserver=new h(function(){if(this._oSelectedFilterKeys){this.setSelectedFilterCompoundKeys(this._oSelectedFilterKeys);}}.bind(this));}return this._oFilterItemsObserver;};x.prototype._observeItem=function(i){this._getFilterItemsObserver().observe(i,{aggregations:["items"]});};x.prototype._unobserveItem=function(i){this._getFilterItemsObserver().unobserve(i,{aggregations:["items"]});};x.prototype._disconnectAndDestroyFilterItemsObserver=function(){if(this._oFilterItemsObserver){this._oFilterItemsObserver.disconnect();this._oFilterItemsObserver.destroy();this._oFilterItemsObserver=null;}};x.prototype._attachItemEventHandlers=function(i,j){if(i!=='groupItems'&&i!=='filterItems'){return this;}var k=i.replace('Items','');k=k.charAt(0).toUpperCase()+k.slice(1);j.attachEvent('itemPropertyChanged',function(i,W){if(i==='filterItems'&&W.getParameter('changedItem').getParent().getMetadata().getName()==='sap.m.ViewSettingsFilterItem'){if(W.getParameter('propertyKey')!=='selected'){if(this._vContentPage===3&&this._oContentItem){this._setFilterDetailTitle(this._oContentItem);this._initFilterDetailItems(this._oContentItem);}}else{if(this._filterDetailList){var X=this._filterDetailList.getItems();X.forEach(function(Y){if(Y.data('item').getId()===W.getParameter('changedItem').getId()){Y.setSelected(W.getParameter('propertyValue'));}});this._updateSelectAllCheckBoxState();}}this._updateFilterCounters();}else{if(typeof this['_init'+k+'Content']==='function'){this['_init'+k+'Content']();}if(typeof this['_init'+k+'Items']==='function'){if(W.getParameter("propertyKey")==="selected"&&W.getParameter("propertyValue")===true){this.setAssociation("selectedGroupItem",W.getParameter("changedItem"),true);}this['_init'+k+'Items']();}}}.bind(this,i));j.attachEvent('filterDetailItemsAggregationChange',function(W){if(this._vContentPage===3&&this._oContentItem){this._setFilterDetailTitle(this._oContentItem);this._initFilterDetailItems(this._oContentItem);}}.bind(this));return this;};x.prototype._setFilterDetailTitle=function(i){var j=this._rb.getText("VIEWSETTINGS_TITLE_FILTERBY")+" "+i.getText();this._getDetailTitleLabel().setText(j);this._toggleDialogTitle(this._sFilterDetailTitleLabelId);};x.prototype._toggleDialogTitle=function(i){var j=this._getDialog(),k=j.getAriaLabelledBy(),W=[this._sTitleLabelId,this._sFilterDetailTitleLabelId];if(W.indexOf(i)===-1&&k.indexOf(i)>-1){return this;}for(var X in W){j.removeAriaLabelledBy(W[X]);}j.addAriaLabelledBy(i);return this;};x.prototype.updateAggregation=function(i){a.prototype.updateAggregation.apply(this,arguments);if(i!=='groupItems'&&i!=='filterItems'){return this;}var j=i.replace('Items','');j=j.charAt(0).toUpperCase()+j.slice(1);if(typeof this['_init'+j+'Content']==='function'){this['_init'+j+'Content']();}if(typeof this['_init'+j+'Items']==='function'){this['_init'+j+'Items']();}};x.prototype.addSortItem=function(i){this.addAggregation("sortItems",i);if(this.getSelectedSortItem()===i.getId()||this.getSelectedSortItem()===i.getKey()){i.setSelected(true);}if(i.getSelected()){this.setAssociation("selectedSortItem",i,true);}return this;};x.prototype.addGroupItem=function(i){this.addAggregation("groupItems",i);if(this.getSelectedGroupItem()===i.getId()||this.getSelectedGroupItem()===i.getKey()){i.setSelected(true);}if(i.getSelected()){this.setAssociation("selectedGroupItem",i,true);}return this;};x.prototype.addPresetFilterItem=function(i){this.addAggregation("presetFilterItems",i);if(i.getSelected()){this.setSelectedPresetFilterItem(i);}return this;};x.prototype.setSelectedSortItem=function(j){var k=this.getSortItems(),i=0,W=A(j,k);if(!W&&(typeof j==="string")){W=C.byId(j);}if(!W||F(W)){for(i=0;i<k.length;i++){if(!W||k[i].getId()!==W.getId()){k[i].setProperty('selected',false,true);}}if(W&&W.getProperty('selected')!==true){W.setProperty('selected',true,true);}if(this._getDialog().isOpen()){this._updateListSelection(this._sortList,W);}}this.setAssociation("selectedSortItem",W||j,true);return this;};x.prototype.setSelectedGroupItem=function(j){var k=this.getGroupItems(),i=0,W=A(j,k);if(!W&&(typeof j==="string")){W=C.byId(j);}if(!W&&!j){W=this._oGroupingNoneItem;this.setAssociation("selectedGroupItem",W,true);return this;}if(F(W)){for(i=0;i<k.length;i++){k[i].setProperty('selected',false,true);}W.setProperty('selected',true,true);if(this._getDialog().isOpen()){this._updateListSelection(this._groupList,W);}}this.setAssociation("selectedGroupItem",W||j,true);return this;};x.prototype.setSelectedPresetFilterItem=function(j){var k=this.getPresetFilterItems(),i=0,W=A(j,k,"Could not set selected preset filter item. Item is not found: '"+j+"'");if(F(W)||W===null){for(i=0;i<k.length;i++){k[i].setProperty('selected',false,true);}if(W!==null){W.setProperty('selected',true,true);}this._clearSelectedFilters();this.setAssociation("selectedPresetFilterItem",W,true);}return this;};x.prototype.open=function(i){if(!this.getParent()&&!this._bAppendedToUIArea){var j=C.getStaticAreaRef();j=C.getUIArea(j);j.addContent(this._getDialog(),true);this._bAppendedToUIArea=true;}if(i&&this._vContentPage===3){setTimeout(this._getNavContainer()["to"].bind(this._getNavContainer(),this._getPage1().getId(),"show"),0);}this._initDialogContent(i);this._oPreviousState={sortItem:C.byId(this._getSelectedSortItem()),sortDescending:this.getSortDescending(),groupItem:C.byId(this._getSelectedGroupItem()),groupDescending:this.getGroupDescending(),presetFilterItem:C.byId(this.getSelectedPresetFilterItem()),filterKeys:this.getSelectedFilterKeys(),filterCompoundKeys:this.getSelectedFilterCompoundKeys(),navPage:this._getNavContainer().getCurrentPage(),contentPage:this._vContentPage,contentItem:this._oContentItem};if(!this._oInitialState){this._oInitialState={sortItem:this._getSelectedSortItem(),sortDescending:this.getSortDescending(),groupItem:this._getSelectedGroupItem(),groupDescending:this.getGroupDescending(),presetFilterItem:this.getSelectedPresetFilterItem()};}if(m.system.desktop){this._getDialog().attachEventOnce("afterOpen",function(){var k=this._getNavContainer().getCurrentPage(),$;if(k){$=k.$("cont").firstFocusableDomRef();if($){if(q($).hasClass('sapMListUl')){var W=q($).find('.sapMLIB');W.length&&W[0].focus();return;}$.focus();}}},this);}this._checkResetStatus();this._getDialog().open();return this;};x.prototype.getSelectedFilterItems=function(){var k=[],W=this.getFilterItems(),X,Y=true,i=0,j;for(;i<W.length;i++){if(W[i]instanceof sap.m.ViewSettingsCustomItem){if(W[i].getSelected()){k.push(W[i]);}}else if(W[i]instanceof sap.m.ViewSettingsFilterItem){X=W[i].getItems();Y=W[i].getMultiSelect();for(j=0;j<X.length;j++){if(X[j].getSelected()){k.push(X[j]);if(!Y){break;}}}}}return k;};x.prototype.getSelectedFilterString=function(){var k="",W,X=this.getSelectedPresetFilterItem(),Y=this.getFilterItems(),Z,$=true,i=0,j;if(X){k=this._rb.getText("VIEWSETTINGS_FILTERTEXT").concat(" "+C.byId(X).getText());}else{for(;i<Y.length;i++){if(Y[i]instanceof sap.m.ViewSettingsCustomItem){if(Y[i].getSelected()){k+=Y[i].getText()+", ";}}else if(Y[i]instanceof sap.m.ViewSettingsFilterItem){Z=Y[i].getItems();$=Y[i].getMultiSelect();W="";for(j=0;j<Z.length;j++){if(Z[j].getSelected()){W+=Z[j].getText()+", ";if(!$){break;}}}W=W.substring(0,W.length-2);if(W){W=" ("+W+")";k+=Y[i].getText()+W+", ";}}}k=k.substring(0,k.length-2);if(k){k=this._rb.getText("VIEWSETTINGS_FILTERTEXT").concat(" "+k);}}return k;};x.prototype.getSelectedFilterKeys=function(){var j={},k=this.getSelectedFilterItems(),i=0;for(;i<k.length;i++){j[k[i].getKey()]=k[i].getSelected();}return j;};x.prototype.getSelectedFilterCompoundKeys=function(){var j={},k=this.getSelectedFilterItems(),i,W,X,Y;this._oKeylessFilters={};for(i=0;i<k.length;i++){Y=k[i];if(Y instanceof sap.m.ViewSettingsCustomItem){W=Y.getKey();j[W]=Y.getSelected();}else{W=Y.getKey();X=Y.getParent().getKey();if(!j[X]){j[X]={};}j[X][W]=Y.getSelected();if(W===""){if(!this._oKeylessFilters[X]){this._oKeylessFilters[X]={};}this._oKeylessFilters[X][Y.getText()]=true;}}}return j;};x.prototype.setSelectedFilterKeys=function(W){var X=this.getFilterItems(),Y={},Z,$,i,j,k;if(Object.keys(W).length){this._clearPresetFilter();}for(var _ in W){Z=null;if(W.hasOwnProperty(_)){for(i=0;i<X.length;i++){if(X[i]instanceof sap.m.ViewSettingsCustomItem){if(X[i].getKey()===_){Z=X[i];X[i].setProperty('selected',W[_],true);}}else if(X[i]instanceof sap.m.ViewSettingsFilterItem){Y=X[i].getItems();$=X[i].getMultiSelect();for(j=0;j<Y.length;j++){if(Y[j].getKey()===_){Z=Y[j];if(!$){for(k=0;k<Y.length;k++){Y[k].setProperty('selected',false,true);}}break;}}}if(Z){break;}}if(Z===null){p.warning('Cannot set state for key "'+_+'" because there is no filter with these keys');continue;}Z.setProperty('selected',W[_],true);}}return this;};x.prototype.setSelectedFilterCompoundKeys=function(i){var j=this.getFilterItems(),k,W,X,Y,Z,$,_,a1,b1,c1;this._oSelectedFilterKeys=i;if(Object.keys(i).length){this._clearPresetFilter();for(k in i){Y=null;for(c1=0;c1<j.length;c1++){W=j[c1].getKey();if(W===k){Y=j[c1];break;}}if(Y instanceof sap.m.ViewSettingsCustomItem){Y.setProperty('selected',i[k],true);}else if(Y instanceof sap.m.ViewSettingsFilterItem){Z=i[k];$=Y.getItems();_=Y.getMultiSelect();b1=false;for(c1=0;c1<$.length;c1++){W=$[c1].getKey();X=$[c1].getText();if((W!==""&&Z[W])||(W===""&&this._oKeylessFilters[k]&&this._oKeylessFilters[k][X])){a1=b1?false:Z[W];}else{a1=false;}$[c1].setProperty("selected",a1,true);if(a1&&!_){b1=true;}}}}}return this;};x.prototype._checkForInnerCustomItems=function(j){for(var i=0;i<j.length;i++){if(j[i].isA("sap.m.ViewSettingsCustomItem")){return true;}}return false;};x.prototype._checkForCustomItems=function(){var i=this.getSortItems(),j=this.getGroupItems(),k=this.getFilterItems(),W=this.getPresetFilterItems();return this.getAggregation("customTabs").length||i.length&&this._checkForInnerCustomItems(i)||j.length&&this._checkForInnerCustomItems(j)||k.length&&this._checkForInnerCustomItems(k)||W.length&&this._checkForInnerCustomItems(W);};x.prototype._checkResetStatus=function(){var i=false,j=this.getSelectedFilterItems();if(this._checkForCustomItems()){i=true;}else{if(this._oInitialState){if(j.length>0){i=true;}if(this._oInitialState.sortItem!==this._getSelectedSortItem()||this._oInitialState.sortDescending!==this.getSortDescending()){i=true;}if((this._oInitialState.groupItem&&this._oInitialState.groupItem!==this._getSelectedGroupItem())||this._oInitialState.groupDescending!==this.getGroupDescending()){i=true;}if(this._oInitialState.presetFilterItem!==undefined&&this.getSelectedPresetFilterItem()!==null){i=true;}}}if(this._resetButton){this._resetButton.setEnabled(i);}if(this._detailResetButton){this._detailResetButton.setEnabled(i);}};x.prototype._globalReset=function(){this.clearFilters();this.setSelectedSortItem(C.byId(this._oInitialState.sortItem));this.setSortDescending(this._oInitialState.sortDescending);this._updateListSelection(this._sortOrderList,this._oInitialState.sortDescending);this._oInitialState.groupItem!==undefined&&this.setSelectedGroupItem(C.byId(this._oInitialState.groupItem));this.setGroupDescending(this._oInitialState.groupDescending);this._updateListSelection(this._groupOrderList,this._oInitialState.groupDescending);this._checkResetStatus();this.fireReset();};x.prototype._getDialog=function(){var i=this;if(this._dialog===undefined){this._dialog=new D(this.getId()+"-dialog",{ariaLabelledBy:this._sTitleLabelId,showHeader:false,stretch:m.system.phone,verticalScrolling:true,horizontalScrolling:false,contentWidth:this._sDialogWidth,contentHeight:this._sDialogHeight,content:this._getNavContainer(),titleAlignment:this.getTitleAlignment(),beginButton:new B(this.getId()+"-acceptbutton",{text:this._rb.getText("VIEWSETTINGS_ACCEPT"),type:v.Emphasized}).attachPress(this._onConfirm,this),endButton:new B(this.getId()+"-cancelbutton",{text:this._rb.getText("VIEWSETTINGS_CANCEL")}).attachPress(this._onCancel,this)}).addStyleClass("sapMVSD");this.addDependent(this._dialog);var j=this._dialog.onsapescape;this._dialog.onsapescape=function(k){if(j){j.call(i._dialog,k);}i._onCancel();};this._dialog.onsapentermodifiers=function(k){if(k.shiftKey&&!k.ctrlKey&&!k.altKey){i._pressBackButton();}};}return this._dialog;};x.prototype._getNavContainer=function(){if(this._navContainer===undefined){this._navContainer=new N(this.getId()+'-navcontainer',{pages:[]});}return this._navContainer;};x.prototype._getTitleLabel=function(){if(this._titleLabel===undefined){this._titleLabel=new e(this._sTitleLabelId,{text:this._rb.getText("VIEWSETTINGS_TITLE")}).addStyleClass("sapMVSDTitle");}return this._titleLabel;};x.prototype._getResetButton=function(){if(!this._resetButton){this._resetButton=new B(this.getId()+"-resetbutton",{press:function(){this._globalReset();}.bind(this),text:this._rb.getText("VIEWSETTINGS_RESET")});}return this._resetButton;};x.prototype._getDetailResetButton=function(){if(this._detailResetButton===undefined){this._detailResetButton=new B(this.getId()+"-detailresetbutton",{press:function(){this._globalReset();}.bind(this),text:this._rb.getText("VIEWSETTINGS_RESET")});}return this._detailResetButton;};x.prototype._getDetailTitleLabel=function(){if(this._detailTitleLabel===undefined){this._detailTitleLabel=new e(this.getId()+"-detailtitle",{text:this._rb.getText("VIEWSETTINGS_TITLE_FILTERBY")}).addStyleClass("sapMVSDTitle");}return this._detailTitleLabel;};x.prototype._getHeader=function(){if(this._header===undefined){this._header=new f({titleAlignment:this.getTitleAlignment(),contentMiddle:[this._getTitleLabel()]}).addStyleClass("sapMVSDBar");}return this._header;};x.prototype._getSubHeader=function(){if(this._subHeader===undefined){this._subHeader=new f({contentLeft:[this._getSegmentedButton()]}).addStyleClass("sapMVSDBar");}return this._subHeader;};x.prototype._getSegmentedButton=function(){var j=this,k=this.getCustomTabs(),W=k.length,i=0;if(this._segmentedButton===undefined){this._segmentedButton=new g({select:function(X){var Y=X.getParameter('id');if(Y===j.getId()+"-sortbutton"){j._switchToPage(0);}else if(Y===j.getId()+"-groupbutton"){j._switchToPage(1);}else if(Y===j.getId()+"-filterbutton"){j._switchToPage(2);}else{for(i=0;i<W;i++){var Z=k[i],$=j.getId()+j._sCustomTabsButtonsIdPrefix+Z.getId();if(!j._isEmptyTab(Z)&&Y===$){j._switchToPage(Z.getId());break;}}}p.info('press event segmented: '+X.getParameter('id'));}}).addStyleClass("sapMVSDSeg");this._segmentedButton._bPreventWidthRecalculationOnAfterRendering=true;}return this._segmentedButton;};x.prototype._getSortButton=function(){if(this._sortButton===undefined){this._sortButton=new B(this.getId()+"-sortbutton",{icon:I.getIconURI("sort"),tooltip:this._rb.getText("VIEWSETTINGS_TITLE_SORT")});}return this._sortButton;};x.prototype._getGroupButton=function(){if(this._groupButton===undefined){this._groupButton=new B(this.getId()+"-groupbutton",{icon:I.getIconURI("group-2"),tooltip:this._rb.getText("VIEWSETTINGS_TITLE_GROUP")});}return this._groupButton;};x.prototype._getFilterButton=function(){if(this._filterButton===undefined){this._filterButton=new B(this.getId()+"-filterbutton",{icon:I.getIconURI("filter"),tooltip:this._rb.getText("VIEWSETTINGS_TITLE_FILTER")});}return this._filterButton;};x.prototype._getPage1=function(i){if(this._page1===undefined&&!i){this._page1=new P(this.getId()+'-page1',{title:this._rb.getText("VIEWSETTINGS_TITLE"),titleAlignment:this.getTitleAlignment(),customHeader:this._getHeader()});this._getNavContainer().addPage(this._page1);}return this._page1;};x.prototype._getPage2=function(){var i,j,k,W=this.getTitleAlignment();if(this._page2===undefined){j=new B(this.getId()+"-backbutton",{icon:I.getIconURI("nav-back"),press:[this._pressBackButton,this]});k=this._getDetailResetButton();i=new f({titleAlignment:W,contentLeft:[j],contentMiddle:[this._getDetailTitleLabel()],contentRight:[k]}).addStyleClass("sapMVSDBar");this._page2=new P(this.getId()+'-page2',{title:this._rb.getText("VIEWSETTINGS_TITLE_FILTERBY"),titleAlignment:W,customHeader:i});this._getNavContainer().addPage(this._page2);}return this._page2;};x.prototype._initFilterDetailItems=function(k){if(!(k instanceof sap.m.ViewSettingsFilterItem)){return;}var W;var X=k.getMultiSelect();var Y=k.getItems();var Z=this;if(this._filterDetailList){this._filterDetailList.destroy();}this._getPage2().removeAllAggregation('content');this._filterDetailList=new L({mode:(X?r.MultiSelect:r.SingleSelectLeft),includeItemInSelection:true,selectionChange:function($){var _,a1=$.getParameter("listItems"),b1,i=0,c1;Z._clearPresetFilter();if(X){this._updateSelectAllCheckBoxState();}if(a1.length>1&&X){b1=k.getItems();for(;i<b1.length;i++){for(var j=0;j<a1.length;j++){if(b1[i].getKey()===a1[j].getCustomData()[0].getValue().getKey()){b1[i].setProperty('selected',a1[j].getSelected(),true);}}}}else{_=$.getParameter("listItem").data("item");if(!k.getMultiSelect()){b1=k.getItems();for(;i<b1.length;i++){if(b1[i].getId()!==_.getId()){b1[i].setProperty('selected',false,true);}}}c1=$.getParameter("listItem").getSelected();if(_.getProperty('selected')!==c1){_.setProperty('selected',c1,true);}}this._checkResetStatus();}.bind(this),ariaLabelledBy:this._sFilterDetailTitleLabelId});for(var i=0;i<Y.length;i++){W=new c({title:M.escapeSettingsValue(Y[i].getText()),type:s.Active,selected:Y[i].getSelected(),tooltip:Y[i].getTooltip()}).data("item",Y[i]);this._filterDetailList.addItem(W);}this._filterSearchField=this._getFilterSearchField(this._filterDetailList);this._showOnlySelectedButton=this._getShowOnlySelectedButton();this._searchBar=new T({content:[this._filterSearchField.addStyleClass('sapMVSDFilterSearchField').addStyleClass('sapMTBShrinkItem'),this._showOnlySelectedButton]});this._getPage2().addContent(this._searchBar);this._getPage2().getCustomHeader().addStyleClass('sapMVSDBarWithSearch');if(X){this._selectAllCheckBox=this._createSelectAllCheckbox(Y,this._filterDetailList);if(this._filterDetailList.getItems().length===0){this._selectAllCheckBox.setEnabled(false);}this._filterDetailList.setHeaderToolbar(new T({content:[this._selectAllCheckBox]}).addStyleClass('sapMVSDFilterHeaderToolbar'));}this._setFilterDetailItemsVisibility(this._filterDetailList,true);this._getPage2().addContent(this._filterDetailList);};x.prototype._initSortContent=function(){if(this._sortContent){return;}this._vContentPage=-1;this._ariaSortOrderInvisibleText=new n(this.getId()+"-sortOrderLabel",{text:this._rb.getText("VIEWSETTINGS_SORT_BY")});this._sortOrderList=new L(this.getId()+"-sortorderlist",{mode:r.SingleSelectLeft,includeItemInSelection:true,selectionChange:function(i){this.setProperty('sortDescending',i.getParameter("listItem").data("item"),true);this._checkResetStatus();}.bind(this),ariaLabelledBy:this._ariaSortOrderInvisibleText});this._sortOrderList.addItem(new G({title:this._rb.getText("VIEWSETTINGS_SORT_BY")}));this._sortOrderList.addItem(new c({title:this._rb.getText("VIEWSETTINGS_ASCENDING_ITEM")}).data("item",false).setSelected(true));this._sortOrderList.addItem(new c({title:this._rb.getText("VIEWSETTINGS_DESCENDING_ITEM")}).data("item",true));this._ariaSortListInvisibleText=new n(this.getId()+"-sortListLabel",{text:this._rb.getText("VIEWSETTINGS_SORT_OBJECT")});this._sortList.addAriaLabelledBy(this._ariaSortListInvisibleText);this._sortContent=[this._ariaSortOrderInvisibleText,this._sortOrderList,this._ariaSortListInvisibleText,this._sortList];};x.prototype._initGroupItems=function(){var i,j,k=this.getGroupItems(),W=this._rb.getText("VIEWSETTINGS_GROUP_OBJECT");this._groupList.destroyItems();if(k.length){this._groupList.addItem(new G({title:W}));k.forEach(function(X){i=new c({id:X.getId()+w,title:M.escapeSettingsValue(X.getText()),type:s.Active,selected:X.getSelected(),tooltip:X.getTooltip()}).data("item",X);this._groupList.addItem(i);},this);if(!this._oGroupingNoneItem||this._oGroupingNoneItem.bIsDestroyed){j=!!this._getSelectedGroupItem();this._oGroupingNoneItem=new V({text:this._rb.getText("VIEWSETTINGS_NONE_ITEM"),selected:!j,itemPropertyChanged:function(){this._initGroupContent();this._initGroupItems();}.bind(this)});!j&&this.setAssociation("selectedGroupItem",this._oGroupingNoneItem,true);}i=new c({id:this._oGroupingNoneItem.getId()+w,title:this._oGroupingNoneItem.getText(),type:s.Active,selected:this._oGroupingNoneItem.getSelected()}).data("item",this._oGroupingNoneItem);this._groupList.addItem(i);}};x.prototype._initGroupContent=function(){if(this._groupContent){return;}this._vContentPage=-1;this._ariaGroupOrderInvisibleText=new n(this.getId()+"-groupOrderLabel",{text:this._rb.getText("VIEWSETTINGS_GROUP_BY")});this._groupOrderList=new L(this.getId()+"-grouporderlist",{mode:r.SingleSelectLeft,includeItemInSelection:true,selectionChange:function(i){this.setProperty('groupDescending',i.getParameter("listItem").data("item"),true);this._checkResetStatus();}.bind(this),ariaLabelledBy:this._ariaGroupOrderInvisibleText});this._groupOrderList.addItem(new G({title:this._rb.getText("VIEWSETTINGS_GROUP_BY")}));this._groupOrderList.addItem(new c({title:this._rb.getText("VIEWSETTINGS_ASCENDING_ITEM")}).data("item",false).setSelected(true));this._groupOrderList.addItem(new c({title:this._rb.getText("VIEWSETTINGS_DESCENDING_ITEM")}).data("item",true));this._ariaGroupListInvisibleText=new n(this.getId()+"-groupListLabel",{text:this._rb.getText("VIEWSETTINGS_GROUP_OBJECT")});this._groupList=new L(this.getId()+"-grouplist",{mode:r.SingleSelectLeft,includeItemInSelection:true,selectionChange:function(i){var j=i.getParameter("listItem").data("item");this.setSelectedGroupItem(j);this._checkResetStatus();}.bind(this),ariaLabelledBy:this._ariaGroupListInvisibleText});this._groupContent=[this._ariaGroupOrderInvisibleText,this._groupOrderList,this._ariaGroupListInvisibleText,this._groupList];};x.prototype._initFilterItems=function(){var i,j,k,W=this,X=this._rb.getText("VIEWSETTINGS_FILTER_BY");this._presetFilterList.destroyItems();i=this.getPresetFilterItems();if(i.length){i.forEach(function(Y){k=new c({id:Y.getId()+w,title:M.escapeSettingsValue(Y.getText()),type:s.Active,selected:Y.getSelected(),tooltip:Y.getTooltip()}).data("item",Y);this._presetFilterList.addItem(k);},this);}if(i.length){k=new c({id:this._presetFilterList.getId()+"-none"+w,title:this._rb.getText("VIEWSETTINGS_NONE_ITEM_FILTER"),selected:!!this.getSelectedPresetFilterItem()});this._presetFilterList.addItem(k);}this._filterList.destroyItems();j=this.getFilterItems();this._filterList.addItem(new G({title:X}));if(j.length){j.forEach(function(Y){k=new c({id:Y.getId()+w,title:M.escapeSettingsValue(Y.getText()),type:s.Active,tooltip:Y.getTooltip(),press:(function(Y){return function(Z){if(W._navContainer.getCurrentPage().getId()!==W.getId()+'-page2'){W._switchToPage(3,Y);W._prevSelectedFilterItem=this;setTimeout(W._navContainer["to"].bind(W._navContainer,W.getId()+'-page2',"slide"),0);}if(m.system.desktop&&W._filterDetailList&&W._filterDetailList.getItems()[0]){W._getNavContainer().attachEventOnce("afterNavigate",function(){W._filterDetailList.getItems()[0].focus();});}};}(Y))}).data("item",Y);this._filterList.addItem(k);},this);}};x.prototype._initFilterContent=function(){if(this._filterContent){return;}this._vContentPage=-1;this._ariaFilterByInvisibleText=new n(this.getId()+"-filterByLabel",{text:this._rb.getText("VIEWSETTINGS_FILTER_BY")});this._presetFilterList=new L(this.getId()+"-predefinedfilterlist",{mode:r.SingleSelectLeft,includeItemInSelection:true,selectionChange:function(i){var j=i.getParameter("listItem").data("item");if(j){j.setProperty('selected',i.getParameter("listItem").getSelected(),true);}this.setAssociation("selectedPresetFilterItem",j,true);this._clearSelectedFilters();this._checkResetStatus();}.bind(this)});this._filterList=new L(this.getId()+"-filterlist",{ariaLabelledBy:this._ariaFilterByInvisibleText});this._filterContent=[this._ariaFilterByInvisibleText,this._presetFilterList,this._filterList];};x.prototype._initDialogContent=function(i){var j=!!this.getSortItems().length,k=!!this.getGroupItems().length,W=!!this.getPresetFilterItems().length,X=!!this.getFilterItems().length;if(j){this._initSortContent();}if(k){this._initGroupContent();this._initGroupItems();}if(W||X){this._initFilterContent();this._initFilterItems();}this._updateDialogState(i);this._updateListSelections();};x.prototype._getTabButton=function(i,j){var k=j+i.getId(),W=C.byId(k);if(W){return W;}else{return new B({id:k,icon:i.getIcon(),tooltip:i.getTooltip()});}};x.prototype._updateDialogState=function(i){var j=!!this.getSortItems().length,k=!!this.getGroupItems().length,W=!!this.getPresetFilterItems().length,X=!!this.getFilterItems().length,Y=!!this.getCustomTabs().length,Z=this._getSegmentedButton(),$=null,_=false,a1={"sort":0,"group":1,"filter":2};Z.removeAllButtons();if(this._filterContent){this._presetFilterList.setVisible(true);this._filterList.setVisible(true);}if(j){Z.addButton(this._getSortButton());}if(W||X){Z.addButton(this._getFilterButton());if(!W){this._presetFilterList.setVisible(false);}if(!X){this._filterList.setVisible(false);}}if(k){Z.addButton(this._getGroupButton());}if(Y){this.getCustomTabs().forEach(function(c1){if(!this._isEmptyTab(c1)){var d1=this.getId()+this._sCustomTabsButtonsIdPrefix,e1=this._getTabButton(c1,d1);Z.addButton(e1);}}.bind(this));}this._showSubHeader=this._hasSubHeader();if(i===undefined&&this._vContentPage!==-1){i=this._vContentPage;switch(i){case 0:i='sort';break;case 1:i='group';break;case 2:i='filter';break;}}if(i===this._vContentPage&&this._vContentPage===3){this._vContentPage=-1;this._switchToPage(3,this._oContentItem);}else{i=this._determineValidPageId(i);for(var b1 in a1){if(i===b1){_=true;$=this.getId()+'-'+i+'button';i=a1[b1];break;}}if(!_){$=this.getId()+this._sCustomTabsButtonsIdPrefix+i;}this._getSegmentedButton().setSelectedButton($);this._switchToPage(i);if(this._getNavContainer().getCurrentPage()!==this._getPage1()){this._getNavContainer().to(this._getPage1().getId());}}};x.prototype._determineValidPageId=function(i){var j='sort',k=false,W=[];W=this._fetchValidPagesIds();if(W.length){j=W[0];}else{p.warning('No available pages to load - missing items.');}if(!i){i=j;}else{W.filter(function(X){if(X===i){k=true;return false;}return true;});if(!k){i=j;}}return i;};x.prototype._fetchValidPagesIds=function(){var i,j=this.getCustomTabs(),k=j.length,W=[];var X=['sort','filter','group'];X.forEach(function(Z){if(this._isValidPredefinedPageId(Z)){W.push(Z);}},this);for(i=0;i<k;i++){var Y=j[i];if(!this._isEmptyTab(Y)){W.push(Y.getId());}}return W;};x.prototype._isEmptyTab=function(i){return!(i.getContent().length||this._vContentPage===i.getId()&&this._getPage1().getContent().length);};x.prototype._isValidPredefinedPageId=function(i){if(!i){p.warning('Missing mandatory parameter.');return false;}var j=false;switch(i){case'sort':j=!!this.getSortItems().length;break;case'filter':j=!!this.getFilterItems().length||!!this.getPresetFilterItems().length;break;case'group':j=!!this.getGroupItems().length;break;}return j;};x.prototype._pressBackButton=function(){var i=this;if(this._vContentPage===3){this._updateFilterCounters();this._getNavContainer().attachEvent("afterNavigate",function(){if(i._prevSelectedFilterItem){i._prevSelectedFilterItem.focus();}});setTimeout(this._getNavContainer()['back'].bind(this._getNavContainer()),0);this._switchToPage(2);this._segmentedButton.setSelectedButton(this._filterButton);}};x.prototype.setModel=function(i,j){if(this._vContentPage===3&&this._oContentItem){y.call(this);}return a.prototype.setModel.call(this,i,j);};x.prototype.removeFilterItem=function(i){var j="";if(this._vContentPage===3&&this._oContentItem){if(typeof(i)==="object"){j=i.getId();}else if(typeof(i)==="string"){j=i;}else if(typeof(i)==="number"){j=this.getFilterItems()[i].getId();}if(this._oContentItem.getId()===j){y.call(this);}}return this.removeAggregation('filterItems',i);};x.prototype.removeAllFilterItems=function(){if(this._vContentPage===3&&this._oContentItem){y.call(this);}return this.removeAllAggregation('filterItems');};x.prototype.setFilterSearchCallback=function(i){this._fnFilterSearchCallback=i;return this;};x.prototype._switchToPage=function(W,j){var i=0,k=this._getTitleLabel(),X=this._getHeader(),Y=this._getSubHeader();this._checkResetStatus();this._getPage2().getCustomHeader().removeStyleClass('sapMVSDBarWithSearch');if(J.call(this)){H.call(this);}X.removeAllContentRight();Y.removeAllContentRight();this._vContentPage=W;this._oContentItem=j;if(W!==3){this._getPage1().removeAllAggregation("content",true);this._addResetButtonToPage1();}else if(W===3){this._getPage2().removeAllAggregation("content",true);}if(this.getTitle()){k.setText(this.getTitle());}else{k.setText(this._rb.getText("VIEWSETTINGS_TITLE"));}this._toggleDialogTitle(this._sTitleLabelId);switch(W){case 1:if(!this._showSubHeader&&!this.getTitle()){k.setText(this._rb.getText("VIEWSETTINGS_TITLE_GROUP"));}for(;i<this._groupContent.length;i++){this._getPage1().addContent(this._groupContent[i]);}break;case 2:if(!this._showSubHeader&&!this.getTitle()){k.setText(this._rb.getText("VIEWSETTINGS_TITLE_FILTER"));}this._updateListSelection(this._presetFilterList,C.byId(this.getSelectedPresetFilterItem()));this._updateFilterCounters();for(;i<this._filterContent.length;i++){this._getPage1().addContent(this._filterContent[i]);}break;case 3:this._setFilterDetailTitle(j);if(j instanceof sap.m.ViewSettingsCustomItem&&j.getCustomControl()){this._clearPresetFilter();this._getPage2().addContent(j.getCustomControl());}else if(j instanceof sap.m.ViewSettingsFilterItem&&j.getItems()){this._initFilterDetailItems(j);}break;case 0:if(!this._getPage1().getSubHeader()&&!this.getTitle()){k.setText(this._rb.getText("VIEWSETTINGS_TITLE_SORT"));}if(this._sortContent){for(;i<this._sortContent.length;i++){this._getPage1().addContent(this._sortContent[i]);}}break;default:this._getPage1().removeAllAggregation("content",true);var Z="VIEWSETTINGS_TITLE";var $=this.getCustomTabs();if($.length<2){Z=$[0].getTitle();}if(!this._getPage1().getSubHeader()&&!this.getTitle()){k.setText(Z);}$.forEach(function(_){if(_.getId()===W){_.getContent().forEach(function(a1){this._getPage1().addContent(a1);},this);}},this);break;}if(W===3){this.fireFilterDetailPageOpened({parentFilterItem:j});}};x.prototype._createSelectAllCheckbox=function(i,j){var k=false;if(i&&i.length!==0){k=i.every(function(X){return X.getSelected();});}var W=new b({text:this._rb.getText("COLUMNSPANEL_SELECT_ALL"),selected:k,select:function(X){var Y=X.getParameter('selected');j.getItems().filter(function(Z){return Z.getVisible();}).forEach(function(Z){var $=Z.data("item");$.setSelected(Y);});this._checkResetStatus();}.bind(this)});return W;};x.prototype._updateSelectAllCheckBoxState=function(){var i=false,j=this._filterDetailList.getItems(),k=[];if(!this._selectAllCheckBox){return;}if(j&&j.length!==0){k=j.filter(function(W){return W.getVisible();});}if(k.length!==0){this._selectAllCheckBox.setEnabled(true);i=k.every(function(W){return W.getSelected();});}else{this._selectAllCheckBox.setEnabled(false);}this._selectAllCheckBox.setSelected(i);};x.prototype._visibilityBySearchField=function(i){var j=this._filterSearchField.getValue(),k=this._getStringFilter(),W=k(j,i.getTitle());return W;};x.prototype._visibilityByToggleButton=function(i){var j=this._showOnlySelectedButton.getPressed()?i.getSelected():true;return j;};x.prototype._getFilterSearchField=function(i){var j=new S({liveChange:function(){this._setFilterDetailItemsVisibility(i);}.bind(this)});return j;};x.prototype._setFilterDetailItemsVisibility=function(i,j){i.getItems().forEach(function(k){k.setVisible(this._visibilityByToggleButton(k)&&(j||this._visibilityBySearchField(k)));}.bind(this));this._updateSelectAllCheckBoxState();};x.prototype._getShowOnlySelectedButton=function(){var i=this._oContentItem&&this._oFiltersSelectedOnly[this._oContentItem.getId()]?true:false,j=new d({icon:I.getIconURI("multi-select"),tooltip:this._rb.getText("SHOW_SELECTED_ONLY"),type:v.Transparent,pressed:i,press:function(){var k=this._showOnlySelectedButton.getPressed(),W=this._oContentItem.getId();if(k){this._oFiltersSelectedOnly[W]=true;}else{delete this._oFiltersSelectedOnly[W];}this._setFilterDetailItemsVisibility(this._filterDetailList);}.bind(this)});return j;};x.prototype._getStringFilter=function(){if(this._fnFilterSearchCallback){return this._fnFilterSearchCallback;}if(!this._oStringFilter||this._oStringFilter.sOperator!==this.getFilterSearchOperator()){this._oStringFilter=new K(this.getFilterSearchOperator());}return this._oStringFilter.filter.bind(this._oStringFilter);};x.prototype._updateListSelections=function(){this._updateListSelection(this._sortList,C.byId(this._getSelectedSortItem()));this._updateListSelection(this._sortOrderList,this.getSortDescending());this._updateListSelection(this._groupList,C.byId(this._getSelectedGroupItem()));this._updateListSelection(this._groupOrderList,this.getGroupDescending());this._updateListSelection(this._presetFilterList,C.byId(this.getSelectedPresetFilterItem()));this._updateFilterCounters();};x.prototype._updateListSelection=function(j,k){var W,i=0,X;if(!j){return false;}W=j.getItems();j.removeSelections();for(;i<W.length;i++){X=W[i].isA("sap.m.GroupHeaderListItem");if(!X&&(W[i].data("item")===k||W[i].data("item")===null)){j.setSelectedItem(W[i],(k&&k.getSelected?k.getSelected():true));return true;}}return false;};x.prototype._updateFilterCounters=function(){var k=(this._filterList?this._filterList.getItems():[]),W,X,Y=0,i=0,j;for(;i<k.length;i++){W=k[i].data("item");Y=0;if(W){if(W instanceof sap.m.ViewSettingsCustomItem){Y=W.getFilterCount();}else if(W instanceof sap.m.ViewSettingsFilterItem){Y=0;X=W.getItems();for(j=0;j<X.length;j++){if(X[j].getSelected()){Y++;}}}}k[i].setCounter(Y);}};x.prototype._clearSelectedFilters=function(){var k=this.getFilterItems(),W,i=0,j;for(;i<k.length;i++){if(k[i]instanceof sap.m.ViewSettingsFilterItem){W=k[i].getItems();for(j=0;j<W.length;j++){W[j].setProperty('selected',false,true);}}k[i].setProperty('selected',false,true);}if(this._vContentPage===2&&this._getDialog().isOpen()){this._updateFilterCounters();}};x.prototype._clearPresetFilter=function(){if(this.getSelectedPresetFilterItem()){this.setSelectedPresetFilterItem(null);}};x.prototype._calculateNumberOfPages=function(){var i=0,j=!!this.getSortItems().length,k=!!this.getGroupItems().length,W=!!this.getPresetFilterItems().length,X=!!this.getFilterItems().length;if(j){i++;}if(W||X){i++;}if(k){i++;}this.getCustomTabs().forEach(function(Y){if(!this._isEmptyTab(Y)){i++;}},this);return i;};x.prototype._hasSubHeader=function(){return!(this._calculateNumberOfPages()<2);};function y(){this._vContentPage=2;this._oContentItem=null;this._navContainer.to(this._getPage1().getId(),"show");}function z(j,k){var i,W;for(i=0;i<j.length;i++){if(j[i].getKey()===k){W=j[i];break;}}return W;}function A(i,j,k){var W;if(typeof i==="string"){W=z(j,i);if(!W&&k){p.error(k);}}else{W=i;}return W;}function F(i){return i&&i instanceof sap.m.ViewSettingsItem;}x.prototype._onConfirm=function(i){var j=this._getDialog(),k=this,W=function(){var X,Y,Z=k._getSelectedGroupItem();if(!k._oGroupingNoneItem||Z!=k._oGroupingNoneItem.getId()){Y=C.byId(Z);}k._toggleDialogTitle(k._sTitleLabelId);X={sortItem:C.byId(k._getSelectedSortItem()),sortDescending:k.getSortDescending(),groupItem:Y,groupDescending:k.getGroupDescending(),presetFilterItem:C.byId(k.getSelectedPresetFilterItem()),filterItems:k.getSelectedFilterItems(),filterKeys:k.getSelectedFilterKeys(),filterCompoundKeys:k.getSelectedFilterCompoundKeys(),filterString:k.getSelectedFilterString()};k._dialog.detachAfterClose(W);k.fireConfirm(X);};j.attachAfterClose(W);j.close();};x.prototype._onCancel=function(i){var j=this,k=this._getDialog(),W=function(){j._toggleDialogTitle(j._sTitleLabelId);j.setSelectedSortItem(j._oPreviousState.sortItem);j.setSortDescending(j._oPreviousState.sortDescending);j.setSelectedGroupItem(j._oPreviousState.groupItem);j.setGroupDescending(j._oPreviousState.groupDescending);j.setSelectedPresetFilterItem(j._oPreviousState.presetFilterItem);j._clearSelectedFilters();j.setSelectedFilterCompoundKeys(j._oPreviousState.filterCompoundKeys);if(j._navContainer.getCurrentPage()!==j._oPreviousState.navPage){setTimeout(j._navContainer["to"].bind(j._navContainer,j._oPreviousState.navPage.getId(),"show"),0);}j._switchToPage(j._oPreviousState.contentPage,j._oPreviousState.contentItem);j._dialog.detachAfterClose(W);j.fireCancel();};k.attachAfterClose(W);k.close();};x.prototype.clearFilters=function(){this._clearSelectedFilters();this._clearPresetFilter();this.fireResetFilters();this._updateFilterCounters();if(this._vContentPage===3){setTimeout(this._getNavContainer()['to'].bind(this._getNavContainer(),this._getPage1().getId()),0);this._switchToPage(2);this._getSegmentedButton().setSelectedButton(this._getFilterButton());}this._updateListSelection(this._presetFilterList,C.byId(this.getSelectedPresetFilterItem()));return this;};x.prototype._addResetButtonToPage1=function(){var i=this._getHeader(),j=this._getSubHeader(),k=this._getResetButton();if(this._showSubHeader){if(!this._getPage1().getSubHeader()){this._getPage1().setSubHeader(j);}}else{if(this._getPage1().getSubHeader()){this._getPage1().setSubHeader();}}i.addContentRight(k);};x.prototype._applyContextualSettings=function(){a.prototype._applyContextualSettings.call(this);};x.prototype._getSelectedSortItem=function(){var i=this.getSelectedSortItem(),j=A(i,this.getSortItems())||C.byId(i);if(F(j)){return j.getId();}};x.prototype._getSelectedGroupItem=function(){var i=this.getSelectedGroupItem(),j=A(i,this.getGroupItems())||C.byId(i);if(F(j)){return j.getId();}};function H(i,j){if(!this._getPage1(true)){return;}if(i==='customTabs'&&j){if(j.getMetadata().getName()===this.getMetadata().getManagedAggregation(i).type&&this._vContentPage===j.getId()){var k=this._getPage1().getContent();k.forEach(function(W){j.addAggregation('content',W,true);});}}else if(!i&&!j){var k=this._getPage1().getContent();this.getCustomTabs().forEach(function(j){if(this._vContentPage===j.getId()){k.forEach(function(W){j.addAggregation('content',W,true);});}},this);}}function J(){var i=[-1,0,1,2,3];return(this._getPage1().getContent().length&&i.indexOf(this._vContentPage)===-1);}x.prototype.setBusy=function(i){this._getDialog().setBusy(i);return this;};var K=function(i){this.sOperator=i||t.StartsWith;switch(this.sOperator){case t.Equals:this.fnOperator=O;break;case t.Contains:this.fnOperator=Q;break;case t.StartsWith:this.fnOperator=R;break;case t.AnyWordStartsWith:this.fnOperator=U;break;default:p.warning("Unknown string compare operator. Use values from sap.m.StringFilterOperator. Default operator should be used.");this.fnOperator=Q;break;}};K.prototype.filter=function(i,j){if(!i){return true;}if(!j){return false;}j=j.toLowerCase();i=i.toLowerCase();return this.fnOperator(i,j);};function O(i,j){return j===i;}function Q(i,j){return j.indexOf(i)>-1;}function R(i,j){return j.indexOf(i)===0;}function U(i,j){var k=new RegExp(".*\\b"+i+".*");return k.test(j);}return x;});
