/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['./library','sap/ui/core/Core','sap/ui/core/Element','sap/ui/Device','sap/ui/core/ResizeHandler','./ListItemBase','./Button','./ToolbarSeparator','sap/m/OverflowToolbar','sap/m/OverflowToolbarLayoutData','sap/ui/core/IconPool','sap/ui/core/Icon','sap/ui/core/library'],function(l,C,E,D,R,L,B,T,O,a,I,b,c){'use strict';var N="NLIRangeSet";D.media.initRangeSet(N,[600],"px",["S","M"],true);var P=c.Priority;var d=l.ButtonType;var e=l.ToolbarStyle;var f=l.OverflowToolbarPriority;var r=C.getLibraryResourceBundle('sap.m'),g=r.getText('NOTIFICATION_LIST_ITEM_CLOSE'),h=r.getText('NOTIFICATION_LIST_GROUP_CLOSE');var j=L.extend('sap.m.NotificationListBase',{metadata:{library:'sap.m',"abstract":true,properties:{priority:{type:'sap.ui.core.Priority',group:'Appearance',defaultValue:P.None},title:{type:'string',group:'Appearance',defaultValue:''},datetime:{type:'string',group:'Appearance',defaultValue:''},showButtons:{type:'boolean',group:'Behavior',defaultValue:true},showCloseButton:{type:'boolean',group:'Behavior',defaultValue:true},authorName:{type:'string',group:'Appearance',defaultValue:''},authorPicture:{type:'sap.ui.core.URI'}},aggregations:{buttons:{type:'sap.m.Button',multiple:true},_closeButton:{type:'sap.m.Button',multiple:false,visibility:"hidden"},_overflowToolbar:{type:'sap.m.OverflowToolbar',multiple:false,visibility:"hidden"},_priorityIcon:{type:'sap.ui.core.Icon',multiple:false,visibility:"hidden"}},events:{close:{}}},renderer:null});j.prototype._activeHandling=function(){};j.prototype.updateSelectedDOM=function(){};j.prototype.getAccessibilityText=function(){return'';};j.prototype.setProperty=function(){this._resetButtonsOverflow();return L.prototype.setProperty.apply(this,arguments);};j.prototype.getButtons=function(){var i=this._getCloseButton(),t=this._getToolbarSeparator();return this._getOverflowToolbar().getContent().filter(function(k){return k!==i&&k!==t;},this);};j.prototype.addButton=function(o){var i=this._getOverflowToolbar(),k=i.getContent().length;if(this._getToolbarSeparator()){k-=2;}i.insertContent(o,k);this._resetButtonsOverflow();this.invalidate();return this;};j.prototype.insertButton=function(o,i){this._getOverflowToolbar().insertContent(o,i);this._resetButtonsOverflow();this.invalidate();return this;};j.prototype.removeButton=function(o){var i=this._getOverflowToolbar().removeContent(o.getId());this._resetButtonsOverflow();this.invalidate();return i;};j.prototype.removeAllButtons=function(){var o=this._getOverflowToolbar(),i=this.getButtons();i.forEach(function(k){o.removeContent(k);});this._resetButtonsOverflow();this.invalidate();return this;};j.prototype.destroyButtons=function(){var i=this.getButtons();i.forEach(function(k){k.destroy();});this._resetButtonsOverflow();this.invalidate();return this;};j.prototype.clone=function(){var i=L.prototype.clone.apply(this,arguments);i.destroyAggregation('_overflowToolbar');var o=this.getAggregation('_overflowToolbar');if(o){i.setAggregation("_overflowToolbar",o.clone(),true);}return i;};j.prototype._getOverflowToolbar=function(){var o=this.getAggregation('_overflowToolbar');if(!o){o=new O(this.getId()+'-overflowToolbar',{style:e.Clear});this.setAggregation("_overflowToolbar",o,true);}return o;};j.prototype._getCloseButton=function(){var i,o,k,m;o=this._getOverflowToolbar();k=o.getContent();if(k.length){m=k.length-1;i=k[m];if(i.getId()!==this.getId()+"-closeButtonX"){i=null;}}if(!i){i=this.getAggregation("_closeButton");}return i;};j.prototype._createCloseButton=function(){var i,k=this.isA("sap.m.NotificationListGroup"),m=k&&this.getCollapsed();if(this._isSmallSize()&&!m){i=new B(this.getId()+'-closeButtonX',{text:this.isA("sap.m.NotificationListItem")?g:h,type:d.Default,press:function(){this.close();}.bind(this)});}else{i=new B(this.getId()+'-closeButtonX',{icon:I.getIconURI('decline'),type:d.Transparent,tooltip:this.isA("sap.m.NotificationListItem")?g:h,press:function(){this.close();}.bind(this)});this.setAggregation("_closeButton",i);}return i;};j.prototype._getToolbarSeparator=function(){var t,o=this._getOverflowToolbar(),i=o.getContent(),k;if(i.length){k=i.length-2;t=i[k];}if(t&&t.isA("sap.m.ToolbarSeparator")){return t;}return null;};j.prototype._hasActionButtons=function(){return this.getShowButtons()&&this.getButtons().length;};j.prototype._shouldRenderCloseButton=function(){return!this._isSmallSize()&&this.getShowCloseButton();};j.prototype._shouldRenderOverflowToolbar=function(){var i=this._hasActionButtons();if(this._isSmallSize()){return i||this.getShowCloseButton();}return i;};j.prototype.onBeforeRendering=function(){if(this._resizeListenerId){R.deregister(this._resizeListenerId);this._resizeListenerId=null;}if(!this._sCurrentLayoutClassName){this._destroyCloseBtnAndSeparator();}};j.prototype.onAfterRendering=function(){if(this.getDomRef()){this._resizeListenerId=R.register(this.getDomRef(),this._onResize.bind(this));}this._onResize();};j.prototype.exit=function(){if(this._resizeListenerId){R.deregister(this._resizeListenerId);this._resizeListenerId=null;}this._sCurrentLayoutClassName=null;};j.prototype._onResize=function(){var o=this.getDomRef(),m,s;if(!o){return;}m=D.media.getCurrentRange(N,o.offsetWidth);s="sapMNLIB-Layout"+m.name;if(this._sCurrentLayoutClassName===s){return;}if(this._sCurrentLayoutClassName){this.removeStyleClass(this._sCurrentLayoutClassName);}this.addStyleClass(s);this._sCurrentLayoutClassName=s;this._arrangeButtons();};j.prototype._destroyCloseBtnAndSeparator=function(){var i=this._getCloseButton(),t=this._getToolbarSeparator();if(i){i.destroy();}if(t){t.destroy();}};j.prototype._arrangeButtons=function(){this._destroyCloseBtnAndSeparator();if(this._isSmallSize()){this._arrangeSSizeButtons();}else{this._arrangeMSizeButtons();}};j.prototype._arrangeMSizeButtons=function(){var k,m=this.getButtons(),n=m.length>1?f.AlwaysOverflow:f.NeverOverflow;this._createCloseButton();for(var i=0;i<m.length;i++){k=m[i];k.setLayoutData(new a({priority:n}));}};j.prototype._arrangeSSizeButtons=function(){var o=this._getOverflowToolbar(),i=this._createCloseButton(),k=this.isA("sap.m.NotificationListGroup"),m=k?h:g,n=k&&this.getCollapsed(),p=!n&&this._hasActionButtons(),s=this.getShowCloseButton(),t=new T(),q;this.getButtons().forEach(function(u){if(p){q=f.AlwaysOverflow;u.removeStyleClass('sapMNLIBHiddenButton');}else{q=f.NeverOverflow;u.addStyleClass('sapMNLIBHiddenButton');}u.setLayoutData(new a({priority:q}));});i.setLayoutData(new a({priority:f.AlwaysOverflow}));t.setLayoutData(new a({priority:f.AlwaysOverflow}));o.addContent(t);o.addContent(i);if(!s){i.setVisible(false);t.setVisible(false);return;}i.setVisible(true);if(p){i.setText(m);i.setTooltip('');i.setType(d.Default);i.setIcon('');i.setLayoutData(new a({priority:f.AlwaysOverflow}));t.setVisible(true);}else{i.setText('');i.setTooltip(m);i.setType(d.Transparent);i.setIcon(I.getIconURI('decline'));i.setLayoutData(new a({priority:f.NeverOverflow}));t.setVisible(false);}};j.prototype.close=function(){var p=this.getParent();this.fireClose();var H=!!this.getParent();if(!H&&p&&p instanceof E){var i={onAfterRendering:function(){p.focus();p.removeEventDelegate(i);}};p.addEventDelegate(i);}};j.prototype._getPriorityIcon=function(){var p=this.getAggregation('_priorityIcon');if(!p){p=new b({src:'sap-icon://message-error',useIconTooltip:false});this.setAggregation("_priorityIcon",p,true);}return p;};j.prototype._isSmallSize=function(){return this._sCurrentLayoutClassName==="sapMNLIB-LayoutS";};j.prototype._resetButtonsOverflow=function(){this._sCurrentLayoutClassName=null;};return j;});
