/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['sap/m/DynamicDateUtil','sap/ui/model/SimpleType','sap/ui/model/FormatException','sap/ui/model/ParseException','sap/ui/model/ValidateException','sap/base/util/each'],function(D,S,F,P,V,e){"use strict";var a=S.extend("sap.m.DynamicDate",{constructor:function(){this.sName="DynamicDate";S.apply(this,arguments);}});a.prototype.formatValue=function(v){var r={};if(!v){return;}r.operator=v.operator;r.values=v.values.slice(0);var b=D.getOption(v.operator).getValueTypes();r.values=r.values.map(function(v,i){if(b[i]==="date"||b[i]==="datetime"){return t.parse(v);}return v;},this);return r;};a.prototype.parseValue=function(v){var r={},b;if(!v){return;}if(v.operator==="PARSEERROR"){throw new P(v.values[0]);}r.operator=v.operator;r.values=v.values.slice(0);b=D.getOption(v.operator).getValueTypes();r.values=r.values.map(function(v,i){if(b[i]==="date"||b[i]==="datetime"){return t.format(v);}return v;},this);return r;};a.prototype.validateValue=function(v){if(this.oConstraints){var b=sap.ui.getCore().getLibraryResourceBundle(),m=sap.ui.getCore().getLibraryResourceBundle("sap.m"),c=[],M=[],o=D.getOption(v.operator),d=o.toDates(this.formatValue(v)).map(function(u){return u.getTime();});if(d[0]===d[1]){d.length=1;}d.forEach(function(T,i){var E="DynamicDate.Invalid"+(i===0?"Start":"End");e(this.oConstraints,function(C,f){switch(C){case"minimum":if(T<f){c.push("minimum");M.push(m.getText(E,[new Date(T).toDateString()]));M.push(b.getText("Date.Minimum",[new Date(f).toDateString()]));}break;case"maximum":if(T>f){c.push("maximum");M.push(m.getText(E,[new Date(T).toDateString()]));M.push(b.getText("Date.Maximum",[new Date(f).toDateString()]));}break;}});},this);if(c.length>0){throw new V(this.combineMessages(M),c);}}};var t={format:function(v){if(v instanceof Date){return v.getTime();}return null;},parse:function(v){if(isNaN(v)){throw new F("Cannot format date: "+v+" is not a valid Timestamp");}else if(typeof(v)!=="number"){v=parseInt(v);}v=new Date(v);return v;}};return a;});
