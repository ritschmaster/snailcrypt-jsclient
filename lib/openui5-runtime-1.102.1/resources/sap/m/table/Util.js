/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/m/library","sap/ui/core/Core","sap/ui/core/theming/Parameters","sap/m/IllustratedMessage"],function(M,C,T,I){"use strict";var U={};var d="";var b=parseFloat(M.BaseFontSize);U.measureText=(function(){var e=0.05;var c=document.createElement("canvas").getContext("2d");var s=function(){d=[parseFloat(T.get({name:"sapMFontMediumSize"})||"0.875rem")*b+"px",T.get({name:"sapUiFontFamily"})||"Arial"].join(" ");return d;};C.attachThemeChanged(s);return function(t,f){c.font=f||d||s();return c.measureText(t||"").width/b+e;};})();U.calcTypeWidth=(function(){var B=0;var D=[2023,9,26,22,47,58,999];var u=new Date(Date.UTC.apply(0,D));var l=new(Function.prototype.bind.apply(Date,[null].concat(D)))();var n={Byte:3,SByte:3,Int16:5,Int32:9,Int64:12,Single:6,Float:12,Double:13,Decimal:15,Integer:9};C.attachThemeChanged(function(){B=0;});return function(t,s){var a=t.getMetadata().getName().split(".").pop();var m=s&&s.maxWidth||19;var g=s&&s.gap||0;var c=function(k){return Math.min(k+g,m);};if(a=="Boolean"){if(!B){var r=C.getLibraryResourceBundle("sap.ui.core");var y=U.measureText(r.getText("YES"));var N=U.measureText(r.getText("NO"));B=Math.max(y,N);}return c(B);}if(a=="String"||t.isA("sap.ui.model.odata.type.String")){var i=parseInt(t.getConstraints().maxLength)||0;if(!i||i*0.25>m){return m;}var S=U.measureText("A".repeat(i));if(i<m||m<10){return Math.min(S,m);}var w=Math.log(S-m*0.16)/Math.log(m/3)*(m/2)*Math.pow(m/19,1/S);return c(Math.min(w,S));}if(a.startsWith("Date")||a.startsWith("Time")){var f=t.getFormatOptions();var o=f.UTC?u:l;var e=o.toLocaleDateString();if(a=="TimeOfDay"){e=new Intl.DateTimeFormat("de",{hour:"numeric",minute:"numeric",second:"numeric"}).format(o);e=t.formatValue(e,"string");}else if(t.isA("sap.ui.model.odata.type.Time")){e=t.formatValue({__edmType:"Edm.Time",ms:u.valueOf()},"string");}else{e=t.formatValue(f.interval?[o,new Date(o*1.009)]:o,"string");((t.oFormat&&t.oFormat.oFormatOptions&&t.oFormat.oFormatOptions.pattern)||"").replace(/[MELVec]{3,4}/,function(W){e+=(W.length==4?"---":"-");});}return c(U.measureText(e));}if(n[a]){var h=parseInt(t.getConstraints().scale)||0;var p=parseInt(t.getConstraints().precision)||20;p=Math.min(p,n[a]);var j=2*Math.pow(10,p-h-1);j=t.formatValue(j,"string");return c(U.measureText(j));}return s&&s.defaultWidth||8;};})();U.calcHeaderWidth=(function(){var h="";var g=function(){if(!h){h=[T.get({name:"sapUiColumnHeaderFontWeight"})||"normal",d].join(" ");}return h;};C.attachThemeChanged(function(){h="";});return function(H,c,m,i){var a=H.length;m=m||19;i=i||2;if(c>m){return m;}if(i>a){return i;}c=Math.max(c,i);if(c>a){return c;}var o=U.measureText(H,g());o=Math.min(o,m*0.7);var f=Math.max(1,1-(Math.log(Math.max(c-1.7,0.2))/Math.log(m*0.5))+1);var e=f*c;var j=Math.max(0,o-e);var k=(j<0.15)?o:e+j*(1-1/c)/Math.E;return k;};})();U.calcColumnWidth=function(t,h,s){if(!Array.isArray(t)){t=[t];}s=Object.assign({minWidth:2,maxWidth:19,defaultWidth:8,padding:1,gap:0,verticalArrangement:false},s);var H=0;var m=Math.max(1,s.minWidth);var i=Math.max(m,s.maxWidth);var c=s.gap+t.reduce(function(f,v){var o=v,a={defaultWidth:s.defaultWidth,maxWidth:s.maxWidth};if(Array.isArray(v)){o=v[0];a=v[1]||a;}var e=U.calcTypeWidth(o,a);return s.verticalArrangement?Math.max(f,e):f+e+(f&&0.5);},0);if(h){H=U.calcHeaderWidth(h,c,i,m);}c=Math.max(m,c,H);c=Math.min(c,i);c=Math.round(c*100)/100;return c+s.padding+"rem";};U.getNoColumnsIllustratedMessage=function(){var r=C.getLibraryResourceBundle("sap.m");return new I({illustrationType:M.IllustratedMessageType.AddColumn,title:r.getText("TABLE_NO_COLUMNS_TITLE"),description:r.getText("TABLE_NO_COLUMNS_DESCRIPTION")});};return U;});
